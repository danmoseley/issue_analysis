[
    {
        "url":  "https://github.com/dotnet/runtime/issues/23448",
        "createdAt":  "2017-09-05T15:21:55Z",
        "number":  23448,
        "author":  "stephentoub",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-07-22T16:25:56Z",
        "body":  "- Ctor_ContextType_Name_Container_UserName_Password\r\n- Ctor_ContextType_Name_UserName_Password\r\n- ValidateCredentials_IncorrectUserNamePassword_ThrowsException\r\n- ValidateCredentials_InvalidUserName_ThrowsException\r\n\r\ne.g.\r\n```\r\nUnhandled Exception of Type Xunit.Sdk.ThrowsException\r\nMessage :\r\nAssert.Throws() Failure\r\nExpected: typeof(System.Exception)\r\nActual:   typeof(System.Runtime.InteropServices.COMException): Logon failure: unknown user name or bad password.\r\nStack Trace :\r\n   at System.DirectoryServices.DirectoryEntry.RefreshCache()\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext.DoMachineInit()\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext.Initialize()\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext.get_ConnectedServer()\r\n   at System.DirectoryServices.AccountManagement.Tests.PrincipalContextTests.\u003c\u003ec__DisplayClass5_0.\u003cCtor_ContextType_Name_Container_UserName_Password\u003eb__1()\r\n```\r\n\r\n\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOFtXs4Q==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDMyNzI5NTI2OQ==",
                                           "createdAt":  "2017-09-05T20:34:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "https://github.com/dotnet/corefx/issues/23548",
                                           "updatedAt":  "2017-09-05T20:34:30Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM3ODcyNTE1MQ==",
                                           "createdAt":  "2018-04-04T19:55:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "krwq",
                                           "body":  "@danmosemsft @ViktorHofer dotnet/corefx#23800 and dotnet/runtime#23326 seem to be closed as dups of each other but there are still test cases disabled:\r\n\r\n```\r\nSystem.DirectoryServices.AccountManagement/tests/PrincipalContextTests.cs:104:        [ActiveIssue(23800)]\r\nSystem.DirectoryServices.AccountManagement/tests/PrincipalContextTests.cs:130:        [ActiveIssue(23800)]\r\nSystem.DirectoryServices.AccountManagement/tests/PrincipalContextTests.cs:301:        [ActiveIssue(23800)]\r\nSystem.DirectoryServices.AccountManagement/tests/PrincipalContextTests.cs:310:        [ActiveIssue(23800)]\r\n```",
                                           "updatedAt":  "2018-04-04T19:55:29Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM4MjE1NDMwMg==",
                                           "createdAt":  "2018-04-17T21:31:41Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tarekgh",
                                           "body":  "CC @joelbraun @tquerec ",
                                           "updatedAt":  "2018-04-17T21:31:41Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM4MjQyMjc5Mw==",
                                           "createdAt":  "2018-04-18T15:14:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ViktorHofer",
                                           "body":  "Right, this issue should stay open till it is resolved as test cases link to this. I closed dotnet/runtime#23326 closed as a dup of this one.",
                                           "updatedAt":  "2018-04-18T15:15:53Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM4Mjg5NDcxNA==",
                                           "createdAt":  "2018-04-19T22:03:26Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@joelbraun @tquerec any investigation here that is must have for 2.1?  I assume this can move to Future right?",
                                           "updatedAt":  "2018-04-19T22:03:26Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM4Mjk4NTkzNQ==",
                                           "createdAt":  "2018-04-20T05:51:46Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joelbraun",
                                           "body":  "Not sure if I\u0027m supposed to be tagged in this- I don\u0027t recognize any of the attached issues nor do I have any context on these tests. ",
                                           "updatedAt":  "2018-04-20T05:51:46Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM4MzExODU2MQ==",
                                           "createdAt":  "2018-04-20T14:42:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "josephisenhour",
                                           "body":  "Seems like a test bug and not a product bug. The exception is thrown as expected but the test is not handling it. I think it is ok to mark future and not block.",
                                           "updatedAt":  "2018-04-20T14:42:21Z"
                                       }
                                   ],
                         "totalCount":  7
                     },
        "title":  "Several DirectoryServices tests failing in CI with Logon failure",
        "labels":  [
                       "area-System.DirectoryServices",
                       "disabled-test",
                       "test-bug"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/24887",
        "createdAt":  "2018-02-02T07:47:43Z",
        "number":  24887,
        "author":  "bigbearzhu",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOCYq2gw==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "dlumpp",
                                            "createdAt":  "2019-01-21T15:41:24Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "mtschneiders",
                                            "createdAt":  "2019-03-20T16:20:48Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "sachinpandey122",
                                            "createdAt":  "2019-12-11T19:41:08Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "simon-biber",
                                            "createdAt":  "2022-04-19T15:11:42Z"
                                        }
                                    ],
                          "totalCount":  4
                      },
        "updatedAt":  "2022-04-19T15:16:18Z",
        "body":  "Hi all,\r\n\r\nWhen finding users with `PrincipalSearcher.FindAll` method for machine context, it seems the search is case sensitive. However if the search is for domain users, it becomes case insensitive. The reason for this is because domain search is using LDAP which is case insensitive. But machine local search goes through `SAMQuerySet` which uses a [regex](https://github.com/dotnet/corefx/blob/0eb5e7451028e9374b8bb03972aa945c128193e1/src/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/SAM/SAMQuerySet.cs#L338) that doesn\u0027t take in `RegexOptions.IgnoreCase`. \r\n\r\nWould it be safe to add that option so that the search behavior is consistent across different context types? Thanks",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOQbsROA==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM2MjUxMTY4Ng==",
                                           "createdAt":  "2018-02-02T07:51:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Is it the same on desktop framework?",
                                           "updatedAt":  "2018-02-02T07:51:15Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM2MjU2MjIyOA==",
                                           "createdAt":  "2018-02-02T11:30:17Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "bigbearzhu",
                                           "body":  "I actually found this issue in ASP.Net App targeting .Net Framework. However I cannot find public repo contains System.DirectoryServices.AccountManagement source code for .Net Framework. Although decompiled code shows exactly the same code. That’s why I raised it here. Sorry if it is not the right place.",
                                           "updatedAt":  "2018-02-02T11:30:17Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM2Mjc4NDcyNw==",
                                           "createdAt":  "2018-02-03T06:31:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@bigbearzhu it\u0027s fine, just curious whether it was .NET Core specific. Sounds like not. Fixes we make here are considered for porting to .NET Framework. ",
                                           "updatedAt":  "2018-02-03T06:31:29Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM2Mjc4NTg0OA==",
                                           "createdAt":  "2018-02-03T06:57:36Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "bigbearzhu",
                                           "body":  "That is awesome! Should I send a pull request or someone else will do? Sounds like a really simple fix but not sure how safe it is. No idea how this would be unit-tested as this is fundamental framework code. Thanks.\n\n\u003e On 3 Feb 2018, at 4:31 pm, Dan Moseley \u003cnotifications@github.com\u003e wrote:\n\u003e \n\u003e @bigbearzhu it\u0027s fine, just curious whether it was .NET Core specific. Sounds like not. Fixes we make here are considered for porting to .NET Framework.\n\u003e \n\u003e —\n\u003e You are receiving this because you were mentioned.\n\u003e Reply to this email directly, view it on GitHub, or mute the thread.\n\u003e \n",
                                           "updatedAt":  "2018-02-03T06:57:36Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM2Mjc4Njc5MQ==",
                                           "createdAt":  "2018-02-03T07:20:28Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@tarekgh sounds comment on your proposed change.",
                                           "updatedAt":  "2018-02-03T07:20:28Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM2MzEzNTEzOQ==",
                                           "createdAt":  "2018-02-05T16:19:16Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tarekgh",
                                           "body":  "@tquerec can comment on this.",
                                           "updatedAt":  "2018-02-05T16:19:16Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDM3NjQ3MzgwMw==",
                                           "createdAt":  "2018-03-27T10:20:09Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ViktorHofer",
                                           "body":  "\u003e But machine local search goes through SAMQuerySet which uses a regex that doesn\u0027t take in RegexOptions.IgnoreCase.\r\n\r\nYou propose to change the local search behavior from case sensitive to case insensitive, is that right? If so, I\u0027m not sure this isn\u0027t a breaking change as you could get more results back than before. We should check if there\u0027s documentation that outlines the current behavior.",
                                           "updatedAt":  "2018-03-27T10:20:09Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQxNTQ3NzM5NA==",
                                           "createdAt":  "2018-08-23T16:19:02Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tarekgh",
                                           "body":  "CC @josephisenhour  @bongiovimatthew-microsoft @tquerec ",
                                           "updatedAt":  "2018-08-23T16:19:02Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDU2NDcwMDE0Mg==",
                                           "createdAt":  "2019-12-11T19:39:07Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "sachinpandey122",
                                           "body":  "Hi all,\r\ndo we have any conclusion on this yet?\r\nThanks,",
                                           "updatedAt":  "2019-12-11T19:39:07Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYzOTI0NDI5MQ==",
                                           "createdAt":  "2020-06-05T03:58:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "webatxcent",
                                           "body":  "I am not sure why this issue has any push back. The local security authority will not let you create two user accounts with the same name regardless of case. Performing a case insensitive search shouldn\u0027t return any more results. Is this a fix that could be forth coming?",
                                           "updatedAt":  "2020-06-05T03:58:55Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYzOTI2MDc2Ng==",
                                           "createdAt":  "2020-06-05T05:05:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@joperezr (since you have more context on this area now) -- thoughts? is this simply wrong and an easy fix? ",
                                           "updatedAt":  "2020-06-05T05:05:20Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYzOTI2MTk4Mw==",
                                           "createdAt":  "2020-06-05T05:10:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Also this comment just above I believe is no longer accurate. We can release DynamicMethods, so RegexOptions.Compiled does not cause unbounded growth. (It does add startup time though so it\u0027s not necessarily a good thing, but if throughput matters more then it\u0027s a good thing)\r\n```\r\n            // Ideally, we\u0027d like to use a compiled Regex (RegexOptions.Compiled) for performance,\r\n            // but the CLR cannot release generated MSIL.  Thus, our memory usage would grow without bound\r\n            // each time a query was performed.\r\n```",
                                           "updatedAt":  "2020-06-05T05:10:04Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYzOTYzMDY2OA==",
                                           "createdAt":  "2020-06-05T16:57:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "The one I\u0027m very familiar with is System.DirectoryServices.Protocols which in Windows it is just implemented on top of wldap32 which means for all searches it uses the LDAP protocol search, which as this issue points out it is case insensitive. AccountManagement namespace is a bit more complex since it supports more specific types of directories like ADDS, ADLDS, and MSAM which is the one that seems to have the case sensitive issue here. I\u0027m not too familiar with that so as @tarekgh suggested, I would like to know what does @tquerec think about this one as MSAM might have some different characteristics unlike traditional ADDS.",
                                           "updatedAt":  "2020-06-05T16:57:37Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYzOTcyNTEzMA==",
                                           "createdAt":  "2020-06-05T19:08:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOBthM7A==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2020-06-05T19:10:11Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "webatxcent",
                                                                               "createdAt":  "2020-06-25T17:26:52Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "hangy",
                                                                               "createdAt":  "2021-06-05T09:53:18Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "tquerec",
                                           "body":  "@joperezr I believe this is just a bug in the API.  MSAM ( local account store ) is case insensitive so the regex should be updated to be case insensitive.  ",
                                           "updatedAt":  "2020-06-05T19:08:03Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5BuxE4",
                                           "createdAt":  "2022-04-19T15:16:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "simon-biber",
                                           "body":  "Is there any workaround to find users in the local machine quickly and with case insensitive usernames?\r\n\r\nFor AD users we are using:\r\n```\r\n                return UserPrincipal.FindByIdentity(context, domainBackslashUserName);\r\n```\r\nbut that is very slow for Machine users - I have read it\u0027s a NetBIOS timeout per network adapter - so we are using the following which is much faster for the local machine:\r\n```\r\n                using var user = new UserPrincipal(context);\r\n                user.SamAccountName = username;\r\n                using var searcher = new PrincipalSearcher(user);                \r\n                return searcher.FindOne() as UserPrincipal;\r\n```",
                                           "updatedAt":  "2022-04-19T15:16:18Z"
                                       }
                                   ],
                         "totalCount":  15
                     },
        "title":  "PrincipalSearcher for machine local users is case sensitive",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/25887",
        "createdAt":  "2018-04-13T13:05:59Z",
        "number":  25887,
        "author":  "gabeluci",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOCuzSvQ==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "1trevor",
                                            "createdAt":  "2019-03-13T15:07:51Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "ZephyrZiggurat",
                                            "createdAt":  "2023-02-23T15:45:04Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "SchneMa",
                                            "createdAt":  "2023-03-10T08:17:09Z"
                                        }
                                    ],
                          "totalCount":  3
                      },
        "updatedAt":  "2025-01-11T14:56:30Z",
        "body":  "For AD user objects that have a forward slash in the distinguished name, `UserPrincipal.GetGroups` throws an exception:\r\n\r\n\u003e System.Runtime.InteropServices.COMException: Unknown error (0x80005000)\u0027\r\n\r\nThe forward slash might be in the CN of the object, or in any OU in the path of the DN, for example:\r\n\r\n    CN=test user,OU=Test / OU,OU=Users,DC=domain,DC=com\r\n\r\nor\r\n\r\n    CN=test/user,OU=Users,DC=domain,DC=com\r\n\r\nTested with:\r\n\r\n- .NET Core 2.0\r\n- System.DirectoryServices.AccountManagement 4.5.0-preview2-26406-04\r\n\r\nHere is the test code:\r\n\r\n    var domain = \"domain.com\";\r\n    var username = \"username\"; //user  with a slash in the distinguishedName\r\n    var domainContext = new PrincipalContext(ContextType.Domain, domain);\r\n    var user = UserPrincipal.FindByIdentity(domainContext, IdentityType.SamAccountName, username);\r\n\r\n    //The user was found so this works\r\n    Console.WriteLine(\"User Found: {0}\", user.DistinguishedName);\r\n\r\n    //This causes COM Exception: Unknown Error 0x80005000                \r\n    var output = user.GetGroups().ToList();\r\n\r\nThe problem seems to be [line 1218 of ADStoreCtx.cs](https://github.com/dotnet/corefx/blob/master/src/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx.cs#L1218):\r\n\r\n    roots.Add(new DirectoryEntry(\"GC://\" + gc.Name + \"/\" + p.DistinguishedName, this.credentials != null ? this.credentials.UserName : null, this.credentials != null ? this.credentials.Password : null, this.AuthTypes));\r\n\r\nThis is putting the distinguished name into an LDAP path without escaping the slashes in the DN. I enabled debugging for .NET code, and after that line, I changed the `Path` value of the resulting `DirectoryEntry` using the debugger to add the escaped slash and it ran successfully. So I believe that line can be fixed with a `Replace()`:\r\n\r\n    roots.Add(new DirectoryEntry(\"GC://\" + gc.Name + \"/\" + p.DistinguishedName.Replace(\"/\", \"\\\\/\"), this.credentials != null ? this.credentials.UserName : null, this.credentials != null ? this.credentials.Password : null, this.AuthTypes));\r\n\r\nThere may be other places in the code where this should be taken into account as well: anywhere that a distinguished name is being dropped into an LDAP path, like possibly [line 1830](https://github.com/dotnet/corefx/blob/master/src/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx.cs#L1830) in that same file (although I haven\u0027t tested that - I just searched the file for \"://\"). Maybe elsewhere too.\r\n\r\nThis is a bug in the full .NET Framework too, but I\u0027m not sure where to report bugs for the full framework. If you can let me know, I don\u0027t mind reporting there too.\r\n\r\nThis came from a question in StackOverflow: https://stackoverflow.com/questions/49805255/0x80005000-unknown-error-on-userprincipal-getgroups-with-special-characters-in-o/49816959\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOmhhzlA==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDUzMzAyMTMzMA==",
                                           "createdAt":  "2019-09-19T08:16:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC9IUQA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "NoelKennedy",
                                                                               "createdAt":  "2023-06-05T08:48:28Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "klyse",
                                           "body":  "Any updates on this? I have the same problem.",
                                           "updatedAt":  "2019-09-19T08:16:18Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDUzMzEwNjM4OQ==",
                                           "createdAt":  "2019-09-19T12:27:00Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOAw__LA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "klyse",
                                                                               "createdAt":  "2019-09-20T06:04:37Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "gabeluci",
                                           "body":  "No, it hasn\u0027t been fixed yet.\r\n\r\nAs an alternative, you can get a user\u0027s groups using `DirectoryEntry` directly (which is what `UserPrincipal` uses in the background anyway). I wrote an article on this, with some example code: [Active Directory: Finding all of a user’s groups](https://www.gabescode.com/active-directory/2018/06/08/finding-all-of-a-users-groups.html). I find that using `DirectoryEntry` directly performs faster anyway.",
                                           "updatedAt":  "2019-09-19T12:27:00Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYxMTY2NzQ0MA==",
                                           "createdAt":  "2020-04-09T17:58:12Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "Zorgle",
                                           "body":  "Just hit this bug using .NET 4.8 on Windows 2016 1909.",
                                           "updatedAt":  "2020-04-09T17:58:12Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6aGHOU",
                                           "createdAt":  "2025-01-11T14:56:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "gabeluci",
                                           "body":  "Doesn\u0027t look like this has been addressed yet:\nhttps://github.com/dotnet/runtime/blob/main/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx.cs#L1213",
                                           "updatedAt":  "2025-01-11T14:56:20Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "UserPrincipal.GetGroups throws exception if user distinguishedName has a slash",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/26735",
        "createdAt":  "2018-07-09T15:23:46Z",
        "number":  26735,
        "author":  "winsquall",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOCPpGCg==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "af-mst",
                                            "createdAt":  "2022-02-21T14:24:43Z"
                                        }
                                    ],
                          "totalCount":  1
                      },
        "updatedAt":  "2022-02-21T14:24:41Z",
        "body":  "Hello,\r\n\r\nI try to deploy a .netcore 2 app on a docker nanoserver. This app is using Mirosoft.DirectoryServices and i always have an error \"Unable to load activeds.dll. Module not found...\" when it try to use it.\r\nI try to put the dll into the container in c:/windows/system32 but nothing change.\r\n\r\nCan somebody help me about this issue?\r\n\r\nRegards.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOPmbzdQ==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQwMzU0OTI4OA==",
                                           "createdAt":  "2018-07-09T17:03:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@tquerec, @josephisenhour, @bongiovimatthew-microsoft can you confirm whether System.DirectoryServices is expected to work on Nano?\r\n\r\nMy assumption is not - I believe activeds.dll is not part of WCP ?",
                                           "updatedAt":  "2018-07-09T17:03:44Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQwMzg2NDI3Ng==",
                                           "createdAt":  "2018-07-10T15:27:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "josephisenhour",
                                           "body":  "That\u0027s correct, System.DirectoryServices doesn\u0027t work with nano yet. ",
                                           "updatedAt":  "2018-07-10T15:27:25Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQwMzg4NDc2NQ==",
                                           "createdAt":  "2018-07-10T16:28:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@josephisenhour  \"yet\" .. is it planned? maybe that\u0027s the same question as, do you expect to put activeds.dll in the image.\r\n\r\nEither way it would be nice to have a more specific message.",
                                           "updatedAt":  "2018-07-10T16:28:03Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQwMzk3MDAyOQ==",
                                           "createdAt":  "2018-07-10T21:21:35Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "josephisenhour",
                                           "body":  "It is planned and some work is underway, but there are no specific dates yet.",
                                           "updatedAt":  "2018-07-10T21:21:35Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQwNDA0NzUyOQ==",
                                           "createdAt":  "2018-07-11T05:15:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "winsquall",
                                           "body":  "Many thanks @danmosemsft , @josephisenhour . \r\nUntil a new image of nanoserver is release, is there a workaround more efficient than put the activeds.dll in system32?\r\nRegards",
                                           "updatedAt":  "2018-07-11T05:15:29Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3OTY3MjQzNg==",
                                           "createdAt":  "2019-04-03T21:52:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ViktorHofer",
                                           "body":  "@tquerec, @josephisenhour, @bongiovimatthew-microsoft does System.DirectoryServices now work on Windows 10 Nano? Please triage this and set a milestone.",
                                           "updatedAt":  "2019-04-03T21:52:29Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDgxMzQwOTU5NQ==",
                                           "createdAt":  "2021-04-05T14:04:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOBmEo2w==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "agoodwin",
                                                                               "createdAt":  "2021-04-06T08:38:00Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "LisavB",
                                           "body":  "Is there currently a suggested workaround for this issue? And is the date this issue will be fixed known?",
                                           "updatedAt":  "2021-04-05T14:04:03Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDgxMzQ2MzEwNA==",
                                           "createdAt":  "2021-04-05T15:45:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@tquerec do you know?",
                                           "updatedAt":  "2021-04-05T15:45:23Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDgxNDI3ODgyNw==",
                                           "createdAt":  "2021-04-06T16:59:12Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tquerec",
                                           "body":  "There is no reasonable workaround I know of.  There was work to move ADSI into the onecore package but this does not necessarily mean it\u0027s also included in nano.  The best way to figure this out may be to install the latest nano package and look for the presence of any of the ADSI binaries ( activeds.dll, etc ).",
                                           "updatedAt":  "2021-04-06T16:59:12Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDgxNDcwNzEyMQ==",
                                           "createdAt":  "2021-04-07T08:16:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "LisavB",
                                           "body":  "Thanks @tquerec, the activeds.dll package wasn\u0027t present for me in the nano server package.\r\nIs there planned work to add these to the nano-server?\r\n \r\nIn case anyone else is stuck, using System.DirectoryServices.Protocols to use LDAP to access AD directly are working for me as a workaround.",
                                           "updatedAt":  "2021-04-07T08:16:23Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4-ZvN1",
                                           "createdAt":  "2022-02-21T14:24:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "af-mst",
                                           "body":  "Are there any updates on this topic since Jul 2018?\r\nWe would really appreciate using nano, because if the considerably lower size compared to core (which we currently use)\r\n\r\nRegards ",
                                           "updatedAt":  "2022-02-21T14:24:37Z"
                                       }
                                   ],
                         "totalCount":  11
                     },
        "title":  "DirectoryServices deployement on nano serve Unable to load activeds.dll",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices",
                       "os-windows-nano",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/27160",
        "createdAt":  "2018-08-16T19:13:16Z",
        "number":  27160,
        "author":  "DSakura207",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-11-19T22:56:05Z",
        "body":  "Server info: [forumsys](https://www.forumsys.com/tutorials/integration-how-to/ldap/online-ldap-test-server/)\r\n\r\nEnvironment: .Net Core 2.1, .Net Framework 4.7.2\r\n\r\nNuget Package: System.DirectoryServices.AccountManagement, 4.5.0\r\n\r\nThe question is from [Stackoverflow](https://stackoverflow.com/questions/51624868/trying-to-test-ldap-based-authentication-from-forumsys/51756583).\r\n\r\nI have tried to use the code below to create a `PrincipalContext` to validate user credential. However, I ran into `NullReferenceException`. Does this package support non-AD LDAP servers?\r\n\r\nCode:\r\n```\r\nusing System;\r\nusing System.DirectoryServices.AccountManagement;\r\n\r\nnamespace LDAPTest\r\n{\r\n    class Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            string userName = \"cn=read-only-admin,dc=example,dc=com\";\r\n            string password = \"password\";\r\n            string sDomain = \"ldap.forumsys.com:389\";\r\n            string sDefaultOU = userName;\r\n            string sServiceUser = @\"read-only-admin\";\r\n            string sServicePassword = password;\r\n\r\n            PrincipalContext oPrincipalContext = new PrincipalContext\r\n            (ContextType.Domain, sDomain, sDefaultOU, sServiceUser, sServicePassword);\r\n            oPrincipalContext.ValidateCredentials(userName,password);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nStacktrace:\r\n```\r\nUnhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext.ReadServerConfig(String serverName, ServerProperties\u0026 properties)\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext.DoServerVerifyAndPropRetrieval()\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext..ctor(ContextType contextType, String name, String container, ContextOptions options, String userName, String password)\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext..ctor(ContextType contextType, String name, String container, String userName, String password)\r\n   at LDAPTest.Program.Main(String[] args) in D:\\VisualStudioCode\\Projects\\LDAPTest\\Program.cs:line 17\r\n```",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOOhYTxQ==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQxNjA4MDU3NQ==",
                                           "createdAt":  "2018-08-26T23:23:35Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "wjk",
                                           "body":  "@DSakura1987 That API certainly looks like would support non-AD LDAP servers. It calls through to the `System.DirectoryServices.Protocols` API under the hood. This API P/Invokes into `wldap32.dll`, which is not specific to Active Directory. However, when you attempt to connect `PrincipalContext` [first queries for AD-specific LDAP properties](https://github.com/dotnet/corefx/blob/master/src/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/Context.cs#L1089), which are probably the source of your NRE.\r\n\r\nMy recommendation is that you try to migrate to [the `LdapConnection` class](https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.protocols.ldapconnection?view=netframework-4.7.2). This API works at a much lower level than `PrincipalContext`, but it uses _no_ Microsoft-specific constructs unless you specifically ask for them. Hope this helps!",
                                           "updatedAt":  "2018-08-26T23:23:35Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQxNjEwNzI0Mw==",
                                           "createdAt":  "2018-08-27T03:54:41Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "DSakura207",
                                           "body":  "Hi @wjk ,\r\nThank you for your explanation. Yes it is what I thought but I cannot find a PDB to get the line numbers. I have to compile the source from the commit, right?\r\nIf a task can be added to make it more general it is the best.",
                                           "updatedAt":  "2018-08-27T03:54:41Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3MTQ2MzEwNQ==",
                                           "createdAt":  "2019-03-11T09:22:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "yuessir",
                                           "body":  "\r\ninstall Microsoft.Windows.Compatibility 2.0.1\r\non .net core 2.2\r\nand System.DirectoryServices.AccountManagement is not supported on this platform.\r\n\r\n",
                                           "updatedAt":  "2019-03-11T09:22:45Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ4MDgzNzY3Ng==",
                                           "createdAt":  "2019-04-08T13:44:40Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tjmoore",
                                           "body":  "The same error occurs on .NET Framework 4.6 (not tried newer). Also reproducible in LINQPad.",
                                           "updatedAt":  "2019-04-08T13:59:29Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45qB_h",
                                           "createdAt":  "2021-11-12T18:16:00Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "jods4",
                                           "body":  "2021 update for anyone arriving here from a Google search:\r\nI confirm the problem is still there in .net 5.",
                                           "updatedAt":  "2021-11-12T18:16:00Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc46FhPF",
                                           "createdAt":  "2021-11-19T22:55:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I don\u0027t think that AccountManagement works well for non-Active Directory ldap servers. If you need support for that, then the best place to go is definitely System.DirectoryServices.Protocols. ",
                                           "updatedAt":  "2021-11-19T22:55:45Z"
                                       }
                                   ],
                         "totalCount":  6
                     },
        "title":  "Does System.DirectoryServices.AccountManagement supports LDAP?",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/28250",
        "createdAt":  "2018-12-20T23:24:30Z",
        "number":  28250,
        "author":  "epimeth",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-05-20T16:21:01Z",
        "body":  "I\u0027ve spent days on this problem so I\u0027m happy to add more information about my findings if needed, but the long story short is that when I load an UserPrincipal, relevant code:\r\n```c#\r\nusing (var context = new PrincipalContext(ContextType.Domain, _configuration[\"domain\"], _configuration[\"usersPath\"], _configuration[\"saUname\"], _configuration[\"saPassword\"])) {\r\n /// .... PrincipalSearcher\r\n  user = ps.FindOne();\r\n}\r\n```\r\nand later\r\n```c#\r\nuser.UserCannotChangePassword = true;\r\nuser.Save(context);\r\n```\r\nI get an `A constraint violation occurred` exception\r\n\r\nAt first this seemed sporatic, but after a long, arduous journey I discovered that it only seemed sporatic because on my local machine the \"service account\" (`saUname`) that was being used was my Domain Admin account, and on the QA server it was a normal user account.\r\n\r\nThis service account has *full control* over all \"Descendant User objects\" in the relevant OU (`_configuration[\"usersPath\"]`)\r\n\r\nAlso important to note that when the user physically logs into the Domain Server, opens the offending user in ADUsers\u0026Computers, and checks/unchecks the \"User cannot change password\" box, and hits apply, *the setting is updated*\r\n\r\nSo, after days of ~~searching~~ googling and trawling through the corefx projects, my developer-sense is telling me that the problem comes down to `System.DirectoryServices.AccountManagement.ADStoreCtx.SetCannotChangePasswordStatus` and that this user doesn\u0027t have access to the `s_changePasswordGuid` ActiveDirectoryAccessRules for Self/World Sddl.\r\n\r\nWhat this means, exactly, and how to fix it is far beyond my abilities.  The reason I bring it up here, and not take this to an Active Directory expert, is that my fellow developer is convinced that this used to work when we were using the AccountManagement COM object, and that the fact that we are using the corefx nuget library is why it is broken.\r\n\r\nSo we are wondering if this is something that can (and should) be fixed here, and in the meanwhile we are continuing research on how to give the service account access to the relevant ACLs.\r\n\r\nThank you for your time!",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOMjjy3A==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ1MDk1ODMyMg==",
                                           "createdAt":  "2019-01-02T19:23:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "epimeth",
                                           "body":  "We have created a sample application demonstrating this issue...\r\n\r\n```c#\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.DirectoryServices;\r\nusing System.DirectoryServices.AccountManagement;\r\n\r\nnamespace ADUserCannotChangePassword\r\n{\r\n    class Program\r\n    {\r\n\r\n        static void Main()\r\n        {\r\n            var _configuration = new Dictionary\u003cstring, string\u003e\r\n            {\r\n                {\"domain\", \"DOMAIN\"},\r\n                {\"usersPath\", \"OU_WITH_PERMISSION\"},\r\n                {\"serviceAccountUsername\", \"USERNAME\"},\r\n                {\"serviceAccountPassword\", \"PASSWORD\"},\r\n                {\"searchFilter\", \"(\u0026(mail=%v)(objectclass=user))\"},\r\n                {\"accountEmail\", \"someSampleEmailAddress@contoso.com\"},\r\n                {\"accountPrincipal\", \"someSampleSAM\"}\r\n            };\r\n\r\n            using (var context = new PrincipalContext(ContextType.Domain,\r\n                _configuration[\"domain\"],\r\n                _configuration[\"usersPath\"],\r\n                _configuration[\"serviceAccountUsername\"],\r\n                _configuration[\"serviceAccountPassword\"]))\r\n            {\r\n                UserPrincipal user;\r\n\r\n                var queryFilter = new UserPrincipal(context)\r\n                {\r\n                    EmailAddress = _configuration[\"accountEmail\"]\r\n                };\r\n                using (var ps = new PrincipalSearcher(queryFilter))\r\n                {\r\n                    var searcher = (DirectorySearcher) ps.GetUnderlyingSearcher();\r\n                    searcher.Filter = _configuration[\"searchFilter\"].Replace(\"%v\", _configuration[\"accountEmail\"]);\r\n                    searcher.SearchScope = SearchScope.Subtree;\r\n\r\n                    user = ps.FindOne() as UserPrincipal;\r\n\r\n                    if (user == null)\r\n                    {\r\n                        user = new UserPrincipal(context, _configuration[\"accountPrincipal\"],\r\n                            Guid.NewGuid().ToString(), true) {UserPrincipalName = _configuration[\"accountPrincipal\"]};\r\n                        user.EmailAddress = _configuration[\"accountEmail\"];\r\n                        user.Save(context);\r\n                    }\r\n\r\n                    user.UserCannotChangePassword = true;\r\n                    user.Save(context);\r\n                }\r\n            }\r\n            \r\n        }\r\n    \r\n    }\r\n}\r\n```",
                                           "updatedAt":  "2019-01-08T15:54:07Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ1MDk5OTEwMw==",
                                           "createdAt":  "2019-01-02T22:02:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "epimeth",
                                           "body":  "Oh, here\u0027s a thought:\r\n\r\nSo based on all of the things I read, you have to *create* the self and all ACE\u0027s if they do not exist.\r\nlooking at the code, I see that ScanACLForChangePasswordRight is called, which searches for them and sets the correct variables for the ones that exist, but in the documentation found at https://docs.microsoft.com/en-us/windows/desktop/adsi/modifying-user-cannot-change-password-ldap-provider and a number of sample applications I found online, all show that the ACE is created if it is not found.\r\n\r\nPerhaps this is a bug, here, after all?",
                                           "updatedAt":  "2019-01-02T22:02:04Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ1MTE1NjYzOA==",
                                           "createdAt":  "2019-01-03T14:21:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "epimeth",
                                           "body":  "On second thought, seeing as this works for a domain admin, thats probably not a bug",
                                           "updatedAt":  "2019-01-03T14:21:57Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ1MjM0OTY5NQ==",
                                           "createdAt":  "2019-01-08T15:55:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOAiAg9w==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "scattered-code",
                                                                               "createdAt":  "2019-01-23T00:16:55Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "karelz",
                                           "body":  "@tquerec @josephisenhour, @bongiovimatthew-microsoft can you please chime in?",
                                           "updatedAt":  "2019-01-08T15:55:55Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ1OTQwODE0MA==",
                                           "createdAt":  "2019-01-31T16:25:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "epimeth",
                                           "body":  "@tquerec @josephisenhour @bongiovimatthew-microsoft ... I appreciate any help you might give me?  This is a security issue for us as we do not want to expose the entire directory to the service account.  Thanks!",
                                           "updatedAt":  "2019-01-31T16:25:22Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3MDEzODIwMw==",
                                           "createdAt":  "2019-03-06T14:58:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOAkhbog==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "karelz",
                                                                               "createdAt":  "2019-03-06T20:53:24Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "epimeth",
                                           "body":  "I guess I\u0027ll just add a comment once a month... hope this somehow bumps my issue :-)",
                                           "updatedAt":  "2019-03-06T14:58:14Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3MjEwMjkxNw==",
                                           "createdAt":  "2019-03-12T17:32:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "josephisenhour",
                                           "body":  "Hi there. Have you taken a look at how you are delegating access to the non-admin user? Password controls are not handled with traditional ACLs. Take a look at https://support.microsoft.com/en-us/help/305144/how-to-use-useraccountcontrol-to-manipulate-user-account-properties",
                                           "updatedAt":  "2019-03-12T17:32:04Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3MjEzMzc5Mw==",
                                           "createdAt":  "2019-03-12T18:48:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "epimeth",
                                           "body":  "@josephisenhour yes, I have.  This led me to https://docs.microsoft.com/en-us/windows/desktop/ADSI/modifying-user-cannot-change-password-ldap-provider , which seems to be exactly how `System.DirectoryServices.AccountManagement.ADStoreCtx.SetCannotChangePasswordStatus` does it.  Noowhere in any of those articles is there mention of what delegated permissions the user that is *making* the changes has to have.  Again, my code works just fine when the service account is set to a \"Domain Admin\", as well as if the user is the *owner* of the user objects that are edited.  However, I am unable to find out what permission, specifically, needs to be delegated in order for a non-Domain Admin / non-ADObject owner to modify the \"change password allowed\" permission.",
                                           "updatedAt":  "2019-03-12T18:48:22Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3MjE0MDY0NA==",
                                           "createdAt":  "2019-03-12T19:08:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "josephisenhour",
                                           "body":  "For delegation, you should only need rights to update the security descriptor on user objects. So if that is set, then this should work. I\u0027ll set up a repro and see. ",
                                           "updatedAt":  "2019-03-12T19:08:04Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3MjE1NjgzMw==",
                                           "createdAt":  "2019-03-12T19:55:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "epimeth",
                                           "body":  "@josephisenhour please test with my sample application as well?  We appreciate your help immensely!",
                                           "updatedAt":  "2019-03-12T19:55:45Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ3MjE2NDMxMQ==",
                                           "createdAt":  "2019-03-12T20:18:12Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "josephisenhour",
                                           "body":  "Ok, this is a bug in SetCannotChangePasswordStatus. It is writing the entire security descriptor instead of just the DACL portion of the security descriptor. The fix is simple, add this line: de.Options.SecurityMasks = SecurityMasks.Dacl; somewhere prior to .CommitChanges(). I have tested the repro and the fix.  If you would like, you are free to make the fix, test it, and submit a pull request. Let me know if you would like to do this.",
                                           "updatedAt":  "2019-03-12T20:18:12Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDg0MjU4MzI4OQ==",
                                           "createdAt":  "2021-05-17T19:42:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "josephprice79",
                                           "body":  "\u003e Ok, this is a bug in SetCannotChangePasswordStatus. It is writing the entire security descriptor instead of just the DACL portion of the security descriptor. The fix is simple, add this line: de.Options.SecurityMasks = SecurityMasks.Dacl; somewhere prior to .CommitChanges(). I have tested the repro and the fix. If you would like, you are free to make the fix, test it, and submit a pull request. Let me know if you would like to do this.\r\n\r\n@josephisenhour I know this is old but this thread might hold the key to a problem I\u0027ve been having for years... but I\u0027m having trouble with your simple fix. Sorry!\r\n\r\nCould you provide an excerpt? What is **de**? **DirectoryEntry**? What if I\u0027m getting the **UserPrincipal** from the _UserPrincipal_.FindByIdentity method? I\u0027m not seeing any **Options.SecurityMasks**  property in my UserPrincipal object.\r\n\r\nThank you!",
                                           "updatedAt":  "2021-05-17T19:43:32Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDg0MjU5Mjk4OA==",
                                           "createdAt":  "2021-05-17T20:01:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "scattered-code",
                                           "body":  "@josephprice79 the fix refers to submitting a PR to Microsoft\u0027s System.DirectoryServices.AccountManagement library. My team team ran into it, but never got around to fixing it. If you want to submit that PR, this is the place to make the edit:\r\n\r\nhttps://github.com/dotnet/runtime/blob/64f5f0b31d9af2df199229e6e4ef3f4a876a05a5/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx.cs#L489\r\n\r\nAdd de.Options.SecurityMasks = SecurityMasks.Dacl;  to line 594. You\u0027ll need to fork the project and make sure all the tests pass though\r\n",
                                           "updatedAt":  "2021-05-17T20:01:15Z"
                                       }
                                   ],
                         "totalCount":  13
                     },
        "title":  "Non-DomainAdmin user cannot set UserPrincipal.UserCannotChangePassword",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/29181",
        "createdAt":  "2019-04-06T00:15:41Z",
        "number":  29181,
        "author":  "dbaileyut",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-01-17T14:55:33Z",
        "body":  "There appears to be a bug with Global Catalog discovery/error handling in System.DirectoryServices.AccountManagement\r\n\r\nIf the \"first\" Global Catalog in an Active Directory site is unavailable, calling System.DirectoryServices.AccountManagement.Principal.GetGroups() results in an error.\r\n\r\nIt appears to be related to the code block at https://github.com/dotnet/corefx/blob/a6f76f4f620cbe74821c6445af3f13e048361658/src/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx.cs#L1207-L1215\r\n\r\nsince it gets all the GCs and tests their names without confirming they\u0027re available. If the first one succeeds, it breaks out.\r\n\r\nSee attached stack trace and rough test code.\r\n[StackTrace.txt](https://github.com/dotnet/corefx/files/3049985/StackTrace.txt)\r\n[Replication-CSTest.txt](https://github.com/dotnet/corefx/files/3049987/Replication-CSTest.txt)\r\n\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOmuKkaw==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDQ4MDQ1NzM1OA==",
                                           "createdAt":  "2019-04-06T00:17:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dbaileyut",
                                           "body":  "Note: the first server returned \"gg\" must be unreachable in your test environment.",
                                           "updatedAt":  "2019-04-06T00:17:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6a4qRr",
                                           "createdAt":  "2025-01-17T14:55:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "brajjan",
                                           "body":  "This is still a problem. We first encountered it when decomissioning a domain controller and needed to turn off one domain controller to make sure no one had hard-coded the fqdn of that domaincontroller in their code. Every script that used System.DirectoryServices.AccountManagement.Principal.GetGroups() resulted in an error because the turned off domain controller was first in the list. \n\nIt should be some kind of validation to of that GC and move on to the next one in line if it does not respond. Or proper documentation about this.",
                                           "updatedAt":  "2025-01-17T14:55:20Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "Group lookup fails if first Global Catalog server is down",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/30408",
        "createdAt":  "2019-07-29T11:23:53Z",
        "number":  30408,
        "author":  "fubar-coder",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC7DFyA==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "Greg-Smulko",
                                            "createdAt":  "2020-08-21T08:02:39Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "MichelZ",
                                            "createdAt":  "2022-04-21T07:23:24Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "campersau",
                                            "createdAt":  "2024-09-16T14:22:38Z"
                                        }
                                    ],
                          "totalCount":  3
                      },
        "updatedAt":  "2021-10-05T18:19:07Z",
        "body":  "# Error message\r\n\r\n`UserPrincipal.Current` throws the following exception:\r\n\r\n```text\r\nAn unhandled exception has occurred while executing the request.\r\nSystem.InvalidCastException: Unable to cast object of type \u0027System.DirectoryServices.AccountManagement.GroupPrincipal\u0027 to type \u0027System.DirectoryServices.AccountManagement.UserPrincipal\u0027.\r\n   at System.DirectoryServices.AccountManagement.UserPrincipal.FindByIdentity(PrincipalContext context, IdentityType identityType, String identityValue)\r\n   at System.DirectoryServices.AccountManagement.UserPrincipal.get_Current()\r\n```\r\n\r\n# Test scenario\r\n\r\n- Create an ASP.NET Core (3.0 preview 7) application\r\n- Create an API controller\r\n- Implement a GET method\r\n- Publish to IIS\r\n- Try to access API via browser (tested with IE preview and FF 68.0.1)\r\n- Enter domain credentials into the login dialog box\r\n\r\nCreating a simple console application is not sufficient!\r\n\r\n# Environment\r\n\r\n## dotnet --info\r\n\r\n```text\r\n.NET Core SDK (gemäß \"global.json\"):\r\n Version:   2.1.302\r\n Commit:    9048955601\r\n\r\nLaufzeitumgebung:\r\n OS Name:     Windows\r\n OS Version:  6.3.9600\r\n OS Platform: Windows\r\n RID:         win81-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\2.1.302\\\r\n\r\nHost (useful for support):\r\n  Version: 3.0.0-preview7-27912-14\r\n  Commit:  4da6ee6450\r\n\r\n.NET Core SDKs installed:\r\n  2.1.302 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET Core runtimes installed:\r\n  Microsoft.AspNetCore.All 2.1.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.5 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.2.0 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.2.6 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.App 2.1.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.5 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.2.0 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.2.6 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 3.0.0-preview7.19365.7 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 2.1.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.5 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.2.0 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.2.6 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 3.0.0-preview7-27912-14 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n```\r\n\r\n## Computer\r\n\r\n- Windows Server 2012 R2\r\n- In Domain\r\n\r\n## IIS\r\n\r\n- Enabled authentication mechanisms: Anonymous, Windows\r\n\r\n## web.config\r\n\r\n```xml\r\n\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\r\n\u003cconfiguration\u003e\r\n  \u003clocation path=\".\" inheritInChildApplications=\"false\"\u003e\r\n    \u003csystem.webServer\u003e\r\n      \u003chandlers\u003e\r\n        \u003cadd name=\"aspNetCore\" path=\"*\" verb=\"*\" modules=\"AspNetCoreModuleV2\" resourceType=\"Unspecified\" /\u003e\r\n      \u003c/handlers\u003e\r\n      \u003caspNetCore processPath=\"dotnet\" arguments=\".\\test.dll\" stdoutLogEnabled=\"true\" stdoutLogFile=\".\\logs\\stdout\" hostingModel=\"inprocess\" /\u003e\r\n    \u003c/system.webServer\u003e\r\n  \u003c/location\u003e\r\n\u003c/configuration\u003e\r\n```\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHONioGhQ==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDUxNjQ3NTk5OA==",
                                           "createdAt":  "2019-07-30T15:42:10Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "MarcoRossignoli",
                                           "body":  "I can repro, some more stack\r\n```\r\nSystem.InvalidCastException: Unable to cast object of type \u0027System.DirectoryServices.AccountManagement.GroupPrincipal\u0027 to type \u0027System.DirectoryServices.AccountManagement.UserPrincipal\u0027.\r\n   at System.DirectoryServices.AccountManagement.UserPrincipal.FindByIdentity(PrincipalContext context, IdentityType identityType, String identityValue)\r\n   at System.DirectoryServices.AccountManagement.UserPrincipal.get_Current()\r\n   at tmp.Controllers.WeatherForecastController.Get() in ...\\Controllers\\WeatherForecastController.cs:line 30\r\n   at lambda_method(Closure , Object , Object[] )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State\u0026 next, Scope\u0026 scope, Object\u0026 state, Boolean\u0026 isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State\u0026 next, Scope\u0026 scope, Object\u0026 state, Boolean\u0026 isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.\u003cInvokeFilterPipelineAsync\u003eg__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.\u003cInvokeAsync\u003eg__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.\u003cInvoke\u003eg__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()\r\n```\r\nMy config is IIS on Win10 in a domain\r\nI\u0027ll go on with investigation...\r\n",
                                           "updatedAt":  "2019-07-30T15:57:18Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDUxNzc0OTE1MQ==",
                                           "createdAt":  "2019-08-02T15:43:11Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOAv1J0w==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "TiloGit",
                                                                               "createdAt":  "2019-09-03T22:38:53Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "MarcoRossignoli",
                                           "body":  "@fubar-coder do you want to have the thread user or the logged-in user?\r\nBecause `UserPrincipal.Current` per guide returns `the current user under which the thread is running.` in your/my case is app pool identity that in IIS is a virtual account https://docs.microsoft.com/en-us/iis/manage/configuring-security/application-pool-identities\r\n***It\u0027s true that in case the app pool user is not a domain user that api fails.***\r\nBtw if you use `User.Identity.Name` you\u0027ll get authenticated user(domain user after popup login) this is my auth iis setup:\r\n![image](https://user-images.githubusercontent.com/7894084/62381828-97c62d00-b54c-11e9-8f5d-2277823f8162.png)\r\nApp pool identity a \"domain user\"(no default `ApplicationPoolIdentity`)\r\nSome more info on stackoverflow https://stackoverflow.com/questions/11014406/unable-to-cast-object-of-type-in-system-directoryservices-accountmanagement-grou\r\nMaybe api should return null o better exception if current thread is not a \"user\" but a special scenario\r\nHope help",
                                           "updatedAt":  "2019-08-02T15:59:29Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDUxNzk1MTkxMg==",
                                           "createdAt":  "2019-08-03T20:20:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "fubar-coder",
                                           "body":  "Thank you for the information. A better error message would be helpful, I guess.",
                                           "updatedAt":  "2019-08-03T20:20:57Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY0OTgwMTcyNA==",
                                           "createdAt":  "2020-06-25T20:30:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC9fzEQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "hamjo",
                                                                               "createdAt":  "2023-06-08T19:50:19Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "orinem",
                                           "body":  "#38411 is similar and may well have the same cause, but occurs on a plain Windows 10 machine that is logged in with an Azure AD user.  ASP.NET and IIS are **not** involved and a simple console application **is** sufficient to reproduce the bug.",
                                           "updatedAt":  "2020-06-25T20:30:37Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjIzNzY1NA==",
                                           "createdAt":  "2020-07-09T16:51:17Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ericstj",
                                           "body":  "@tquerec this doesn\u0027t appear to be a regression as the code hasn\u0027t been touched here. Is it by design that UserPrincipal would throw in these cases?\r\n\r\nHas anyone tested similar behavior in a desktop app?\r\n\r\n/cc @joperezr ",
                                           "updatedAt":  "2020-07-09T16:51:17Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI0MTIyNg==",
                                           "createdAt":  "2020-07-09T16:58:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ericstj",
                                           "body":  "#38411 mentions it fails on .NETFramework too.    Perhaps something about how user is represented is not handled well by UserPrincipal.",
                                           "updatedAt":  "2020-07-09T16:58:58Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI0NjA3Mw==",
                                           "createdAt":  "2020-07-09T17:09:12Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "orinem",
                                           "body":  "No, there\u0027s no regression.  It\u0027s a case the code doesn\u0027t contemplate.\r\n\r\nAs I tracked down in  #38411, for the AzureAD user, it fails to recognize the SID as a user SID.\r\n\r\nI didn\u0027t track it as far as the invalid cast, but since it thinks the SID isn\u0027t a user SID, it\u0027s not too surprising it ends up with a GroupPrincipal and that the subsequent cast to a UserPricipal fails.",
                                           "updatedAt":  "2020-07-09T17:09:12Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3Njc4NjcxMQ==",
                                           "createdAt":  "2020-08-19T22:44:39Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@joperezr perhaps this shouldn\u0027t be 5.0",
                                           "updatedAt":  "2020-08-19T22:44:39Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3Njc4ODczMw==",
                                           "createdAt":  "2020-08-19T22:49:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I agree this shouldn\u0027t be 5.0 as it is not a regression, but TBH I\u0027m not sure if this behaviour is by design or not as most of my knowledge with System.DirectoryServices is in the Protocols contract, and this path seems to be coming from AccountManagement so I\u0027ll defer to @tquerec here. Even if this is something we want to fix, it shouldn\u0027t be flagged as 5.0 as it isn\u0027t a regression so I\u0027m pushing this back to 6.0 for now",
                                           "updatedAt":  "2020-08-19T22:49:38Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY5OTA0MTc0NQ==",
                                           "createdAt":  "2020-09-25T17:00:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC9fx8Q==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "hamjo",
                                                                               "createdAt":  "2023-06-08T19:46:41Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "orinem",
                                           "body":  "This is a bug.  It is throwing an inappropriate exception.  The documented exceptions are:\r\n```\r\nExceptions\r\nInvalidOperationException\r\nThe underlying store does not support this property.\r\n\r\nNoMatchingPrincipalException\r\nThe user principal object for the current user could not be found. The principal object may contain an access control list to prevent access by unauthorized users.\r\n\r\nMultipleMatchesException\r\nMultiple user principal objects matching the current user were found.\r\n```\r\nI explained what was going on in #38411:\r\n\r\nThe first problem is that an Azure AD user SID has an S-1-12-1 prefix which ClassifySID classifies as FakeObject. It\u0027s expecting an S-1-5-21 prefix.\r\n\r\nThings go downhill from there.",
                                           "updatedAt":  "2020-09-25T17:00:03Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDcyNjI0NDA0MA==",
                                           "createdAt":  "2020-11-12T18:04:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "shueybubbles",
                                           "body":  "We have an Winforms app for internal customers that hits this invalidcastexception as well, and those users are not using Azure AD-joined machines. They are on corpnet, joined to the corporate domains directly. One example user who hits this exception has a SID starting with S-1-5-5\r\n",
                                           "updatedAt":  "2020-11-12T18:04:20Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc42KgaF",
                                           "createdAt":  "2021-08-30T21:47:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODRUOsw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "jtanios",
                                                                               "createdAt":  "2024-01-05T01:57:36Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "ccyjava",
                                           "body":  "Do we have any solution for this(get current user/email)? ",
                                           "updatedAt":  "2021-08-30T21:47:21Z"
                                       }
                                   ],
                         "totalCount":  12
                     },
        "title":  "UserPrincipal.FindByIdentity throws InvalidCastException",
        "labels":  [
                       "question",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/31507",
        "createdAt":  "2019-11-16T04:27:26Z",
        "number":  31507,
        "author":  "hishamco",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-01-09T00:46:55Z",
        "body":  "I\u0027m struggling to run some of the `System.DirectoryServices.AccountManagement` APIs with Open DJ, all the time the `PrincipalContext` failed, nothing but `DirectoryEntry` works nicely with Open DJ\r\n\r\nAny idea?\r\n\r\n/cc @tarekgh",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOmbfing==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6Zt-Ke",
                                           "createdAt":  "2025-01-09T00:46:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "hishamco",
                                           "body":  "5 years with no response?!!",
                                           "updatedAt":  "2025-01-09T00:46:44Z"
                                       }
                                   ],
                         "totalCount":  1
                     },
        "title":  "DirectoryServices.AccountManagement \u0026 Open DJ",
        "labels":  [
                       "question",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/1185",
        "createdAt":  "2019-12-27T05:56:20Z",
        "number":  1185,
        "author":  "iSazonov",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-07-18T17:48:47Z",
        "body":  "[AdvancedFilters.AccountExpirationDate](https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.accountmanagement.advancedfilters.accountexpirationdate) works well for ContextType.Machine but for ContextType.Domain PrincipalSearcher returns extra results.\r\n\r\n[Code for the first (SAM) case](https://github.com/dotnet/runtime/blob/ad97a127d91c53080265794c7a57e0faee4d7c2d/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/SAM/SAMQuerySet.cs#L348-L408) uses DateTimeMatcher() which takes into account  MatchType.\r\n[Code for the second (Domain) case](https://github.com/dotnet/runtime/blob/ad97a127d91c53080265794c7a57e0faee4d7c2d/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx_Query.cs#L779-L800) ignores MatchType and always makes equality comparison for accountExpires LDAP attribute:\r\nhttps://github.com/dotnet/runtime/blob/ad97a127d91c53080265794c7a57e0faee4d7c2d/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx_Query.cs#L794-L796\r\n\r\nI guess I found not all code paths but at least simple DateTime comparison doesn\u0027t work because the code should takes into account special values `(accountExpires=9223372036854775807)(accountExpires=0)`.\r\nIf I do `user.AdvancedSearchFilter.AccountExpirationDate(DateTime.Now, MatchType.LessThan)` this returns accounts with `accountExpires=0`. As result the query returns all non-expired account that can be huge. I\u0027d expect that the query returns only really expired accounts from AD.\r\nFilter from `GetUnderlyingSearcher()`:\r\n```c#\r\n(\u0026(objectCategory=user)(objectClass=user)(\u0026(accountExpires\u003c=132219006696725696)(!(accountExpires=132219006696725696))(accountExpires=*)))\r\n```\r\nExpected:\r\n```c#\r\n(\u0026(objectCategory=user)(objectClass=user)(\u0026(accountExpires\u003c=132219006696725696)(!(accountExpires=0))))\r\n```\r\nFor MatchType.GreatThan expected:\r\n```c#\r\n(\u0026(objectCategory=user)(objectClass=user)(\u0026(accountExpires\u003e=132219006696725696)(!(accountExpires=9223372036854775807))))\r\n```",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  null,
                         "nodes":  [

                                   ],
                         "totalCount":  0
                     },
        "title":  "AdvancedFilters.AccountExpirationDate don\u0027t work as expected for ActiveDirectory",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/34598",
        "createdAt":  "2020-04-06T17:04:20Z",
        "number":  34598,
        "author":  "iSazonov",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-08-26T10:10:33Z",
        "body":  "In PowerShell repo we started [porting Microsoft.PowerShell.LocalAccounts module](https://github.com/PowerShell/PowerShell/pull/12242) to System.DirectoryServices.AccountManagement API (from p/invokes).\r\nWe had to use workarounds because Principal.FindByIdentity() methods is extremely slow - up to 100x(!) vs Principal.PrincipalSearcher().\r\n\r\nOn my notebook `Get-LocalUser name` ported cmdlet takes 2.8 sec(!) vs 25 ms if a workaround is used.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOia18Bg==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYwOTkxODM5Ng==",
                                           "createdAt":  "2020-04-06T17:04:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging @safern, @viktorhofer as an [area owner](https://github.com/dotnet/runtime/blob/master/docs/area-owners.md)",
                                           "updatedAt":  "2020-04-06T17:04:23Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI1MjQ1OA==",
                                           "createdAt":  "2020-07-09T17:22:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ericstj",
                                           "body":  "@tquerec does this sound right?  Perhaps the two different methods are considering a broader set of results than is expected.",
                                           "updatedAt":  "2020-07-09T17:22:38Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDcwNjAwNDc4NA==",
                                           "createdAt":  "2020-10-09T06:49:39Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOEbL9vA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "iSazonov",
                                                                               "createdAt":  "2022-08-31T07:26:54Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "eg-ops",
                                                                               "createdAt":  "2025-06-06T14:52:12Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "jackbuehner",
                                                                               "createdAt":  "2025-07-19T18:00:10Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "simon-biber",
                                           "body":  "UserPrincipal.FindByIdentity seems to be doing some sort of query on each network interface. Disabling the \u0027Client for Microsoft Networks\u0027 protocol on my VPN interface reduced the time for FindByIdentity from several seconds down to several milliseconds. I found this workaround here: https://stackoverflow.com/questions/7533790/findbyidentity-performance-differences",
                                           "updatedAt":  "2020-10-09T06:49:39Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4_h_nw",
                                           "createdAt":  "2022-03-12T12:35:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "deeprobin",
                                           "body":  "Has anyone profiled the problem yet?\r\nIf it is due to slow network interface querying, perhaps we should create an external issue with Windows.\r\n",
                                           "updatedAt":  "2022-03-12T12:35:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Jdq63",
                                           "createdAt":  "2022-08-31T06:25:50Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "AloisKraus",
                                           "body":  "I have found the same issue. Disabling Netios in TCP/IP helps to some extent, but the acutal issue is this call stack which tried to lookup for any passed user/group the domain controller via Netbios, regardless if the TCP Netbios settings are enabled or not. \r\n\r\nSystem.DirectoryServices.AccountManagement.ni.dll!System.DirectoryServices.AccountManagement.SAMStoreCtx.FindNativeByNT4IdentRef(System.Type, System.String)\r\n|- System.DirectoryServices.ni.dll!System.DirectoryServices.PropertyCollection.get_Item(System.String)\r\n|    System.DirectoryServices.ni.dll!System.DirectoryServices.PropertyValueCollection..ctor(System.DirectoryServices.DirectoryEntry, System.String)\r\n|    System.DirectoryServices.ni.dll!System.DirectoryServices.PropertyValueCollection.PopulateList()\r\n|    |- System.DirectoryServices.ni.dll!System.DirectoryServices.DirectoryEntry.get_AdsObject()\r\n|    |    System.DirectoryServices.ni.dll!System.DirectoryServices.DirectoryEntry.Bind()\r\n|    |    System.DirectoryServices.ni.dll!System.DirectoryServices.DirectoryEntry.Bind(Boolean)\r\n|    |    System.DirectoryServices.ni.dll!System.DirectoryServices.Interop.UnsafeNativeMethods.ADsOpenObject(System.String, System.String, System.String, Int3\r\n|    |    System.DirectoryServices.ni.dll!DomainBoundILStubClass.IL_STUB_PInvoke(System.String, System.String, System.String, Int32, System.Guid ByRef, System\r\n|    |    activeds.dll!ADsOpenObject\r\n|    |    adsnt.dll!CWinNTNamespace::OpenDSObject\r\n|    |    adsnt.dll!GetObjectW\r\n|    |    adsnt.dll!GetGroupObject\r\n|    |    adsnt.dll!ValidateGroupObject\r\n|    |    |- adsnt.dll!WinNTGetCachedDCName\r\n|    |    |    adsnt.dll!WinNTGetCachedObject\r\n|    |    |    adsnt.dll!DsGetDcNameNTWrapper\r\n|    |    |    logoncli.dll!DsGetDcNameW\r\n|    |    |    logoncli.dll!DsGetDcNameWithAccountW\r\n|    |    |    |- logoncli.dll!DsWsaGetDcName\r\n|    |    |    |    logoncli.dll!DsIGetDcName\r\n|    |    |    |    logoncli.dll!NetpDcGetName\r\n|    |    |    |    |- logoncli.dll!NetpDcGetNameNetbios\r\n\r\nThe NetDcGetNameNetbio waits for 40s until it times out. That happens even when you disable Netbios in TCP/IP settings. \r\n\r\nIs there some way to disable this call somehow, when no NetBios server is available?\r\n\r\nLater calls are cached so this impact is not always present, but during boot it will delay things a lot. \r\n\r\n**Update**\r\nAfter disabling NetBios over TCP on ALL network interfaces the issue did go away. \r\n\r\n",
                                           "updatedAt":  "2022-09-02T22:46:25Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6JNzu0",
                                           "createdAt":  "2024-08-21T13:44:33Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "pierophp",
                                           "body":  "Is there a particular reason to .NET not having Principal.FindByIdentity**Async**?",
                                           "updatedAt":  "2024-08-21T13:44:33Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6JqgtK",
                                           "createdAt":  "2024-08-26T08:17:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "deeprobin",
                                           "body":  "\u003e Is there a particular reason to .NET not having Principal.FindByIdentity**Async**?\r\n\r\nI think it\u0027s because the underlying Win32-API calls are not asynchronous (e.g. network calls with IO Completion Ports).\r\nSee `https://learn.microsoft.com/en-us/windows/win32/api/lmaccess/nf-lmaccess-netgetdcname`.\r\n\r\nWell you could wrap the synchronous call in an async Task (e.g. Task.Run / Task.Factory.StartNew), but that\u0027s not \"truly asynchronous\".",
                                           "updatedAt":  "2024-08-26T08:17:05Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6Jqmmb",
                                           "createdAt":  "2024-08-26T08:29:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "AloisKraus",
                                           "body":  "@pierophp:\r\n\r\nExcept for network communication I would not use truly async calls. In my experience async is just a synonym for making obvious delays harder to analyze for no gains. In the end you have threads waiting on your behalf without any context. If that pattern is so good why does the underlying OS use almost everywhere blocking synchronous calls? Things quickly fall apart of you mix async calls with parallel loops and hope for performance improvements. If you try to e.g. write from dozens of threads to a single disk to multiple files you will find out that a single thread will perform much better. There may be gains if you go multi threaded but you need to measure first how much async IO the underlying storage can efficiently handle. ",
                                           "updatedAt":  "2024-08-26T08:29:03Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6Jqpyp",
                                           "createdAt":  "2024-08-26T08:35:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "simon-biber",
                                           "body":  "FindByIdentity is network communication. It\u0027s an LDAP query to a directory server. ",
                                           "updatedAt":  "2024-08-26T08:35:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6JrXwG",
                                           "createdAt":  "2024-08-26T10:10:31Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "deeprobin",
                                           "body":  "\u003e FindByIdentity is network communication. It\u0027s an LDAP query to a directory server.\r\n\r\nThat\u0027s right, but the underlying Win32-call is a synchronous call. I haven\u0027t found an async equivalent for this.\r\nSo if you wan\u0027t it async, it\u0027s just blocking wrapped in a Task.",
                                           "updatedAt":  "2024-08-26T10:10:31Z"
                                       }
                                   ],
                         "totalCount":  10
                     },
        "title":  "Principal.FindByIdentity() method is extremely slow",
        "labels":  [
                       "area-System.DirectoryServices",
                       "tenet-performance",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/35189",
        "createdAt":  "2020-04-20T04:51:35Z",
        "number":  35189,
        "author":  "tquerec",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-07-18T17:50:17Z",
        "body":  "the try/finally block in LdapConnection.ConstructEntry here is not hardened to Thread.Abort causing a double free of the underlying LDAP memory.  The code needs to be refactored to use a pattern similar to SafeHandle to prevent this.\r\n\r\n            try\r\n            {\r\n                // …\r\n\r\n                // get attributes                \r\n                attribute = Wldap32.ldap_first_attribute(ldapHandle, entryMessage, ref address);\r\n                \r\n                int tempcount = 0;                \r\n                while(attribute != (IntPtr)0)\r\n                {   \r\n                   // after this line attribute is freed but attribute != 0\r\n                    Wldap32.ldap_memfree(attribute);         \r\n                    tempcount++;\r\n\r\n                    // Thread.Abort can happen here when we enter the runtime to make this pinvoke, but before before attribute is assigned.\r\n                    // This leads to a double free in the finally block, because attribute != 0, but the underlying attribute is already freed\r\n                    attribute = Wldap32.ldap_next_attribute(ldapHandle, entryMessage, address);         \r\n                }                \r\n\r\n                if(address != (IntPtr)0)\r\n                {\r\n                    Wldap32.ber_free(address, 0);\r\n                    address = (IntPtr)0; \r\n                }                               \r\n                \r\n                return resultEntry; \r\n            }\r\n            finally\r\n            {\r\n                // attribute will now make its way out to ldap_memfree even though it’s already been freed\r\n                if(attribute != (IntPtr)0)\r\n                    Wldap32.ldap_memfree(attribute);\r\n            }\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHONEH0TA==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI0ODIyNg==",
                                           "createdAt":  "2020-07-09T17:13:41Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ericstj",
                                           "body":  "@tquerec Thread.Abort is not supported on .NETCore.  Agree that we can improve this code using SafeHandle.",
                                           "updatedAt":  "2020-07-09T17:13:41Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDg3NjYzMjMyMQ==",
                                           "createdAt":  "2021-07-08T17:54:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "krwq",
                                           "body":  "@GrabYourPitchforks any opinions on moving this to 7.0?",
                                           "updatedAt":  "2021-07-08T17:54:38Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDg3NjczNzYxMg==",
                                           "createdAt":  "2021-07-08T20:51:43Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOBx56QQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "krwq",
                                                                               "createdAt":  "2021-07-09T10:19:53Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "GrabYourPitchforks",
                                           "body":  "This package is built for netstandard2.0, which runs on platforms that support `Thread.Abort` (like Full Framework). Agree that we should use SafeHandle or CERs here for such platforms, and also agree that it\u0027s a minor enough problem that there\u0027s no rush to get it in for 6.0.",
                                           "updatedAt":  "2021-07-08T20:51:43Z"
                                       }
                                   ],
                         "totalCount":  3
                     },
        "title":  "Double free in System.DirectoryServices.LdapConnection",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices",
                       "tenet-reliability"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/36947",
        "createdAt":  "2020-05-24T12:16:16Z",
        "number":  36947,
        "author":  "brunobritodev",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-07-18T17:51:25Z",
        "body":  "### Description\r\n\r\nI\u0027m running the following code snippet both for Windows and Linux Environment.\r\n\r\n``` c#\r\nvar credential = new NetworkCredential(\"\u003cusername\u003e\", \"\u003cpassword\u003e\");\r\n\r\nvar connection = new LdapConnection(new LdapDirectoryIdentifier(\"\u003cip(13.0.0.0)\u003e\", 389, false, false), credential)\r\n{\r\n    AuthType = AuthType.Ntlm\r\n};\r\n\r\nconnection.Bind();\r\n```\r\nUnder Windows environment it\u0027s not necessary to concat domain at username. But when running under Linux environment it\u0027s necessary, of course a Invalid Credential will be thrown.\r\n\r\n### Configuration\r\n\r\n* Which version of .NET is the code running on?\r\n.NET 5\r\n* What OS and version, and what distro if applicable?\r\nLinux Debian 10 - Container runtime:5.0-buster-slim\r\n\r\n### Other information\r\n\r\nI was looking at [libldap docs](https://libldap.readthedocs.io/en/latest/LDAPObject.html?highlight=bind_s#LDAP.simple_bind_s). `bind_s` and `simple_bind_s` actually are the same and just support LDAP_AUTH_SIMPLE.\r\n\r\nSo, why we don\u0027t concat domain name in every case (when it\u0027s available) for Linux?\r\n\r\nMy suggestions is, at BindHelper() on [LdapConnection.cs](https://github.com/dotnet/runtime/blob/master/src/libraries/System.DirectoryServices.Protocols/src/System/DirectoryServices/Protocols/ldap/LdapConnection.cs#L1103) line 1099, remove this `if` and put it into Linux / Windows specific logic. And also at Linux do the same domain treatment for every scenarios that **Domain name** is available.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOLboASA==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI2ODgyMA==",
                                           "createdAt":  "2020-07-09T17:57:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Marking as an enhancement instead since in reality what we want here is to not require domain name on user, which might not be possible given the limitations of the underlying native library.",
                                           "updatedAt":  "2020-07-09T17:57:55Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDA0NTAyNQ==",
                                           "createdAt":  "2020-12-13T18:00:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCU7L1Q==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2020-12-14T04:59:25Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "TalllDwarf",
                                                                               "createdAt":  "2021-06-29T15:03:38Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "surfmuggle",
                                                                               "createdAt":  "2022-03-28T11:12:10Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "menees",
                                           "body":  "I\u0027ve just spent a couple of days getting my LDAP logic to work from both Windows and Linux when talking to my Windows 2016 Active Directory using the S.DS.P 5.0.0 package. The [original thread by brunohbrito](https://github.com/dotnet/runtime/issues/36888) was extremely helpful. Since that original thread is locked, I thought I\u0027d post my experience here in case it helps someone else or the .NET 6.0 planning.\r\n\r\nThe internal Linux implementation is much more picky about inputs than the Windows implementation. To get things to work from Linux I had to make several `!OperatingSystem.IsWindows()` checks.\r\n\r\nAs @brunohbrito mentioned, on Linux I had to put a \"MyDomain\\\\\" prefix on the userName that I passed to NetworkCredential. It would be nice to see [his PR](https://github.com/dotnet/runtime/pull/36949) get pulled in. To find that domain component in my Linux implementation I anonymously queried the server\u0027s base attributes to get defaultNamingContext and supportedCapabilities. Then if supportedCapabilities contains 1.2.840.113556.1.4.800 (i.e., an Active Directory server), I prefix the userName with the first DC part from the defaultNamingContext.\r\n\r\nTo do user searches from Linux I also had to prefix `CN=Users,` on the distinguishedName passed to SearchRequest. From Windows I was able to do user searches with SearchScope.Subtree from the defaultNamingContext. But Linux requires the search to start from `\"CN=Users,\" + defaultNamingContext`. It almost seems like on Linux that SearchScope.Subtree is behaving like SearchScope.OneLevel. Without the CN=Users prefix on Linux the code would throw \"DirectoryOperationException: An operation error occurred.\".\r\n\r\nOn Linux I can\u0027t set LdapConnection.SessionOptions.VerifyServerCertificate (even to a simple \"=\u003etrue\" handler). I assume this is because LDAP_OPT_SSL isn\u0027t supported as @joperezr mentions [here](https://github.com/dotnet/runtime/issues/36888#issuecomment-648457142). Trying to add a handler caused an \"LdapException: The LDAP server returned an unknown error.\" with ErrorCode = -1.\r\n\r\nA final problem I had on Linux was that it does not allow extra parentheses in search filters (but Windows does). For example, I was building a filter like `(\u0026(objectCategory=Person)(objectClass=user)((sAMAccountName=abc)))`. The extra parentheses around `sAMAccountName=abc` caused the Linux code to throw \"LdapException: The LDAP server returned an unknown error.\" with ErrorCode = -7. Changing my code to build the filter without unnecessary parentheses made the code work on Linux and Windows.\r\n\r\nIt\u0027s also worth mentioning that passing in custom attributeList values for SearchRequest attribute filtering works as expected, and it works even when requesting attributes that don\u0027t exist. So the [concern expressed by joperezr](https://github.com/dotnet/runtime/issues/36888#issuecomment-633257012) wasn\u0027t a problem.",
                                           "updatedAt":  "2020-12-13T18:00:44Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDA0NjA4Nw==",
                                           "createdAt":  "2020-12-13T18:10:02Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCnAWXw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2020-12-14T04:59:49Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "mrybson",
                                                                               "createdAt":  "2020-12-14T19:33:29Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "surfmuggle",
                                                                               "createdAt":  "2022-03-28T11:12:45Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "rayoneitalo",
                                                                               "createdAt":  "2022-07-15T20:33:22Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  4
                                                         },
                                           "author":  "menees",
                                           "body":  "In the interest of helping others, here\u0027s a fairly complete example of code that works on both Windows and Linux for me.\r\n\r\n# Program.cs\r\n\r\n``` C#\r\nusing System;\r\nusing System.Collections;\r\nusing System.Collections.Generic;\r\nusing System.Diagnostics;\r\nusing System.DirectoryServices.Protocols;\r\nusing System.Linq;\r\nusing System.Text;\r\n\r\nnamespace LdapTest\r\n{\r\n    internal static class Program\r\n    {\r\n        // https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/assigning-domain-names\r\n        private const string _PrimaryDC = \"MyPDC\";\r\n        private const string _SecondaryDC = \"MySDC\";\r\n        private const string _DnsPrefix = \"MyPrefix\";\r\n        private const string _DnsSuffix = \"example\";\r\n        private const string _DnsTopLevel = \"com\";\r\n        private const string _UserName = \"KnownUser\";\r\n        private const string _Password = \"\u003cpassword\u003e\";\r\n\r\n        private static readonly string _DefaultNamingContext = $\"DC={_DnsPrefix},DC={_DnsSuffix},DC={_DnsTopLevel}\";\r\n        private static readonly string _DnsName = $\"{_DnsPrefix}.{_DnsSuffix}.{_DnsTopLevel}\";\r\n        private static readonly string _PrimaryServer = $\"{_PrimaryDC}.{_DnsName}\";\r\n        private static readonly string _SecondaryServer = $\"{_SecondaryDC}.{_DnsName}\";\r\n\r\n        private static void Main()\r\n        {\r\n            try\r\n            {\r\n                // Search the base OU to get attributes like defaultNamingContext and supportedCapabilities.\r\n                // If supportedCapabilities contains 1.2.840.113556.1.4.800 then we know it\u0027s an Active Directory per\r\n                // https://www.alvestrand.no/objectid/1.2.840.113556.1.4.800.html.\r\n                Search(string.Empty, \"objectClass=*\", SearchScope.Base, \"defaultNamingContext\", \"dnsHostName\", \"supportedCapabilities\");\r\n\r\n                // On Windows we can do user searches from the defaultNamingContext\u0027s container.\r\n                // On Linux we have to target the \"CN=Users\" container, or the search throws: DirectoryOperationException: An operation error occurred.\r\n                // Maybe on Linux SearchScope.Subtree is behaving like SearchScope.OneLevel?\r\n                Search(\r\n                    (OperatingSystem.IsWindows() ? string.Empty : \"CN=Users,\") + _DefaultNamingContext,\r\n                    \"(\u0026(objectCategory=Person)(objectClass=user)(displayName=*Robert*))\",\r\n                    SearchScope.Subtree,\r\n                    \"cn\",\r\n                    \"sAMAccountName\",\r\n                    \"objectSid\");\r\n            }\r\n            catch (LdapException ex)\r\n            {\r\n                Console.WriteLine(ex.ErrorCode);\r\n                Console.WriteLine(ex.ServerErrorMessage);\r\n                Console.WriteLine(ex.ToString());\r\n            }\r\n            catch (DirectoryOperationException ex)\r\n            {\r\n                Console.WriteLine(ex.Response);\r\n                Console.WriteLine(ex.ToString());\r\n            }\r\n            catch (Exception ex)\r\n            {\r\n                Console.WriteLine(ex.ToString());\r\n            }\r\n\r\n            if (Debugger.IsAttached)\r\n            {\r\n                Console.WriteLine(\"Press any key to close...\");\r\n                Console.ReadKey(true);\r\n            }\r\n        }\r\n\r\n        private static void Search(string targetOu, string query, SearchScope scope, params string[] attributeList)\r\n        {\r\n            // On Linux we have to give it a FQDN. On Windows we can give it an empty string, and it will locate a DC.\r\n            string serverName = DateTime.UtcNow.Second % 2 == 0 ? _PrimaryServer : _SecondaryServer;\r\n            Console.WriteLine($\"Using server {serverName}\");\r\n\r\n            using LdapConnection connection = new LdapConnection(serverName);\r\n\r\n            if (!string.IsNullOrEmpty(targetOu))\r\n            {\r\n                // On Linux we have to set connection.Credential, or user search requests throw DirectoryOperationException: An operation error occurred.\r\n                // On Windows, setting Credential is optional (probably because of implicit NTLM authentication).\r\n                // On Linux we have to prefix \"_DnsPrefix\\\" on the user name too, based on the tip from brunohbrito here:\r\n                // https://github.com/dotnet/runtime/issues/36888#issuecomment-633220620\r\n                string userName = OperatingSystem.IsWindows() ? _UserName : $\"{_DnsPrefix}\\\\{_UserName}\";\r\n                connection.Credential = new(userName, _Password);\r\n            }\r\n\r\n            connection.Bind();\r\n            Console.WriteLine(\"Bind() was successful.\");\r\n\r\n            const string SeparatorLine = \"-------------------------------------------------------\";\r\n            Console.WriteLine($\"Search {scope} of \u0027{targetOu}\u0027 for \u0027{query}\u0027\");\r\n            SearchRequest request = new(targetOu, query, scope, attributeList);\r\n\r\n            var response = (SearchResponse)connection.SendRequest(request);\r\n            int resultCount = response.Entries.Count;\r\n            Console.WriteLine($\"Found {resultCount} entr{(resultCount == 1 ? \"y\" : \"ies\")}.\");\r\n            Console.WriteLine(SeparatorLine);\r\n\r\n            const int EntryDisplayLimit = 2;\r\n            const int AttributeDisplayLimit = 5;\r\n            foreach (SearchResultEntry searchEntry in response.Entries.Cast\u003cSearchResultEntry\u003e().Take(EntryDisplayLimit))\r\n            {\r\n                foreach (DictionaryEntry attributeEntry in searchEntry.Attributes.Cast\u003cDictionaryEntry\u003e().OrderBy(e =\u003e e.Key).Take(AttributeDisplayLimit))\r\n                {\r\n                    DirectoryAttribute attribute = (DirectoryAttribute)attributeEntry.Value!;\r\n\r\n                    // Using IList.this[int] gives us access to the raw value, whereas DirectoryAttribute.this[int] tries to\r\n                    // blindly convert every byte[] to a string. That returns garbage for values like objectSid. This logic\r\n                    // is better, but it still converts objectGUID to a garbage string.\r\n                    IList attributeValues = attribute;\r\n                    IReadOnlyList\u003cobject\u003e values = attributeValues.Cast\u003cobject\u003e()\r\n                        .Select(value =\u003e value is byte[] bytes\r\n                            ? (bytes.Length \u003e 0 \u0026\u0026 !bytes.Any(b =\u003e b == 0)\r\n                                ? Encoding.UTF8.GetString(bytes)\r\n                                : (\"0x\" + string.Concat(bytes.Select(b =\u003e b.ToString(\"X2\")))))\r\n                            : value)\r\n                        .Distinct()\r\n                        .ToList();\r\n                    Console.WriteLine($\"\\t{attribute.Name} = {string.Join(\" | \", values)}\");\r\n                }\r\n\r\n                Console.WriteLine(SeparatorLine);\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n# LdapTest.csproj\r\n``` XML\r\n\u003cProject Sdk=\"Microsoft.NET.Sdk\"\u003e\r\n\t\u003cPropertyGroup\u003e\r\n\t\t\u003cOutputType\u003eExe\u003c/OutputType\u003e\r\n\t\t\u003cTargetFramework\u003enet5.0\u003c/TargetFramework\u003e\r\n\t\u003c/PropertyGroup\u003e\r\n\r\n\t\u003cItemGroup\u003e\r\n\t\t\u003cPackageReference Include=\"System.DirectoryServices.Protocols\" Version=\"5.0.0\" /\u003e\r\n\t\u003c/ItemGroup\u003e\r\n\u003c/Project\u003e\r\n```\r\n",
                                           "updatedAt":  "2020-12-13T18:10:02Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDA1NDI1NQ==",
                                           "createdAt":  "2020-12-13T19:12:51Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Thank you @menees. We should also resolve the error code - https://github.com/dotnet/runtime/issues/43621#issuecomment-712513986 - LDAP_FILTER_ERROR at least gives a bit more clue.",
                                           "updatedAt":  "2020-12-13T19:12:51Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDA2NTUyNA==",
                                           "createdAt":  "2020-12-13T20:41:54Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "menees",
                                           "body":  "Yes, that would be great! Seeing the error name would have clued me in to my filter problem much faster. An LdapErrorCode enum with those values would be nice too, with a property or extension to cast/convert LdapException.ErrorCode to LdapErrorCode.",
                                           "updatedAt":  "2020-12-13T20:41:54Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDA4MDk2MA==",
                                           "createdAt":  "2020-12-13T22:41:52Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@menees I went through all the codes, and created an issue describing the necessary change here: https://github.com/dotnet/runtime/issues/46021\r\n\r\nDo you have any interest in offering the change, @menees ?",
                                           "updatedAt":  "2020-12-13T22:41:52Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDY1NTU2OA==",
                                           "createdAt":  "2020-12-14T19:21:34Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "mrybson",
                                           "body":  "@danmosemsft  - thank you for posting your solution. I have now the same setup, but this after call:\r\n          `  var response = (SearchResponse)_connection.SendRequest(searchRequest);`\r\nI cannot debug and the application stops. Have you experienced that issue? I am running this on .NET Core 3.1 in a Linux environment.",
                                           "updatedAt":  "2020-12-14T19:21:34Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDY2MjIzMQ==",
                                           "createdAt":  "2020-12-14T19:33:32Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@mrybson I actually am not familiar with the directory services code. @joperezr would have to help you. \r\n\r\n\u003e I cannot debug and the application stops. \r\n\r\nNo console output at all? \r\nWhat debugger did you use -- did you start under the debugger?\r\nDid you try a native debugger?\r\n\r\nFor managed code debugging, you can try lldb if you are willing to try SOS commands (there is a learning curve): https://github.com/dotnet/runtime/blob/master/docs/workflow/debugging/libraries/unix-instructions.md and https://github.com/dotnet/runtime/blob/master/docs/workflow/debugging/coreclr/debugging.md#debugging-coreclr-on-linux-and-macos\r\n\r\nFor native debugging, apparently gdb works as an alternative.\r\n\r\nThere may also be something in syslog: https://stackoverflow.com/questions/6074362/how-to-check-syslog-in-bash-on-linux",
                                           "updatedAt":  "2020-12-14T19:33:32Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NDgzNzkxOQ==",
                                           "createdAt":  "2020-12-14T23:56:52Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOBaHW8A==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "danmoseley",
                                                                               "createdAt":  "2020-12-16T05:12:38Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "menees",
                                           "body":  "\u003e Do you have any interest in offering the change, @menees ?\r\n\r\n@danmosemsft, I\u0027m sorry I don\u0027t have more time to work on this right now.\r\n\r\n",
                                           "updatedAt":  "2020-12-14T23:56:52Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NTE4Mjc2MA==",
                                           "createdAt":  "2020-12-15T10:00:54Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOBueYUg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "cfbao",
                                                                               "createdAt":  "2021-06-13T05:42:42Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "mrybson",
                                           "body":  "@danmosemsft I just found what was the root cause of the issue. So when running from Linux, you can\u0027t use TimeLimit property in the SearchRequest object. When you use it calling SendRequest, app stops.",
                                           "updatedAt":  "2020-12-15T10:36:03Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc0NTc2ODk2Ng==",
                                           "createdAt":  "2020-12-16T05:14:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@mrybson would you mind opening a new issue for that, with repro code? That would be less confusing.",
                                           "updatedAt":  "2020-12-16T05:14:05Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc2NzE2NDQ4OA==",
                                           "createdAt":  "2021-01-25T22:51:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Just dropping a note, I closed the linked PR #36949 given it was incomplete and stale. There is a note on that PR on what is missing to get it all the way through in case anybody else is interested in picking it up, just feel free to reopen in that case.",
                                           "updatedAt":  "2021-01-25T22:51:37Z"
                                       }
                                   ],
                         "totalCount":  12
                     },
        "title":  "System.DirectoryServices.Protocols - Night build preview 6 - Compatibility between wldap32.dll and libldap",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/37100",
        "createdAt":  "2020-05-27T22:07:05Z",
        "number":  37100,
        "author":  "FWest98",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC326Kg==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "rmbolger",
                                            "createdAt":  "2020-05-27T23:25:48Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "iSazonov",
                                            "createdAt":  "2020-05-28T09:05:51Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "Misiu",
                                            "createdAt":  "2020-06-10T07:35:22Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "ebekker",
                                            "createdAt":  "2020-06-23T13:05:06Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "ryanspletzer",
                                            "createdAt":  "2020-09-12T14:29:45Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "mkeuschn",
                                            "createdAt":  "2020-09-15T06:24:50Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "bouthib",
                                            "createdAt":  "2020-09-15T19:14:19Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "nrcalytunenko",
                                            "createdAt":  "2020-10-01T17:44:45Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "orthoxerox",
                                            "createdAt":  "2020-10-21T14:42:22Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "Callum0x50",
                                            "createdAt":  "2020-11-12T10:05:39Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "b4cktr4ck2",
                                            "createdAt":  "2020-11-18T17:00:53Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "artdolya",
                                            "createdAt":  "2020-12-04T13:24:14Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "mezzo1981",
                                            "createdAt":  "2020-12-10T16:50:21Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "don-rumata",
                                            "createdAt":  "2021-01-03T11:12:45Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "mirecad",
                                            "createdAt":  "2021-01-20T08:37:46Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "CodedBeard",
                                            "createdAt":  "2021-02-04T15:03:40Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "thedavecarroll",
                                            "createdAt":  "2021-02-11T21:19:41Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "agoodwin",
                                            "createdAt":  "2021-04-06T08:37:00Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "kozhurin",
                                            "createdAt":  "2021-04-28T14:13:57Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "danports",
                                            "createdAt":  "2021-06-09T18:38:40Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "GeeWee",
                                            "createdAt":  "2021-06-25T06:07:59Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "kekropp",
                                            "createdAt":  "2021-08-18T13:41:38Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "cabadam",
                                            "createdAt":  "2021-09-04T21:11:09Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "vaibhav29498",
                                            "createdAt":  "2021-09-22T06:12:45Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "osmanaliyardim",
                                            "createdAt":  "2021-09-30T08:25:29Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "valorl",
                                            "createdAt":  "2021-09-30T09:00:06Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "glaanc03",
                                            "createdAt":  "2021-11-08T09:29:59Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "minton",
                                            "createdAt":  "2021-11-30T20:16:17Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "rafaelpirolla",
                                            "createdAt":  "2021-12-15T12:02:03Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "MCKanpolat",
                                            "createdAt":  "2022-01-07T11:41:22Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "rk-sf",
                                            "createdAt":  "2022-01-18T20:07:49Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "virubiotor",
                                            "createdAt":  "2022-01-26T13:49:49Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "louisfischer",
                                            "createdAt":  "2022-02-23T03:11:43Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "dieserRobin",
                                            "createdAt":  "2022-03-31T12:31:00Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "dil-spayne",
                                            "createdAt":  "2022-05-02T21:19:20Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "Sobotkama",
                                            "createdAt":  "2022-05-31T13:12:22Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "gkochera",
                                            "createdAt":  "2022-06-04T17:50:29Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "tzengshinfu",
                                            "createdAt":  "2022-06-15T04:37:50Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "hanneshayashi",
                                            "createdAt":  "2022-07-06T06:09:12Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "hackjammer",
                                            "createdAt":  "2023-01-10T15:33:05Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "jarronshih",
                                            "createdAt":  "2023-04-18T22:15:08Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "StrangeWill",
                                            "createdAt":  "2023-06-30T02:30:55Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "MGrolitsch-tricentis",
                                            "createdAt":  "2023-07-05T14:04:30Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "Mario-Hofstaetter",
                                            "createdAt":  "2023-08-04T08:23:36Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "jmuenzer",
                                            "createdAt":  "2023-08-04T08:24:28Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "klus0v",
                                            "createdAt":  "2023-08-21T07:43:08Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "jakauppila",
                                            "createdAt":  "2023-10-11T02:27:44Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "PavelKrysenko",
                                            "createdAt":  "2023-10-17T11:26:29Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "fartbagxp",
                                            "createdAt":  "2024-02-08T20:07:31Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "rklec",
                                            "createdAt":  "2024-05-13T13:18:53Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "0xced",
                                            "createdAt":  "2024-10-30T15:22:32Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "da-kil",
                                            "createdAt":  "2025-02-06T12:00:31Z"
                                        }
                                    ],
                          "totalCount":  52
                      },
        "updatedAt":  "2022-10-23T09:34:58Z",
        "body":  "Following the discussion in https://github.com/dotnet/runtime/issues/23944#issuecomment-634850013, this issue is to track adding support for Linux (and/or macOS) to the S.DS.AM namespace. Since S.DS.Protocols is now implemented for all platforms, a logical next step would be to look into the \"derived\" namespaces.\r\n\r\nAs for a use-case, I quote myself from the other issue:\r\n\u003e I\u0027m working on an application that does a lot of user and group management through S.DS.AM, which I am planning on running in Kubernetes. Currently, it works with Windows hosts and pods within Kubernetes, but that is tricky to manage and some of our toolkit does not work (nicely) with Windows in K8s (for example, secret injection from HashiCorp Vault). Add to that the extra licensing costs and computing resources...\r\n\u003e \r\n\u003e Reworking the application to S.DS.P is probably possible, but very inconvenient and would require significant work, as well as being more cumbersome to work with native LDAP objects instead of full-featured Principal objects from AM.\r\n\r\nI believe everything in S.DS.AM is also possible using just S.DS.P, but especially converting existing applications might be too much of a burden to make this feasible for many. On top of that, it is more difficult to manage and it makes the code more difficult to work with in general.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOJdyq1Q==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDYzNTIxODY0NQ==",
                                           "createdAt":  "2020-05-28T09:08:26Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "iSazonov",
                                           "body":  "S.DS.AM on Windows works with local accounts too.\r\nI\u0027d enhance the request to support the same on Unix-s too.\r\nOn Linux S.DS.AM could utilize PAM.\r\n\r\nMy request come from PowerShell where is a LocalAccounts module. The module uses non-public API and I port it to S.DS.AM with expectation that S.DS.AM will work on Unix-s in future for local and LDAP accounts.",
                                           "updatedAt":  "2020-05-28T09:11:33Z"
                                       }
                                   ],
                         "totalCount":  1
                     },
        "title":  "Support System.DirectoryServices.AccountManagement on Linux(/macOS)",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices",
                       "os-linux",
                       "os-mac-os-x",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/37415",
        "createdAt":  "2020-06-04T13:20:27Z",
        "number":  37415,
        "author":  "Trolldemorted",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHODJPoaQ==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "henning-krause",
                                            "createdAt":  "2020-06-18T08:33:02Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "rassokhina",
                                            "createdAt":  "2020-08-18T08:45:22Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "AnthonyMastrean",
                                            "createdAt":  "2021-07-07T13:26:22Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "hasancemcerit",
                                            "createdAt":  "2021-09-30T01:54:41Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "wbuck",
                                            "createdAt":  "2021-10-13T15:04:39Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "stop-cran",
                                            "createdAt":  "2021-11-01T15:10:31Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "mkeuschn",
                                            "createdAt":  "2022-02-08T11:52:46Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "nil4",
                                            "createdAt":  "2022-07-19T07:36:34Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "hheexx",
                                            "createdAt":  "2022-12-13T11:38:48Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "mikeplavsky",
                                            "createdAt":  "2022-12-24T05:58:18Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "vermiceli",
                                            "createdAt":  "2023-03-13T14:35:42Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "silkfire",
                                            "createdAt":  "2023-09-10T19:33:12Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "bachratyg",
                                            "createdAt":  "2023-09-14T10:47:29Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "worming004",
                                            "createdAt":  "2023-12-18T09:38:24Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "khellang",
                                            "createdAt":  "2024-01-12T14:23:02Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "ArdorDeosis",
                                            "createdAt":  "2024-07-03T03:17:29Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "sccunningham7",
                                            "createdAt":  "2024-09-12T22:54:08Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "dp-sgr",
                                            "createdAt":  "2024-10-14T14:32:33Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "t00",
                                            "createdAt":  "2025-01-11T18:30:48Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "stil",
                                            "createdAt":  "2025-06-06T10:51:23Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "DarkPro1337",
                                            "createdAt":  "2025-07-15T07:08:28Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "wheat32",
                                            "createdAt":  "2025-07-30T22:46:48Z"
                                        }
                                    ],
                          "totalCount":  22
                      },
        "updatedAt":  "2023-03-16T21:43:56Z",
        "body":  "## Background and Motivation\r\n`System.DirectoryServices.Protocols`\u0027s `LdapConnection` has a `BeginSendRequest` method, but no straightforward async method which takes a cancellation token. The `Bind` family does not offer an async API at all.\r\n\r\nWe\u0027d like to use it in an asp.net core project, where we would like to not block threadpool threads when validating login credentials.\r\n## Proposed API\r\nAdd async variants to all network operations:\r\n```c#\r\npublic async Task\u003cDirectoryResponse\u003e SendRequestAsync(DirectoryRequest request, CancellationToken token);\r\npublic async Task BindAsync(NetworkCredential newCredential, CancellationToken token);\r\npublic async Task BindAsync(CancellationToken token);\r\n```\r\n## Usage Examples\r\n```c#\r\nusing LdapConnection ldapConnection = new LdapConnection(new LdapDirectoryIdentifier(Settings.LdapServer, false, false),\r\n    new NetworkCredential(Settings.SearchUser, Settings.SearchPassword),\r\n    AuthType.Basic);\r\nawait ldapConnection.BindAsync(HttpContext.RequestAborted);\r\n```\r\n## Alternative Designs\r\nNo good alternatives came to my mind.\r\n\r\n## Risks\r\nTo my best knowledge this should not be a breaking change, and have no performance impact on existing code.\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOV8jvqQ==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY0NTg2ODgxNA==",
                                           "createdAt":  "2020-06-18T08:34:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "henning-krause",
                                           "body":  "The async Bind method is crucial, because currently there is no way AFAIK to cancel a pending bind request. The relevant timeouts can only be set via reflection. That is very messy.",
                                           "updatedAt":  "2020-06-18T08:34:22Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI0MjgxMw==",
                                           "createdAt":  "2020-07-09T17:02:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ericstj",
                                           "body":  "/cc @joperezr I think you hit this in your S.DS.P work.  Do you have anything you can share about this API proposal?",
                                           "updatedAt":  "2020-07-09T17:02:18Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI0NjM0Ng==",
                                           "createdAt":  "2020-07-09T17:09:43Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "We did fix the Begin/End implementations for Linux so there is at least one async alternative for LdapConnection. When doing so, we did noticed that the underlying native libraries used don\u0027t offer a callback async solution, so instead the way we have Begin/End implemented for now is using polling. I do agree that adding Task-based async APIs would make sense here, which at first would have to use polling as well but could evolve in the future in case we decide to use a different underlying native libraries we use today.",
                                           "updatedAt":  "2020-07-09T17:09:43Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1NjI0ODY2MA==",
                                           "createdAt":  "2020-07-09T17:14:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Also to add to that, Begin/End is only available for sending requests for now, not for binding. Native libraries do provide async solutions for binding but they also involve polling, and don\u0027t provide a truly async callback solution.",
                                           "updatedAt":  "2020-07-09T17:14:30Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Gznk5",
                                           "createdAt":  "2022-07-18T17:51:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "We won\u0027t have a chance to get to this in 7.0 as we are done taking new features. Moving this to future.",
                                           "updatedAt":  "2022-07-18T17:51:55Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5XZWWY",
                                           "createdAt":  "2023-03-13T14:37:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOEckIzw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "vermiceli",
                                                                               "createdAt":  "2023-03-13T19:53:37Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "silkfire",
                                                                               "createdAt":  "2023-09-10T19:33:42Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "wheat32",
                                                                               "createdAt":  "2025-07-30T22:47:00Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "pcappaert",
                                           "body":  "Any chance this could make it into 8.0?",
                                           "updatedAt":  "2023-03-13T14:37:27Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Xa9n3",
                                           "createdAt":  "2023-03-13T18:24:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "Sorry @pcappaert, currently this is not planned for 8.0",
                                           "updatedAt":  "2023-03-13T18:24:25Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5XyO-p",
                                           "createdAt":  "2023-03-16T21:43:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "To be clear though, by the comment from @buyaa-n above we just mean that it is not in our current priorities for 8.0, however I don\u0027t think there is anything blocking for this work to happen if someone wanted to contribute the changes. I think the best step forward for this would be to break out this issue into two proposals, one that is particular for Bind which has the two BindAsync overloads in this porposal which should be ready for review, and then one separate one for SendRequestAsync as that one might be a bit more controversial given things like the PartialResults support we have in the sync API. Once we have those two issues, we should be able to mark at least the Bind overloads as ready for review and once they are approved, then we would be ready to take contributions that add the implementation.\r\n\r\nThe most important piece here is not the design of the API\u0027s as at least in the Bind case, the API shape is obvious. The real challenge is to make sure that the APIs can actually be implemented asynchronously, as there is no point in adding the APIs if all they are doing is a Task.Run underneath. I think that at least for Bind this is possible with the openldap implementation, as all PInvokes we call end with the `_s` suffix meaning they are the `syncrhonous` versions but the libraries also seem to have an async version. Next step for this would be to try to prototype how the code would look like using those other methods and see if we can actually get an async version. If we can validate that, then this proposal should be easily approved.",
                                           "updatedAt":  "2023-03-16T21:43:55Z"
                                       }
                                   ],
                         "totalCount":  8
                     },
        "title":  "System.DirectoryServices.Protocols LdapConnection should have an async API",
        "labels":  [
                       "api-suggestion",
                       "area-System.DirectoryServices",
                       "feature-request"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/38609",
        "createdAt":  "2020-06-30T08:35:15Z",
        "number":  38609,
        "author":  "GrowSharp",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-11-03T17:56:20Z",
        "body":  "### Description\r\n\r\nWhen I try to search for a role by it\u0027s CN that contains the `\\` character, I get `The LDAP server returned an unknown error. (ldap error code: -7)`\r\nSearch request:\r\n`var searchRequest = new SearchRequest(LdapConstants.SETTING_GROUP_BASE_DIRECTORY, searchFilter, SearchScope.Subtree, LdapConstants.SettingGroupSearchAttributeFilter.ToArray());`\r\n\r\n### Configuration\r\n\r\nDomain joined CentOS 7.8.2003\r\nalso Ubuntu 20.04\r\n.NET Core 3.1.301, commit: 7feb845744\r\n.Protocols version 5.0.0-preview.5.20278.1\r\n\r\n### Regression?\r\n\r\nOn Windows it works correctly.\r\n\r\n\r\n### Other information\r\n\r\nOnly stack trace I got:\r\n`System.DirectoryServices.Protocols.LdapException: The LDAP server returned an unknown error. at System.DirectoryServices.Protocols.LdapConnection.SendRequest(DirectoryRequest request, TimeSpan requestTimeout) at System.DirectoryServices.Protocols.LdapConnection.SendRequest(DirectoryRequest request)`\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHON5mYBA==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY1MzQxODEwNQ==",
                                           "createdAt":  "2020-07-03T08:17:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GrowSharp",
                                           "body":  "Some more info.\r\nI debugged trough the whole process of sending search request trough `System.DirectoryServices.Protocols` and didn\u0027t encounter error. I also figured out that the underlying library that `System.DirectoryServices.Protocols` uses on linux is open ldap. My current suspicion is that the open ldap doesn\u0027t automatically escape special characters in accepted strings (search request also as authentication method (#38611) and so on), but underlying windows library (Wldap32) does. \r\n\r\nIf that is the case I propose to add the escaping functionality to System.DirectoryServices.Protocols.LdapConnection, so both libraries act the same on the windows as well as on linux. \r\n\r\nAs I said this is just a suspicion. I haven\u0027t been able to find a correct solution to ldap string escaping, to actually prove this theory. I will get to it again probably next week, but if anyone want\u0027s to try, or if anyone knows that this is a wrong theory, please let me know.\r\n\r\n  ",
                                           "updatedAt":  "2020-07-03T08:17:20Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3MDcxNTQ4Nw==",
                                           "createdAt":  "2020-08-07T21:12:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@GrowSharp thanks for the investigation. Did you manage to get further -- did it work if you added escaping? That might help establish whether there is anything we can safely do for 5.0 here (which is almost done)",
                                           "updatedAt":  "2020-08-07T21:12:44Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3MDcxNTk1Nw==",
                                           "createdAt":  "2020-08-07T21:14:09Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Perhaps the same fix for https://github.com/dotnet/runtime/issues/38611? ",
                                           "updatedAt":  "2020-08-07T21:14:09Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3MTIyNTA4MA==",
                                           "createdAt":  "2020-08-10T08:23:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GrowSharp",
                                           "body":  "@danmosemsft yes, I tried replacing special characters with their hexadecimal representation. Didn\u0027t worked for me tho. And yes, I agree that fixing this might also fix #38611. ",
                                           "updatedAt":  "2020-08-10T08:23:29Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3MzcyMDk1Nw==",
                                           "createdAt":  "2020-08-13T21:32:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "@GrowSharp can you share the filter you are using in the snippet above? Also is there a chance you can share the full CN you are trying to search here so that we can try reproing exactly the problem you are seeing?",
                                           "updatedAt":  "2020-08-13T21:32:04Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3NDAwNTQyOA==",
                                           "createdAt":  "2020-08-14T10:20:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GrowSharp",
                                           "body":  "@joperezr sure. \r\nOriginal CN = `CN=Portal\\#23\\#Práva supervisora`\r\n\r\nFilter with my custom escaping experiment that doesn\u0027t work: \r\n`(\u0026(objectClass=group)(distinguishedName=CN=Portal\\5c#23\\5c#Práva supervisora,OU=Portal Logistika,OU=Skupiny,OU=Users,OU=ADLER,DC=adler,DC=local))`\r\n\r\nWithout my escaping: \r\n`(\u0026(objectClass=group)(distinguishedName=CN=Portal\\#23\\#Práva supervisora,OU=Portal Logistika,OU=Skupiny,OU=Users,OU=ADLER,DC=adler,DC=local))`\r\n",
                                           "updatedAt":  "2020-08-14T10:20:59Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3NDAwNTg5Ng==",
                                           "createdAt":  "2020-08-14T10:22:12Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GrowSharp",
                                           "body":  "I would just like to add for all these issues that the AD that I\u0027m working with is a bloody mess. But it should still work tho, because on windows it does.  ",
                                           "updatedAt":  "2020-08-14T10:22:12Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3OTQyNDQwNQ==",
                                           "createdAt":  "2020-08-24T23:57:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOBOVrEw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "GrowSharp",
                                                                               "createdAt":  "2020-08-25T06:44:47Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I looked a little bit more on this, and it seems like this is a limitation on openldap. Seems like it encodes the distinguishedName property whenever it has special characters, which is why you probably can\u0027t find it when looking for an object via distinguishedName. In order to investigate this, I tried playing with `ldapsearch` tool since it uses openldap library underneath as well so it is a good exercise to compare against that to find out potential issues with S.DS.P. When searching for all of the groups on my ldap server, I get results like:\r\n```\r\n# Domain Users, Users, joesads.com\r\ndn: CN=Domain Users,CN=Users,DC=joesads,DC=com\r\nobjectClass: top\r\nobjectClass: group\r\ncn: Domain Users\r\ndescription: All domain users\r\ndistinguishedName: CN=Domain Users,CN=Users,DC=joesads,DC=com\r\ninstanceType: 4\r\nwhenCreated: 20200512193423.0Z\r\nwhenChanged: 20200512193423.0Z\r\nuSNCreated: 12348\r\nmemberOf: CN=Users,CN=Builtin,DC=joesads,DC=com\r\nuSNChanged: 12350\r\nname: Domain Users\r\nobjectGUID:: GMnpKzHc2E2f0m2RHcPWmA==\r\nobjectSid:: AQUAAAAAAAUVAAAABKFYKz4jVTZmyCfZAQIAAA==\r\nsAMAccountName: Domain Users\r\nsAMAccountType: 268435456\r\ngroupType: -2147483646\r\nobjectCategory: CN=Group,CN=Schema,CN=Configuration,DC=joesads,DC=com\r\nisCriticalSystemObject: TRUE\r\ndSCorePropagationData: 20200512193424.0Z\r\ndSCorePropagationData: 16010101000001.0Z\r\n```\r\n\r\nAs you can see above, distinguishedName is correctly the full DN of the group, but when I try with a group that has special characters like yours, I get:\r\n\r\n```\r\n# Portal\\5C#23\\5C#Pr\\C3\\A1va supervisora, Users, joesads.com\r\ndn:: Q049UG9ydGFsXFxcIzIzXFxcI1Byw6F2YSBzdXBlcnZpc29yYSxDTj1Vc2VycyxEQz1qb2VzY\r\n WRzLERDPWNvbQ==\r\nobjectClass: top\r\nobjectClass: group\r\ncn:: UG9ydGFsXCMyM1wjUHLDoXZhIHN1cGVydmlzb3Jh\r\ndistinguishedName:: Q049UG9ydGFsXFxcIzIzXFxcI1Byw6F2YSBzdXBlcnZpc29yYSxDTj1Vc2\r\n VycyxEQz1qb2VzYWRzLERDPWNvbQ==\r\ninstanceType: 4\r\nwhenCreated: 20200818192523.0Z\r\nwhenChanged: 20200818192523.0Z\r\nuSNCreated: 65600\r\nuSNChanged: 65600\r\nname:: UG9ydGFsXCMyM1wjUHLDoXZhIHN1cGVydmlzb3Jh\r\nobjectGUID:: C2bdnRxYe0eWewwz0Wbs6g==\r\nobjectSid:: AQUAAAAAAAUVAAAABKFYKz4jVTZmyCfZVQQAAA==\r\nsAMAccountName: prava\r\nsAMAccountType: 268435456\r\ngroupType: -2147483646\r\nobjectCategory: CN=Group,CN=Schema,CN=Configuration,DC=joesads,DC=com\r\ndSCorePropagationData: 16010101000000.0Z\r\nmail: prava\r\n```\r\n\r\nAs you can see above, disntinguishedName property is encoded in this case which is likely why the search isn\u0027t really returning results. All of this points to a problem with the underneath library so far, but one thing apart from this is that we shouldn\u0027t be throwing an exception for filters like that, so I will do some more investigation on why are we throwing in this case.",
                                           "updatedAt":  "2020-08-24T23:57:20Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3OTg4NDAwOA==",
                                           "createdAt":  "2020-08-25T08:29:07Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GrowSharp",
                                           "body":  "Just to add a note. When I explicitly remove the `\\` chars from the search filter query, it works. It\u0027s probably not a solution for this issue in general, but it\u0027s sufficient enough for me atm. What\u0027s no-go for me is the #38610 and the most importantly #38611. ",
                                           "updatedAt":  "2020-08-25T08:29:07Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY4MTAyNTM1Mg==",
                                           "createdAt":  "2020-08-26T17:41:06Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I see, well given you have a workaround for now and this is not blocking you I will push the fix/investigation for this to 6.0. Even if this is an underlying issue with the native library, I think we should either provide a workaround or do more research to see if there are other ways to add filters with special characters.",
                                           "updatedAt":  "2020-08-26T17:41:06Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY4MTU0NDgzMA==",
                                           "createdAt":  "2020-08-27T05:34:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GrowSharp",
                                           "body":  "I completely agree. ",
                                           "updatedAt":  "2020-08-27T05:34:30Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc2OTgwNzM2Ng==",
                                           "createdAt":  "2021-01-29T13:32:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "smbecker",
                                           "body":  "I am having a similar issue with running on Linux. I can successfully search using `ldapsearch` but when running in a .NET app, I am getting the following (ErrorCode=-12).\r\n\r\n```\r\nSystem.DirectoryServices.Protocols.LdapException: The LDAP server returned an unknown error.\r\n   at System.DirectoryServices.Protocols.LdapConnection.SendRequest(DirectoryRequest request, TimeSpan requestTimeout)\r\n   at System.DirectoryServices.Protocols.LdapConnection.SendRequest(DirectoryRequest request)\r\n```",
                                           "updatedAt":  "2021-01-29T13:32:59Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc2OTgxOTE5Nw==",
                                           "createdAt":  "2021-01-29T13:55:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@smbecker the error above is -7 LDAP_FILTER_ERROR\t\nwhereas you have -12 LDAP_NOT_SUPPORTED. (You see the same message due to issue #46021). Could you please open a new issue for your problem as it likely has some other cause?",
                                           "updatedAt":  "2021-01-29T13:55:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc41fDDI",
                                           "createdAt":  "2021-08-12T04:04:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOB7lDsw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "GrowSharp",
                                                                               "createdAt":  "2021-08-12T06:13:17Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "Stuv7CB",
                                                                               "createdAt":  "2021-09-08T15:58:26Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "R4ND3LL",
                                                                               "createdAt":  "2021-09-23T20:52:46Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "Another case with escaping is when filter argument (e.g. group CN) contains parentheses, e.g. `Some (very) important group`.\r\nSince parentheses are a part of filter syntax itself, it might be problematic to correctly parse the filter.\r\n```\r\n(\u0026(objectClass=group)(sAMAccountName=Some (very) important group))\r\n```\r\n\r\nThe correct representation, [as per RFC](https://tools.ietf.org/search/rfc4515#section-3), is:\r\n```\r\n(\u0026(objectClass=group)(sAMAccountName=Some \\28very\\29 important group))\r\n```\r\nWhat\u0027s interesting is that the first one works on Windows, but fails on Linux.\r\nThe second one works on both Windows and Linux, as per my tests.\r\n\r\n\u003e If that is the case I propose to add the escaping functionality to System.DirectoryServices.Protocols.LdapConnection, so both libraries act the same on the windows as well as on linux.\r\n\r\nI think this might benefit from some general escape method which we can call manually when constructing filters, like:\r\n```\r\nvar filter = $\"(\u0026(objectClass=group)(sAMAccountName={LdapFilter.Escape(\"Some (very) important group\")}))\";\r\n```\r\nSomething along the lines of what I did here: https://github.com/dotnet/aspnetcore/pull/35279/commits/7f72499bb428bc1828d13e14367dc3c69c05b4d7\r\nIs it a good idea to provide such a method as part of core `System.DirectoryServices.Protocols` functionality?",
                                           "updatedAt":  "2021-08-12T04:06:27Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc41g1wB",
                                           "createdAt":  "2021-08-12T16:51:48Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOB2KIPg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "RoadTrain",
                                                                               "createdAt":  "2021-08-12T18:58:30Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Thanks for the report @RoadTrain, and for the diagnosis of the right representation along with the examples.\r\n\r\n\u003eIs it a good idea to provide such a method as part of core System.DirectoryServices.Protocols functionality?\r\n\r\nI think this would be a great addition to System.DirectoryServices.Protocols. The search query language is part of the LDAP spec, so having an additional class which encodes the filter/query so that the query would be sent correctly would be very useful. That said, I would probably just focus on the encoding part of the equation, without necessarily validating that the query itself is valid as that would be a whole new can of worms, but at least ensuring the query is enconded correctly as per spec it would be great. Feel free to either use this issue or log a new one with the API proposal so that we can take a look at it.",
                                           "updatedAt":  "2021-08-12T16:51:48Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc43mZgE",
                                           "createdAt":  "2021-10-02T19:59:12Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCBDPqw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2021-11-03T17:54:04Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "@joperezr I\u0027ve submitted an API proposal: https://github.com/dotnet/runtime/issues/59900",
                                           "updatedAt":  "2021-10-02T19:59:12Z"
                                       }
                                   ],
                         "totalCount":  16
                     },
        "title":  "System.DirectoryServices.Protocols - Linux -\u003e search query with escape sequence character (\\)",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices",
                       "os-linux"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/40102",
        "createdAt":  "2020-07-29T20:40:49Z",
        "number":  40102,
        "author":  "NetMage",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-04-13T20:21:52Z",
        "body":  "### Description\r\n\r\nDocumentation for using QBE with `AccountManagement` recommends creating a `UserPrincipal` subclass when needing to query on non-standard directory attributes.\r\n\r\nThe code in `PushFilterToNativeSearcher` that converts the Example class into an LDAP query uses `GetObjectClassPortion` to determine the base query for the Example.\r\n\r\nWhen the Example class is not a standard built-in `Principal` subclass, the code calls `ReadStructuralObjectClass` which looks for a `DirectoryObjectClassAttribute` on the subclass to use as a filter.\r\n\r\nUnfortunately since the AD schema specifies that Computer inherits from User, the `objectClass` is `user` for both types of objects, and the `objectCategory` should be used for filtering. `GetObjectClassPortion` recognizes this for the standard `UserPrincipal` class and specifies an LDAP filter of `(\u0026(objectCategory=user)(objectClass=user))` (would possibly be better as `objectCategory=Person`), but this does not apply to subclasses.\r\n\r\nI suggest the `GetObjectClassPortion` should test for subclasses of the standard classes instead of a direct type comparison on the standard classes so that e.g. using a subclass of `UserPrincipal` will work as expected.\r\n\r\nAlternatively, a class attribute to specify `objectCategory` on the subclass that will be used by `ReadStructuralObjectClass` (perhaps becomes `ReadStructuralObjectFilter`?) will allow custom attribute filtering with the expected base query.\r\n\r\nThis can be worked around (and there are many web articles) by setting the `objectCategory` inside your sub-class, or doing other similar things, but there is no apparent consensus on the best way to handle this, and it probably should just do the right thing.\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOLowCPA==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3MDc5MjM2Mg==",
                                           "createdAt":  "2020-08-08T00:13:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "I\u0027m not familiar with this code, but I assume the change you\u0027re asking for is here:\r\nhttps://github.com/dotnet/runtime/blob/6072e4d3a7a2a1493f514cdf4be75a3d56580e84/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx_Query.cs#L192\r\n\r\nWhat subclasses of UserPrincipal are there? I assume they are in your code? Could you give a free-standing code sample?",
                                           "updatedAt":  "2020-08-08T00:13:18Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc4MDkyNzU0OA==",
                                           "createdAt":  "2021-02-17T23:43:32Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "NetMage",
                                           "body":  "Yes, that is the code to change. This article is old, but the section on Extensibility Model at the end covers extending UserPrincipal and still holds: [Managing Directory Security Principals in the .NET Framework 3.5](https://docs.microsoft.com/en-us/archive/msdn-magazine/2008/january/managing-directory-security-principals-in-the-net-framework-3-5)\r\n\r\nThis [Stack Overflow question](https://stackoverflow.com/q/52090273/2557128) is an example that illustrates the same issue I ran into.",
                                           "updatedAt":  "2021-02-17T23:43:32Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "PrincipalSearcher returns computer objects from AD for UserPrincipal subclasses",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/40127",
        "createdAt":  "2020-07-30T06:28:35Z",
        "number":  40127,
        "author":  null,
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-07-22T16:31:07Z",
        "body":  "I added the following code: \r\nldapConnection.SessionOptions.VerifyServerCertificate += delegate { return true; };\r\n\r\nWhen I run my website locally (IIS Express) on Net Core 3.1 it works, but when I run it on a IIS Server then that line of code gets bypassed and I get The LDAP server is unavailable (If I switch to a LDAP server that has a valid SSL certificate it works, if I switch back to a LDAP server that has an invalid SSL certificate it stops working). \r\n\r\nI also noticed if I install my website on Net Core 2.2 then it works, it only does not work with Net Core 3.1",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOJ_t3Uw==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY2NjE1MzEyNg==",
                                           "createdAt":  "2020-07-30T06:28:40Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "Dotnet-GitSync-Bot",
                                           "body":  "I couldn\u0027t figure out the best area label to add to this issue. If you have write-permissions please help me learn by adding exactly one [area label](https://github.com/dotnet/runtime/blob/master/docs/area-owners.md).",
                                           "updatedAt":  "2020-07-30T06:28:40Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDY3MDc5MTUwNw==",
                                           "createdAt":  "2020-08-08T00:08:47Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@mafalarz thanks for the report. Does it repro on 5.0 preview 7 as well? \r\n\r\nDo you have a little time to investigate, if you\u0027re interested?",
                                           "updatedAt":  "2020-08-08T00:08:47Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "Net Core 3.1 ignores VerifyServerCertificateCallback",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/84831",
        "createdAt":  "2020-09-27T01:01:38Z",
        "number":  84831,
        "author":  "voh83",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-05-20T19:28:44Z",
        "body":  "Hi All.\r\n\r\nI\u0027m trying to connect to Active Directory within my company scope, and i setted up a simple test \r\n\r\nwith dotnet CLI i run:\r\n`dotnet add package System.DirectoryServices.AccountManagement --version 4.7.0`\r\n\r\nwith dotnet fsi i run:\r\n```\r\n#r \"C:\\\\Users\\\\ABSD\\\\.nuget\\\\packages\\\\system.directoryservices.accountmanagement\\\\4.7.0\\\\lib\\\\netstandard2.0\\\\System.DirectoryServices.AccountManagement.dll\"\r\nopen System.DirectoryServices.AccountManagement\r\nlet dEntry = new PrincipalContext(ContextType.Domain,\"LDAP://server-path:389\")\r\n```\r\n\r\nBut i receive this error: \r\n\r\n```\r\nSystem.PlatformNotSupportedException: System.DirectoryServices.AccountManagement is not supported on this platform.\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext..ctor(ContextType contextType, String name)\r\n   at \u003cStartupCode$FSI_0012\u003e.$FSI_0012.main@()\r\nDetenido debido a un error.\r\n```\r\n\r\ndotnet --info\r\n```\r\nSDK de .NET Core (reflejando cualquier global.json):\r\n Version:   3.1.402\r\n Commit:    9b5de826fd\r\n\r\nEntorno de tiempo de ejecución:\r\n OS Name:     Windows\r\n OS Version:  10.0.17763\r\n OS Platform: Windows\r\n RID:         win10-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\3.1.402\\\r\n\r\nHost (useful for support):\r\n  Version: 3.1.8\r\n  Commit:  9c1330dedd\r\n\r\n.NET Core SDKs installed:\r\n  3.1.402 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET Core runtimes installed:\r\n  Microsoft.AspNetCore.App 3.1.8 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 3.1.8 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.WindowsDesktop.App 3.1.8 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n\r\nTo install additional .NET Core runtimes or SDKs:\r\n  https://aka.ms/dotnet-download\r\n```\r\n\r\nI searched over internet but all the same problem was by using Linux/MAC no information with Windows.\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOrJeoBg==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDE1MDg0MDg2OTg=",
                                           "createdAt":  "2020-10-30T05:10:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "AMoghrabi",
                                           "body":  "Hey @dnomar , were you able to get passed this problem by any chance? I\u0027m running into it as well. Works fine when running on Windows outside of docker. When containerized, I receive the same error as you.\r\n\r\nThanks.",
                                           "updatedAt":  "2020-10-30T05:10:14Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDE1MDg0MDg3MDQ=",
                                           "createdAt":  "2020-11-07T12:01:32Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC53gEA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_DOWN",
                                                                               "user":  "DMW007",
                                                                               "createdAt":  "2021-06-21T15:53:26Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_DOWN",
                                                                               "user":  "buckstephenh",
                                                                               "createdAt":  "2021-06-22T18:45:30Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  2
                                                         },
                                           "author":  "voh83",
                                           "body":  "No, i use an alternative server with iis/.net framework instead and it works. This library does no work if your docker runs over linux or mac is only for windows.",
                                           "updatedAt":  "2020-11-07T12:01:32Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDE1MDg0MDg3MDg=",
                                           "createdAt":  "2020-11-11T22:12:47Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joeloff",
                                           "body":  "@terrajobst is this related to https://github.com/dotnet/runtime/issues/14734?",
                                           "updatedAt":  "2020-11-11T22:12:47Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDE1MDg0MDg3MTE=",
                                           "createdAt":  "2021-06-25T19:10:02Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC6SxLg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "buyaa-n",
                                                                               "createdAt":  "2023-04-20T18:29:26Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "iinuwa",
                                           "body":  "System.DirectoryServices.AccountManagement is only supported on Windows. As you noticed, you will get this error when trying to run on Linux, which includes running Linux containers using Docker for Windows.\r\n\r\nTo track S.DS.AM support for Linux, see dotnet/runtime#37100.\r\n\r\n@joeloff, this can probably be closed as a duplicate of that issue.",
                                           "updatedAt":  "2021-06-25T19:10:02Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Z6H2M",
                                           "createdAt":  "2023-04-14T11:25:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC7hFyg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "Sundow",
                                                                               "createdAt":  "2023-05-11T09:11:01Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "Turhan8",
                                           "body":  "I am getting same error while debugging: \r\n\"`System.DirectoryServices.AccountManagement is not supported on this platform.`\"\r\nI am running on Windows. I am targetting \r\n`\u003cTargetFramework\u003enet6.0-windows\u003c/TargetFramework\u003e`\r\nand I use \r\n`\u003cPackageReference Include=\"System.DirectoryServices.AccountManagement\" Version=\"7.0.0\" /\u003e`\r\npackage. \r\nI could not find anything that has S.DS.AM in my bin folder.\r\nCan you please advice how to fix this error?",
                                           "updatedAt":  "2023-04-15T03:03:36Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Z6H3S",
                                           "createdAt":  "2023-04-14T12:09:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\nHi All.\r\n\r\nI\u0027m trying to connect to Active Directory within my company scope, and i setted up a simple test \r\n\r\nwith dotnet CLI i run:\r\n`dotnet add package System.DirectoryServices.AccountManagement --version 4.7.0`\r\n\r\nwith dotnet fsi i run:\r\n```\r\n#r \"C:\\\\Users\\\\ABSD\\\\.nuget\\\\packages\\\\system.directoryservices.accountmanagement\\\\4.7.0\\\\lib\\\\netstandard2.0\\\\System.DirectoryServices.AccountManagement.dll\"\r\nopen System.DirectoryServices.AccountManagement\r\nlet dEntry = new PrincipalContext(ContextType.Domain,\"LDAP://server-path:389\")\r\n```\r\n\r\nBut i receive this error: \r\n\r\n```\r\nSystem.PlatformNotSupportedException: System.DirectoryServices.AccountManagement is not supported on this platform.\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext..ctor(ContextType contextType, String name)\r\n   at \u003cStartupCode$FSI_0012\u003e.$FSI_0012.main@()\r\nDetenido debido a un error.\r\n```\r\n\r\ndotnet --info\r\n```\r\nSDK de .NET Core (reflejando cualquier global.json):\r\n Version:   3.1.402\r\n Commit:    9b5de826fd\r\n\r\nEntorno de tiempo de ejecución:\r\n OS Name:     Windows\r\n OS Version:  10.0.17763\r\n OS Platform: Windows\r\n RID:         win10-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\3.1.402\\\r\n\r\nHost (useful for support):\r\n  Version: 3.1.8\r\n  Commit:  9c1330dedd\r\n\r\n.NET Core SDKs installed:\r\n  3.1.402 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET Core runtimes installed:\r\n  Microsoft.AspNetCore.App 3.1.8 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 3.1.8 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.WindowsDesktop.App 3.1.8 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n\r\nTo install additional .NET Core runtimes or SDKs:\r\n  https://aka.ms/dotnet-download\r\n```\r\n\r\nI searched over internet but all the same problem was by using Linux/MAC no information with Windows.\r\n\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003evoh83\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003ejoeloff\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-04-14T12:09:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5aaIWb",
                                           "createdAt":  "2023-04-20T18:56:33Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e I am getting same error while debugging:\r\n\u003e \"System.DirectoryServices.AccountManagement is not supported on this platform.\"\r\n\u003e I am running on Windows. I am targetting\r\n\u003e \u003cTargetFramework\u003enet6.0-windows\u003c/TargetFramework\u003e\r\n\r\n@Turhan8 I don\u0027t think your TFM targeting windows matters, the message suggests somehow your app running on non-windows. Anyway tagging @joperezr @BRDPM @grubioe @jay98014 if they have any suggestion for you.\r\n\r\n\u003e I could not find anything that has S.DS.AM in my bin folder.\r\n\r\nWhat happens when you run: `dotnet add package System.DirectoryServices.AccountManagement --version 7.0.0`",
                                           "updatedAt":  "2023-04-20T18:56:33Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc502zqK",
                                           "createdAt":  "2024-02-22T23:47:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "chrpai",
                                           "body":  "Does anyone know of any libraries that do support LDAP queries from mac?  I had the impression s.ds.protocols did but that gives me a non supported exception also when I try to do a LdapConnection.Bind()\r\n\r\nClarification.  I can bind using a NetworkCredential and AuthType.Basic.  I\u0027m new to Mac so I don\u0027t know the limitations. I know we have some kind of corporate binding on our Mac devices and I can connet to AD SMB shares and visit IIS websites that are using Windows Auth. without being prompted for creds so I\u0027m trying to do similiar.  I don\u0027t want to have to ask my users to enter their creds unless absolutely needed.",
                                           "updatedAt":  "2024-02-22T23:56:24Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6sl6gG",
                                           "createdAt":  "2025-05-20T19:28:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "naikrovek",
                                           "body":  "\u003e Does anyone know of any libraries that do support LDAP queries from mac? I had the impression s.ds.protocols did but that gives me a non supported exception also when I try to do a LdapConnection.Bind()\n\u003e \n\u003e Clarification. I can bind using a NetworkCredential and AuthType.Basic. I\u0027m new to Mac so I don\u0027t know the limitations. I know we have some kind of corporate binding on our Mac devices and I can connet to AD SMB shares and visit IIS websites that are using Windows Auth. without being prompted for creds so I\u0027m trying to do similiar. I don\u0027t want to have to ask my users to enter their creds unless absolutely needed.\n\nS.DS.P is *supposed* to work fine on MacOS, but I had problems with it.  I was using it as a PowerShell library.  It was supposed to work and the author of the library bought a Mac Mini to support it, but was unable to replicate the problems I was having.\n\nMacs can authenticate with Windows domains transparently after the user is logged in, but that is only supported at an OS level.  That\u0027s not a great way to phrase that, but only Apple stuff can get the current Kerberos token and use it for authentication, I\u0027m pretty sure.  That token is not made available or made accessible by MacOS for use by other programs, so you can\u0027t have your application simply inherit the AD-authenticated user, to my knowledge.  What I\u0027ve done in this case is give the user instructions to run the `security` tool to add credentials to the Keychain, then use those from the applications I write.  Because I didn\u0027t know of a working library in C# for this stuff, I\u0027ve written a LOT of LDAP manipulation stuff in Go, and that\u0027s been going great.  Lately I discovered that there\u0027s a library that\u0027s a port from some Novell Java library that is apparently working, but I\u0027ve not tried it.  I\u0027m in Go-land for LDAP, now.  Or Powershell if I\u0027m on Windows.",
                                           "updatedAt":  "2025-05-20T19:28:44Z"
                                       }
                                   ],
                         "totalCount":  9
                     },
        "title":  "System.PlatformNotSupportedException: System.DirectoryServices.AccountManagement is not supported on this platform Windows 10",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/43929",
        "createdAt":  "2020-10-28T01:27:47Z",
        "number":  43929,
        "author":  "null-d3v",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOCzqAug==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "dmpe",
                                            "createdAt":  "2021-09-11T10:06:53Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "Bykiev",
                                            "createdAt":  "2023-10-30T17:45:56Z"
                                        }
                                    ],
                          "totalCount":  2
                      },
        "updatedAt":  "2023-02-17T18:11:47Z",
        "body":  "### Description\r\nI have observed performance generally being worse on linux, to the point that large requests that succeed on Windows will time out on linux.\r\n\r\nWhen searching for groups using a basic `SearchRequest` with the following configuration:\r\n```\r\nvar searchRequest = new SearchRequest(\r\n    container,\r\n    \"objectCategory=group\",\r\n    SearchScope.Subtree,\r\n    new[] { \"cn\", });\r\n```\r\n\r\nI will get these results:\r\n\r\n`ou=Company,dc=company,dc=com` (715 groups)\r\nWindows: ~550ms\r\nLinux: timeout\r\n\r\n`OU=Folder Access,OU=Company Security Groups,ou=Company,dc=company,dc=com` (230 groups)\r\nWindows: ~230ms\r\nLinux: ~23s\r\n\r\n`OU=Product,ou=Company,dc=company,dc=com` (20 groups)\r\nWindows: ~90ms\r\nLinux: ~2s\r\n\r\nThis isn\u0027t as problematic until reaching higher response sizes where the requests scale to unreasonable response times or just timeout.\r\n\r\nI found this when investigating Windows-linux disparity in #43621.\r\n\r\n### Configuration\r\n* .NET 5.0.0-rc.2.20475.5\r\n* aspnet:5.0-alpine docker image\r\n* x86_64\r\n* libldap 2.4\r\n* Windows Server 2019 DC\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOU8pY3Q==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc3NzY5MDI5Mw==",
                                           "createdAt":  "2021-02-11T18:15:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "@null-d3v thanks for logging the issue. Where you able to consistently repro this issue when using that amount of groups? Also, do you mind sharing a code snippet so that we can investigate using the same filter and an AD with similar conditions?",
                                           "updatedAt":  "2021-02-11T18:15:57Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc4MDMxMjI5NQ==",
                                           "createdAt":  "2021-02-17T05:35:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "null-d3v",
                                           "body":  "Definitely consistent response times based on the size of the search results. Here is a highly reduced summarization:\r\n\r\n```\r\nvar connection = new LdapConnection(\r\n    new LdapDirectoryIdentifier(\"company.com:389\"),\r\n    new NetworkCredential(\r\n        \"user@company.com\",\r\n        \"password\"),\r\n    AuthType.Negotiate);\r\nconnection.SessionOptions.ProtocolVersion = 3;\r\n\r\nvar searchRequest = new SearchRequest(\r\n    \"OU=Product,ou=Company,dc=company,dc=com\",\r\n    \"objectCategory=group\",\r\n    SearchScope.Subtree,\r\n    new[] { \"cn\", });\r\n\r\nvar options = new SearchOptionsControl(SearchOption.DomainScope);\r\nsearchRequest.Controls.Add(options);\r\n\r\nvar searchResults = await Task.Factory.FromAsync\u003c\r\n    DirectoryRequest, PartialResultProcessing, DirectoryResponse\u003e(\r\n        connection.BeginSendRequest,\r\n        connection.EndSendRequest,\r\n        searchRequest,\r\n        PartialResultProcessing.NoPartialResultSupport,\r\n        null);\r\n```",
                                           "updatedAt":  "2021-02-17T05:35:27Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc41QyMA",
                                           "createdAt":  "2021-08-05T16:23:31Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Given this is not a regression and don\u0027t have an exact repro, I\u0027ll move this issue for us to investigate in 7.0.",
                                           "updatedAt":  "2021-08-05T16:23:31Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Tyljd",
                                           "createdAt":  "2023-01-26T22:43:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "jcracknell",
                                           "body":  "I ran into this problem trying to run a directory scan on Linux using libldap-2.6, and it appears to be a problem specifically with `BeginSendAsync`, which takes a minimum of 100ms per received result to complete (you\u0027ll notice this in the original report).\r\n\r\nI believe this occurs because this section runs the polling interval up to 100 immediately waiting for an initial response. Calling `ldap_result` via `GetResultFromAsyncOperation` with 0-valued timeout then causes it to process a single message and then time out, returning 0:\r\n\r\nhttps://github.com/dotnet/runtime/blob/144dbcbaa1a43dd4b3f7dc270afe25099d43104a/src/libraries/System.DirectoryServices.Protocols/src/System/DirectoryServices/Protocols/ldap/LdapConnection.cs#L1410-L1417\r\n\r\nThere\u0027s a lot of other weirdness here, like how `messageId` is always 0, and how abandoning the Task produced by `ResponseCallback` somehow actually works, unlike calls with any other value of `PartialResultProcessing` which seem to never complete.\r\n\r\nI\u0027ll also note that the values for `ResultAll` are not strictly aligned with those expected by `ldap_result` - `LDAP_MSG_ALL` just happens to match.\r\n\r\n",
                                           "updatedAt":  "2023-01-26T23:27:15Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "System.DirectoryServices.Protocols - Linux performance problems with large response sizes",
        "labels":  [
                       "area-System.DirectoryServices",
                       "os-linux",
                       "tenet-performance",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/46125",
        "createdAt":  "2020-12-16T09:46:43Z",
        "number":  46125,
        "author":  "mrybson",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOCREr3Q==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "cfbao",
                                            "createdAt":  "2021-06-13T05:44:43Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "khalilTN",
                                            "createdAt":  "2022-03-02T15:36:03Z"
                                        }
                                    ],
                          "totalCount":  2
                      },
        "updatedAt":  "2021-08-09T20:09:54Z",
        "body":  "\u003c!--This is just a template - feel free to delete any and all of it and replace as appropriate.--\u003e\r\n\r\n### Description\r\nI am working with System.DirectoryServices.Protocols to read data from AD. After the connection is bound, there seems to be a problem with sending the SearchRequest with SendRequest method.\r\n\r\n```\r\nSearchRequest searchRequest = new SearchRequest(searchBase, searchFilter, searchScope, searchReturnAttrs)\r\n{\r\n      TimeLimit = TimeSpan.FromSeconds(300)\r\n};\r\n\r\n var  result = _connection.SendRequest(searchRequest); //on execution of this line fails, application exits with no exception caught \r\n```\r\n\r\nchanged to \r\n```\r\nSearchRequest searchRequest = new SearchRequest(searchBase, searchFilter, searchScope, searchReturnAttrs);\r\n\r\nvar  result = _connection.SendRequest(searchRequest); //execution of this line works\r\n```\r\n\r\nthen it works.\r\nI was able to use the TimeLimit property when running on Windows. \r\n\r\n### Configuration\r\n\r\n\r\nNET Core 3.1\r\nLinux\r\nThis issue does not occur on Windows\r\n \r\n\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHONQCJnw==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc3NjI4NDcyMA==",
                                           "createdAt":  "2021-02-09T22:23:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Good catch, we should investigate why TimeLimit is not working in this case. I know that you can set a time limit in a connection and have validated that that works, but seems that when you do it on individual requests it is broken.",
                                           "updatedAt":  "2021-02-09T22:23:29Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc41AImf",
                                           "createdAt":  "2021-07-29T15:10:07Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tim-pringle",
                                           "body":  "Experience this also. Exactly the same scenario as @mrybson.  For me, process ends with exit code 139 every time.\r\n\r\n**Configuration**\r\nNET 5.0\r\nOSX\r\n",
                                           "updatedAt":  "2021-07-29T15:10:07Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "System.DirectoryServices.Protocols - SendRequest fails in Linux when TimeLimit is set on the request",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/46945",
        "createdAt":  "2021-01-13T03:50:47Z",
        "number":  46945,
        "author":  "hameedshk",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC9nisw==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "jpuskar",
                                            "createdAt":  "2021-01-13T17:41:57Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "anvouk",
                                            "createdAt":  "2024-03-21T23:28:25Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "nefarius",
                                            "createdAt":  "2024-12-19T20:50:35Z"
                                        }
                                    ],
                          "totalCount":  3
                      },
        "updatedAt":  "2022-06-13T08:57:27Z",
        "body":  "How to achieve kerberos authentication in dotnet core independent of underlying Linux or windows operating system?\r\n\r\n### Description\r\n\r\n\r\n* We usually connect to MS SQL  server either in   Trusted_Connection=True(default windows authentication usually Active directory authentication) or username and password (credential maintained within scope of MS SQL sever) \r\n* Now our dotnet application runs in openshift Linux containers via docker instruction set and connecting to SQL server , I can\u0027t use trusted connection as it\u0027s Linux distro But via username and password is a bad practice in terms of security practice.\r\n*  I have tried looking into kerberos libraries and nothing has helped here.\r\n\r\nWhat I am looking or trying to achieve is when the application runs in Linux dotnet core ,I need to first authenticate the credentials in Active directory  and then connect to SQL sever and fetch the data. \r\n\r\n### Configuration\r\n\r\n* Which version of dotnet? 3.1\r\n* What OS and version, and for Linux, what distro? Linux distro\r\n* If you\u0027re using Blazor, which web browser(s) do you see this issue in? All web browser\r\n ",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHORMNrvw==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc1OTgxNjEwNQ==",
                                           "createdAt":  "2021-01-13T23:09:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "I couldn\u0027t figure out the best area label to add to this issue. If you have write-permissions please help me learn by adding exactly one [area label](https://github.com/dotnet/runtime/blob/master/docs/area-owners.md).",
                                           "updatedAt":  "2021-01-13T23:09:42Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc1OTg1MjQ3Nw==",
                                           "createdAt":  "2021-01-14T00:52:06Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "@joperezr would S.DS.Protocols API\u0027s help here?",
                                           "updatedAt":  "2021-01-14T00:52:06Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc1OTg4MTg3NA==",
                                           "createdAt":  "2021-01-14T02:22:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Not really unfortunately. In DirectoryServices we don’t implement the kerberos protocol directly, but instead call a native library that handles the authentication for us, which internally uses and implements kerberos. We do have an internal implementation of Kerberos which we use in System.Net.Http which @davidsh wrote but this isn’t publicly available (I believe ASP.Net uses it too, but via reflection). There was a plan to expose that publicly but I believe @davidsh was still working on the design, I’ll try to find the issue and reference it from here.\r\n\r\nOther than that, I have seen third party implementations which are fairly complete, like one called Kerberos.Net.",
                                           "updatedAt":  "2021-01-14T02:22:57Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc1OTkxNzY5Nw==",
                                           "createdAt":  "2021-01-14T04:28:51Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "The issue I was thinking of is this one: https://github.com/dotnet/runtime/issues/29270\r\n\r\nThe internal class we have today that knows how to perform Kerberos authentication is called NTAuthentication.",
                                           "updatedAt":  "2021-01-14T04:28:51Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc2MjU4NzI3OA==",
                                           "createdAt":  "2021-01-19T04:01:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "wfurt",
                                           "body":  "There is [NegotiateStream](https://docs.microsoft.com/en-us/dotnet/api/system.net.security.negotiatestream?view=net-5.0) for anybody who needs Kerberos. I don\u0027t know if there is good way how to hook it in. I guess in worst case, you would need to create the authenticated Stream and then tunnel SQL through that. \r\n",
                                           "updatedAt":  "2021-01-19T04:01:15Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc3ODk1NTI1OQ==",
                                           "createdAt":  "2021-02-15T05:36:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "sudominmonk",
                                           "body":  "Is there any way this can be achieved? \n- Dotnet core using kestrel server\n- Hosted on a linux container \n- Sql server connection with integrated security\nIf possible using the impersonate user creds.",
                                           "updatedAt":  "2021-02-15T05:36:44Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc3ODk2NzkyNA==",
                                           "createdAt":  "2021-02-15T06:01:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "wfurt",
                                           "body":  "the problem is that even with impresonification, you need credentials in you app @sudominmonk. If I understand @hameedshk  correctly the concern is about credential management. AFAIK there are only two ways: authenticate with OS and use \"DefaultCredentails\" at .NET e.g. inherit your identity from OS or use explicit authentication, credentiasl  and identity inside .NET. \r\nPerhaps @hameedsh can clarify more.",
                                           "updatedAt":  "2021-02-15T06:01:44Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc3OTI4NzYyMA==",
                                           "createdAt":  "2021-02-15T15:18:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "hameedshk",
                                           "body":  "@wfurt in simple words what I am trying to achieve is like windows authentication in Unix based server .  Windows authentication authenticate the application via ldap protocol against directory services of course with proper credentials. I am trying to authenticate the credentials against AD and then connect to ms sql server .\r\nI hope I am more clear now and also if you can share some articles regarding w.r.t explicit authentication in .net core independent of operating system.",
                                           "updatedAt":  "2021-02-15T15:19:23Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDc3OTM4NjkxNw==",
                                           "createdAt":  "2021-02-15T18:23:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "wfurt",
                                           "body":  "Ok. So you  *DO* want your app to manage credentials.  In that case I\u0027m perhaps confused by the \" But via username and password is a bad practice\" note. ",
                                           "updatedAt":  "2021-02-15T18:23:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Ew2u_",
                                           "createdAt":  "2022-06-13T08:57:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCwbvXg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "hangy",
                                                                               "createdAt":  "2022-06-14T10:22:41Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "hameedshk",
                                                                               "createdAt":  "2022-08-07T08:57:34Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "loudar",
                                                                               "createdAt":  "2022-11-30T12:20:51Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "wfurt",
                                           "body":  "https://github.com/dotnet/runtime/issues/69920 was approved and should be done in 7.0. hat should allow some progress but I\u0027m not sure how the managed API would interact with native bits.",
                                           "updatedAt":  "2022-06-13T08:57:27Z"
                                       }
                                   ],
                         "totalCount":  10
                     },
        "title":  "kerberos authentication in c# or Linux container ",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/48328",
        "createdAt":  "2021-02-16T10:57:22Z",
        "number":  48328,
        "author":  "krwq",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-07-18T17:50:28Z",
        "body":  "Found while adding nullable annotations.\r\n\r\nThere are couple of places in directory services which seem like they should use `throw ExceptionHelper.GetExceptionFromCOMException(...);` but they do no-op instead. Some examples:\r\n\r\nhttps://github.com/dotnet/runtime/blob/master/src/libraries/System.DirectoryServices/src/System/DirectoryServices/ActiveDirectory/ReplicationConnection.cs#L977-L980\r\nhttps://github.com/dotnet/runtime/blob/master/src/libraries/System.DirectoryServices/src/System/DirectoryServices/ActiveDirectory/ActiveDirectorySubnet.cs#L135-L138\r\nhttps://github.com/dotnet/runtime/blob/master/src/libraries/System.DirectoryServices/src/System/DirectoryServices/ActiveDirectory/ApplicationPartition.cs#L940-L943\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  null,
                         "nodes":  [

                                   ],
                         "totalCount":  0
                     },
        "title":  "DirectoryServices have couple of places where they likely should throw exception but they don\u0027t",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/49128",
        "createdAt":  "2021-03-04T12:36:14Z",
        "number":  49128,
        "author":  "krwq",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-07-18T17:52:19Z",
        "body":  "While adding nullable annotations to System.DirectoryServices I\u0027ve found few inconsistencies which need a bit more investigation or some more background in the area.\r\n\r\n- Consider making `PropertyManager.GetPropertyValue` return non-nullable. Currently it\u0027s marked as returning nullable because there is currently nothing guarding against publicly available `DirectoryEntry.Properties[anyName].Add(null)` which means it technically can return `null`. I\u0027m not sure we can ever get `null` from the network.\r\n- DirectorySearcher.Filter is currently marked as nullable but there are couple of clues it actually should be marked as: `[AllowNull] public string Filter ...` - the reason it\u0027s marked as nullable is because:\r\n  - `public DirectorySearcher(DirectoryEntry? searchRoot, string? filter, string[]? propertiesToLoad, SearchScope scope)` is assigning filter directly and does not do any validation\r\n    - Most likely constructor should be assigning to the property rather than field - in my opinion it\u0027s not intentional but I\u0027m not 100% sure on that and we try to avoid making any product changes during nullable annotations\r\n  - in Utils.cs: `internal static Hashtable GetValuesWithRangeRetrieval(DirectoryEntry searchRootEntry, string? filter, ArrayList propertiesWithRangeRetrieval, ArrayList propertiesWithoutRangeRetrieval, SearchScope searchScope)` is being called with explicit null from DirectoryServer.cs `GetParitions()` (call goes through `internal static Hashtable GetValuesWithRangeRetrieval(DirectoryEntry searchRootEntry, string? filter, ArrayList propertiesToLoad, SearchScope searchScope)`)\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  null,
                         "nodes":  [

                                   ],
                         "totalCount":  0
                     },
        "title":  "System.DirectoryServices nullability follow-up",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/49726",
        "createdAt":  "2021-03-16T20:09:11Z",
        "number":  49726,
        "author":  "AnthonyMastrean",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-07-08T01:22:05Z",
        "body":  "\u003c!--This is just a template - feel free to delete any and all of it and replace as appropriate.--\u003e\r\n\r\n### Description\r\n\r\nIt\u0027s obvious that we should always dispose of an `LdapConnection` instance via a  `using` statement (or similar).\r\n\r\n```csharp\r\nusing (var connection = new LdapConnection(...))\r\n{\r\n    ...\r\n}\r\n```\r\n\r\nTo use LDAP with TLS, we\u0027re supposed to call the relevant \"start\" method on the session options instance. I assume, but it\u0027s not documented, that we should attempt to _stop_ TLS if we started it. I\u0027m thinking a `try`...`finally` block?\r\n\r\n```csharp\r\nusing (var connection = new LdapConnection(...))\r\n{\r\n    try\r\n    {\r\n        connection.SessionOptions.StartTransportLayerSecurity(null);\r\n        // use the connection instance... \r\n    }\r\n    finally\r\n    {\r\n        connection.SessionOptions.StopTransportLayerSecurity();\r\n    }\r\n}\r\n```\r\n\r\nHowever, if, for whatever reason, it\u0027s the start method call that fails leading to the stop method call in the finally block, the stop method will throw a `TlsOperationException`, which is documented. But, that means, I need to either wrap that call or track a local Boolean.\r\n\r\n```csharp\r\nusing (var connection = new LdapConnection(...))\r\n{\r\n    var startedTls = false;\r\n    try\r\n    {\r\n        connection.SessionOptions.StartTransportLayerSecurity(null);\r\n        startedTls = true;\r\n        // use the connection instance... \r\n    }\r\n    finally\r\n    {\r\n        try\r\n        {\r\n            if (startedTls)\r\n            {\r\n                connection.SessionOptions.StopTransportLayerSecurity();\r\n            }\r\n        }\r\n        catch (TlsOperationException)\r\n        {\r\n            // this catch block intentionally left blank\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThis is kind of a hot mess, right? Is there any way to get a `bool` returned by the start/stop methods? or for the session options to track this state like it does for \"secure socket layer\" (if that is, in fact, what is happening there)?\r\n\r\n### Configuration\r\n\r\n.NET 5.0 on Windows 10 and Debian Linux.\r\n\r\n### Regression?\r\n\r\n\u003c!--\r\n* Did this work in a previous build or release of .NET Core, or from .NET Framework? If you can try a previous release or build to find out, that can help us narrow down the problem. If you don\u0027t know, that\u0027s OK.\r\n  --\u003e\r\n\r\n### Other information\r\n\r\n\u003c!--\r\n* Please include any relevant stack traces or error messages. If possible please include text as text rather than images (so it shows up in searches).\r\n* If you have an idea where the problem might lie, let us know that here. Please include any pointers to code, relevant changes, or related issues you know of.\r\n* Do you know of any workarounds?\r\n  --\u003e\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHONDCamQ==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDgwMDU2ODQyMA==",
                                           "createdAt":  "2021-03-16T20:09:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "I couldn\u0027t figure out the best area label to add to this issue. If you have write-permissions please help me learn by adding exactly one [area label](https://github.com/dotnet/runtime/blob/master/docs/area-owners.md).",
                                           "updatedAt":  "2021-03-16T20:09:14Z"
                                       },
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDg3NTYwMDUzNw==",
                                           "createdAt":  "2021-07-07T13:23:56Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "AnthonyMastrean",
                                           "body":  "A related issue #54274 discusses adding some of the same state tracking I was thinking about.",
                                           "updatedAt":  "2021-07-07T13:23:56Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "Cannot correctly use LdapSessionOptions.StopTransportLayerSecurity without tracking state locally",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/51744",
        "createdAt":  "2021-04-23T16:38:39Z",
        "number":  51744,
        "author":  "Identifier",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC7DFsg==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "MichelZ",
                                            "createdAt":  "2022-04-21T07:27:38Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "campersau",
                                            "createdAt":  "2024-09-16T14:21:56Z"
                                        }
                                    ],
                          "totalCount":  2
                      },
        "updatedAt":  "2024-07-22T15:58:46Z",
        "body":  "In a .NET 5 Console app as follows:\r\n\r\n```\r\nusing System;\r\nusing System.DirectoryServices.AccountManagement;\r\n\r\nnamespace ConsoleApp1\r\n{\r\n    class Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            var currentUserPrincipal = UserPrincipal.Current; // Throws InvalidCastException\r\n\r\n            Console.WriteLine($\"Hello, {currentUserPrincipal.UserPrincipalName ?? \"null\"}!\");\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nUserPrincipal.Current calls UserPrincipal.FindByIdentity, which throws an InvalidCastException when trying to cast a GroupPrincipal to a UserPrincipal:\r\n\r\n```\r\n System.InvalidCastException: Unable to cast object of type \u0027System.DirectoryServices.AccountManagement.GroupPrincipal\u0027 to type \u0027System.DirectoryServices.AccountManagement.UserPrincipal\u0027.\r\n   at System.DirectoryServices.AccountManagement.UserPrincipal.FindByIdentity(PrincipalContext context, IdentityType identityType, String identityValue)\r\n   at System.DirectoryServices.AccountManagement.UserPrincipal.get_Current()\r\n   at ConsoleApp1.Program.Main(String[] args) in C:\\Source\\ConsoleApp1\\ConsoleApp1\\Program.cs:line 12\r\n```\r\n\r\nThe specific line is here:\r\n\r\nhttps://github.com/dotnet/runtime/blob/4ab71ae44b78a6139739798f8bba090d520bfc1f/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/User.cs#L271\r\n\r\nApparently FindByIdentityWithType is returning a GroupPrincipal even though we wanted a UserPrincipal.  This is running on a Windows 10 machine joined to Microsoft Azure AD (normal MSFT employee setup).",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOhbYVVw==",
                         "nodes":  [
                                       {
                                           "id":  "MDEyOklzc3VlQ29tbWVudDg0MDcxMTc0Ng==",
                                           "createdAt":  "2021-05-13T17:28:11Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "@Identifier thanks for logging the issue, this seems like an issue and we should have an if check instead of a hard cast there.",
                                           "updatedAt":  "2021-05-13T17:28:11Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6Ftf_J",
                                           "createdAt":  "2024-07-22T15:56:07Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "iSazonov",
                                           "body":  "Root of the case is not the cast. In the OP example we explicitly ask UserPrincipal but the method return something else.\r\nAfter some investigations I believe AccountManagement API doesn\u0027t support AzureAD/Entra accounts at all. What would `ContentType` be for AzureAD/Entra accounts?",
                                           "updatedAt":  "2024-07-22T15:56:07Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6FthVX",
                                           "createdAt":  "2024-07-22T15:58:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "iSazonov",
                                           "body":  "Duplicate #30408",
                                           "updatedAt":  "2024-07-22T15:58:45Z"
                                       }
                                   ],
                         "totalCount":  3
                     },
        "title":  "UserPrincipal.Current throws InvalidCastException in User.FindByIdentity",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/54411",
        "createdAt":  "2021-06-18T12:50:31Z",
        "number":  54411,
        "author":  "iinuwa",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOCLGD5g==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "ldematte",
                                            "createdAt":  "2021-08-06T13:56:53Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "joperezr",
                                            "createdAt":  "2022-01-22T17:56:44Z"
                                        }
                                    ],
                          "totalCount":  2
                      },
        "updatedAt":  "2024-07-29T02:11:24Z",
        "body":  "The System.DirectoryServices.Protocols API for setting referral callbacks aligns with how the Windows LDAP library works, but . This prevents consumers to use LDAP referrals on Linux. See below for more analysis:\r\n\r\n_Originally posted by @makrattaur in https://github.com/dotnet/runtime/issues/44826#issuecomment-777963933_\r\n\r\nHi, I am also running into this issue and I am able to reproduce with ldapsearch.\r\nI am using Microsoft Active Directory as the LDAP server (which has the behaviour described).\r\n\r\nI have changed the query so it returns one match and one property only so the ldapsearch output is shorter.\r\n\r\nOn any other DN other than the base DN, the result looks like this:\r\n```\r\n$ ldapsearch -o ldif-wrap=no -H ldap://contoso.com -b \u0027CN=Users,DC=contoso,DC=com\u0027 \u0027(sAMAccountName=Administrator)\u0027 \u0027name\u0027\r\nSASL/GSS-SPNEGO authentication started\r\nSASL username: johndoe@contoso.com\r\nSASL SSF: 256\r\nSASL data security layer installed.\r\n# extended LDIF\r\n#\r\n# LDAPv3\r\n# base \u003cCN=Users,DC=contoso,DC=com\u003e with scope subtree\r\n# filter: (sAMAccountName=Administrator)\r\n# requesting: name\r\n#\r\n\r\n# Administrator, Users, contoso.com\r\ndn: CN=Administrator,CN=Users,DC=contoso,DC=com\r\nname: Administrator\r\n\r\n# search result\r\nsearch: 3\r\nresult: 0 Success\r\n\r\n# numResponses: 2\r\n# numEntries: 1\r\n```\r\n\r\nBut on the root DN, the result looks like this:\r\n```\r\n$ ldapsearch -o ldif-wrap=no -H ldap://contoso.com -b \u0027DC=contoso,DC=com\u0027 \u0027(sAMAccountName=Administrator)\u0027 \u0027name\u0027\r\nSASL/GSS-SPNEGO authentication started\r\nSASL username: johndoe@contoso.com\r\nSASL SSF: 256\r\nSASL data security layer installed.\r\n# extended LDIF\r\n#\r\n# LDAPv3\r\n# base \u003cDC=contoso,DC=com\u003e with scope subtree\r\n# filter: (sAMAccountName=Administrator)\r\n# requesting: name\r\n#\r\n\r\n# Administrator, Users, contoso.com\r\ndn: CN=Administrator,CN=Users,DC=contoso,DC=com\r\nname: Administrator\r\n\r\n# search reference\r\nref: ldap://ForestDnsZones.contoso.com/DC=ForestDnsZones,DC=contoso,DC=com\r\n\r\n# search reference\r\nref: ldap://DomainDnsZones.contoso.com/DC=DomainDnsZones,DC=contoso,DC=com\r\n\r\n# search reference\r\nref: ldap://contoso.com/CN=Configuration,DC=contoso,DC=com\r\n\r\n# search result\r\nsearch: 3\r\nresult: 0 Success\r\n\r\n# numResponses: 5\r\n# numEntries: 1\r\n# numReferences: 3\r\n```\r\nThe difference between the two is that referrals are returned.\r\nThey can be also seen in the first comment in this issue after the line `Response.Error Message: Referral:` in the exception details, `ForestDnsZones` and `DomainDnsZones` are usually Active Directory specific.\r\n\r\nBy default, ldapsearch does not follow referrals, the option `-C` enables referral following:\r\n```\r\n$ ldapsearch -C -o ldif-wrap=no -H ldap://contoso.com -b \u0027DC=contoso,DC=com\u0027 \u0027(sAMAccountName=Administrator)\u0027 \u0027name\u0027\r\nSASL/GSS-SPNEGO authentication started\r\nSASL username: johndoe@contoso.com\r\nSASL SSF: 256\r\nSASL data security layer installed.\r\n# extended LDIF\r\n#\r\n# LDAPv3\r\n# base \u003cDC=contoso,DC=com\u003e with scope subtree\r\n# filter: (sAMAccountName=Administrator)\r\n# requesting: name\r\n#\r\n\r\n# Administrator, Users, contoso.com\r\ndn: CN=Administrator,CN=Users,DC=contoso,DC=com\r\nname: Administrator\r\n\r\n# search reference\r\nref: ldap://ForestDnsZones.contoso.com/DC=ForestDnsZones,DC=contoso,DC=com\r\n\r\n# search reference\r\nref: ldap://contoso.com/CN=Configuration,DC=contoso,DC=com\r\n\r\n# search reference\r\nref: ldap://DomainDnsZones.contoso.com/DC=DomainDnsZones,DC=contoso,DC=com\r\n\r\n# search reference\r\nref: ldap://contoso.com/CN=Schema,CN=Configuration,DC=contoso,DC=com\r\n\r\n# search result\r\nsearch: 3\r\nresult: 1 Operations error\r\ntext: 000004DC: LdapErr: DSID-0C090A7D, comment: In order to perform this operation a successful bind must be completed on the connection., data 0, v3839\r\n\r\n# numResponses: 6\r\n# numEntries: 1\r\n# numReferences: 4\r\n```\r\nSo I can get the operation error using ldapsearch.\r\n(The option is in fact obsolete, see [here](https://github.com/openldap/openldap/blob/98a0029daeb8aaa7bc58428ad3f94eface7f997b/clients/tools/common.c#L426), it\u0027s not documented)\r\n\r\nTrying to understand what is happening, I turned on debug logging for ldapsearch (`-d 1`), indicated a SASL mechanism so it\u0027s easier to see in the debug log (`-Y GSSAPI`), redirected the debug log to `stdout` and filtered the output with `grep -B 10 -A 5 ldap_pvt_connect`.\r\nI get the following output:\r\n```\r\n$ ldapsearch -C -d 1 -o ldif-wrap=no -Y GSSAPI -H ldap://contoso.com -b \u0027DC=contoso,DC=com\u0027 -s subtree \u0027(sAMAccountName=Administrator)\u0027 \u0027name\u0027 2\u003e\u00261 | grep -B 10 -A 5 ldap_pvt_connect\r\nldap_create\r\nldap_url_parse_ext(ldap://contoso.com:389/??base)\r\nldap_sasl_interactive_bind: user selected: GSSAPI\r\nldap_int_sasl_bind: GSSAPI\r\nldap_new_connection 1 1 0\r\nldap_int_open_connection\r\nldap_connect_to_host: TCP contoso.com:389\r\nldap_new_socket: 3\r\nldap_prepare_socket: 3\r\nldap_connect_to_host: Trying 10.10.10.42:389\r\nldap_pvt_connect: fd: 3 tm: -1 async: 0\r\nattempting to connect:\r\nconnect success\r\nldap_int_sasl_open: host=dc1.contoso.com\r\nSASL/GSSAPI authentication started\r\nldap_sasl_bind\r\n--\r\nber_scanf fmt ({it) ber:\r\nber_scanf fmt ({me) ber:\r\nldap_chase_v3referral: msgid 4, url \"ldap://ForestDnsZones.contoso.com/DC=ForestDnsZones,DC=contoso,DC=com\"\r\nldap_send_server_request\r\nldap_new_connection 0 1 1\r\nldap_int_open_connection\r\nldap_connect_to_host: TCP ForestDnsZones.contoso.com:389\r\nldap_new_socket: 5\r\nldap_prepare_socket: 5\r\nldap_connect_to_host: Trying 10.10.10.42:389\r\nldap_pvt_connect: fd: 5 tm: -1 async: 0\r\nattempting to connect:\r\nconnect success\r\nanonymous rebind via ldap_sasl_bind(\"\")\r\nldap_sasl_bind\r\nldap_send_initial_request\r\n--\r\nber_scanf fmt ({it) ber:\r\nber_scanf fmt ({me) ber:\r\nldap_chase_v3referral: msgid 4, url \"ldap://DomainDnsZones.contoso.com/DC=DomainDnsZones,DC=contoso,DC=com\"\r\nldap_send_server_request\r\nldap_new_connection 0 1 1\r\nldap_int_open_connection\r\nldap_connect_to_host: TCP DomainDnsZones.contoso.com:389\r\nldap_new_socket: 6\r\nldap_prepare_socket: 6\r\nldap_connect_to_host: Trying 10.10.10.42:389\r\nldap_pvt_connect: fd: 6 tm: -1 async: 0\r\nattempting to connect:\r\nconnect success\r\nanonymous rebind via ldap_sasl_bind(\"\")\r\nldap_sasl_bind\r\nldap_send_initial_request\r\n```\r\nOpenLDAP seems to follow referrals unauthenticated by default and Active Directory seems to accept the anonymous bind done in this case but gives an error on the first request done on the connection (the errors are further in the output but mixed together).\r\n\r\nCallbacks are set with `LdapConnection.SessionOptions.ReferralCallback` and this property contains three delegates which match the ones in the structure `LDAP_REFERRAL_CALLBACK` (see [here](https://docs.microsoft.com/en-us/windows/win32/api/winldap/ns-winldap-ldap_referral_callback)) and the structure is passed to `ldap_set_option` with `LDAP_OPT_REFERRAL_CALLBACK` to set them on a LDAP connection object.\r\nBut OpenLDAP does not support this structure and option, it only has one callback which is set with `ldap_set_rebind_proc` and is for rebinds only, there is no multiple callbacks, so setting the property causes a LDAP exception when checking the error code of `ldap_set_option`.\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOhmWjgw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc468v4F",
                                           "createdAt":  "2021-12-08T17:08:09Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "prcdpr",
                                           "body":  "Workaround:\r\n\r\nAdd the following line:\r\n```\r\nREFERRALS off\r\n```\r\n\r\nto one of OpenLDAP config files:\r\n```\r\nsystem file  /usr/local/etc/openldap/ldap.conf,\r\nuser files   $HOME/ldaprc,  $HOME/.ldaprc,  ./ldaprc,\r\n```\r\n\r\nReference: https://www.openldap.org/software//man.cgi?query=ldap.conf\u0026sektion=5\u0026apropos=0\u0026manpath=OpenLDAP+2.4-Release",
                                           "updatedAt":  "2021-12-08T17:08:09Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc48waYt",
                                           "createdAt":  "2022-01-22T18:00:09Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Thanks for logging this @iinuwa and thanks @prcdpr for providing a workaround. Ideally we would want the library itself to handle this as opposed to having to tamper with a setting of openldap, so it would be great to be able to fix this, specially since it is pretty common to perform searches at the root of the directory. On the bare minimum, I think we should at least throw a comprehensive error when you hit this issue so it is easier to understand from the consumer side when the issue is that you are searching at the root of the directory, since the debugging and getting to the root cause is very complex.",
                                           "updatedAt":  "2022-01-22T18:00:09Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6GXfzg",
                                           "createdAt":  "2024-07-28T01:38:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tpisciotta",
                                           "body":  "Here is another option or possibility to updating the ldap.conf file.\r\n\r\nAdd this to your code:\r\nSearchOptionsControl soc = new SearchOptionsControl(System.DirectoryServices.Protocols.SearchOption.DomainScope);\r\nrequest.Controls.Add(soc);\r\n\r\nI got it from here: [https://stackoverflow.com/questions/10336553/system-directoryservices-protocols-paged-get-all-users-code-suddenly-stopped-get](url)\r\n\r\n",
                                           "updatedAt":  "2024-07-28T01:38:27Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6GYUjg",
                                           "createdAt":  "2024-07-28T13:38:13Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "iinuwa",
                                           "body":  "Thanks for the reply. I think your workaround is addressing a different issue. If you don\u0027t need referrals, then you can disable it with LdapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None.\n\nHowever, if you _do_ need to follow referrals, it currently can\u0027t work on Linux if your directory requires authentication due to this API mismatch between S.DS.P and OpenLDAP.\n",
                                           "updatedAt":  "2024-07-28T13:38:13Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6GY91F",
                                           "createdAt":  "2024-07-28T23:41:00Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tpisciotta",
                                           "body":  "@iinuwa\r\nA note to your last comment:\r\n- you wrote ==\u003e If you don\u0027t need referrals, then you can disable it with LdapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None ==\u003e I had the same error you communicated in the 1st post to this issue.  I am running .Net on an alpine Linux container and from what I understand, communicated through this GitHub issue, this option, [ReferralChasing = ReferralChasingOptions.None], does not work on Linux.  From what I read here, [https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.protocols.searchoption?view=net-8.0](url), once can set their code to do [No Referrals] on Windows and Linux with the [SearchOptionsControl(System.DirectoryServices.Protocols.SearchOption.DomainScope)] code...\r\n- If you find that this does not do [No Referrals], then what issue is that workaround addressing?  It even says in that link: DomainScope == Prevents referrals from being generated when the search results are returned.\r\n\r\n@prcdpr Just a note: I found that updating system file,  /usr/local/etc/openldap/ldap.conf, with [REFERRALS off] did not work for me running .Net on an alpine Linux container == I had to put the [REFERRALS off] in the file /etc/ldap/ldap.conf to get it work...",
                                           "updatedAt":  "2024-07-28T23:42:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6GZaOD",
                                           "createdAt":  "2024-07-29T02:11:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "iinuwa",
                                           "body":  "\u003e I had the same error you communicated in the 1st post to this issue. I am running .Net on an alpine Linux container and from what I understand, communicated through this GitHub issue, this option, [ReferralChasing = ReferralChasingOptions.None], does not work on Linux. \r\n\r\nInteresting, we use this in production, but I may have modified some code locally to make it work. I\u0027ll try to remember to check tomorrow.\r\n\r\nI think in either case that is a separate problem from this one that deserves its own issue so it doesn\u0027t get lost in this one (which is about modifying referral callbacks, not requesting referrals not to be sent, nor disabling referral chasing).",
                                           "updatedAt":  "2024-07-29T02:11:23Z"
                                       }
                                   ],
                         "totalCount":  6
                     },
        "title":  "LDAP referral callback cannot be set in Linux",
        "labels":  [
                       "area-System.DirectoryServices",
                       "help wanted",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/55454",
        "createdAt":  "2021-07-10T12:14:40Z",
        "number":  55454,
        "author":  "iinuwa",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-07-18T17:49:37Z",
        "body":  "As a follow-up to #54380:\r\nWhen using System.DirectoryServices.Protocols on Linux, it is not possible to control the referral types followed (e.g. subordinate or external); it\u0027s all or nothing. I believe it is possible to configure the type of referrals followed by setting the [`LDAP_CONTROL_REFERRALS`](https://git.openldap.org/openldap/openldap/-/blob/OPENLDAP_REL_ENG_2_4_58/doc/drafts/draft-ietf-ldapext-ldap-c-api-xx.txt#L1307-1347) client control globally using the [`LDAP_OPT_CLIENT_CONTROLS`](https://git.openldap.org/openldap/openldap/-/blob/OPENLDAP_REL_ENG_2_4_58/doc/drafts/draft-ietf-ldapext-ldap-c-api-xx.txt#L1098-1105), which is a [NULL-terminated arrray](https://git.openldap.org/openldap/openldap/-/blob/OPENLDAP_REL_ENG_2_4_58/doc/drafts/draft-ietf-ldapext-ldap-c-api-xx.txt#L1295-1296) of `LDAPControl`s option on the LDAP handle.\r\n\r\n_Originally posted by @iinuwa in https://github.com/dotnet/runtime/issues/54380#issuecomment-869213328_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHORs5YSA==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5GzlhI",
                                           "createdAt":  "2022-07-18T17:49:31Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I don\u0027t think we\u0027ll have time to add this for 7.0 any longer, so moving it as future for now.",
                                           "updatedAt":  "2022-07-18T17:49:31Z"
                                       }
                                   ],
                         "totalCount":  1
                     },
        "title":  "Allow setting subordinate and external LDAP referral chasing options in Linux",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/57248",
        "createdAt":  "2021-08-12T00:26:49Z",
        "number":  57248,
        "author":  "RoadTrain",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHODBtXKw==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "hheexx",
                                            "createdAt":  "2022-12-17T15:58:39Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "valeri2",
                                            "createdAt":  "2025-04-25T08:11:06Z"
                                        }
                                    ],
                          "totalCount":  2
                      },
        "updatedAt":  "2024-07-18T18:33:21Z",
        "body":  "\u003c!--This is just a template - feel free to delete any and all of it and replace as appropriate.--\u003e\r\n\r\n### Description\r\n\r\nOn Linux, when [RBAC claims resolution](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-5.0\u0026tabs=visual-studio#kerberos-authentication-and-role-based-access-control-rbac) is enabled, requests to LDAP fail with `LdapException: The LDAP server is unavailable` after some period of inactivity (~30 minutes).\r\n\r\n### Configuration\r\n\r\n* .NET 5.0, 6.0\r\n* Linux in docker (`dotnet/aspnet:5.0` or `6.0`)\r\n\r\n### Regression?\r\n\r\nUnknown\r\n\r\n### Other information\r\n\r\nThough not definite, our experiments point to the TCP connection being forsibly closed for inactivity by some external mechanism (kernel? load-balancer?) as a likely reason.\r\nWhen we implemented periodic rebind by timer, the problem went away.\r\nThere\u0027s an option [`TcpKeepAlive`](https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.protocols.ldapsessionoptions.tcpkeepalive?view=dotnet-plat-ext-5.0) available in `LdapSessionOptions`, but it seems like it\u0027s not supported on Linux.\r\nIn OpenLdap [there are three options](https://www.openldap.org/software//man.cgi?query=ldap_get_option\u0026sektion=3\u0026apropos=0\u0026manpath=OpenLDAP+2.4-Release) available to set up keep-alive:\r\n```\r\nLDAP_OPT_X_KEEPALIVE_IDLE\r\nLDAP_OPT_X_KEEPALIVE_PROBES\r\nLDAP_OPT_X_KEEPALIVE_INTERVAL\r\n```\r\nThat would probably do the trick, but further investigation is needed.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOhVmc5g==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc41fBP7",
                                           "createdAt":  "2021-08-12T03:38:24Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Thanks for the report @RoadTrain . It may be a while before someone could investigate. Do you have an interest in trying those options to see whether it fixes it for you?",
                                           "updatedAt":  "2021-08-12T03:38:24Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc41fBvr",
                                           "createdAt":  "2021-08-12T03:45:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "@danmoseley I think I can try. It might take a while though, but I\u0027ll keep this issue updated.\r\n\r\nAs a side note, connectionless LDAP might help as well, need to check with #52904",
                                           "updatedAt":  "2021-08-12T03:48:55Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc41fFe7",
                                           "createdAt":  "2021-08-12T04:32:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOB2I30A==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "RoadTrain",
                                                                               "createdAt":  "2021-08-12T04:36:01Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2021-08-12T16:45:48Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  2
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Thank you @RoadTrain. We have seen interesting issues emerge in the S.DS.* libraries in real world use with various servers etc so it is particularly helpful when folks contribute that have such environments and often times better domain knowledge than we have. ",
                                           "updatedAt":  "2021-08-12T04:33:05Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6FWZzm",
                                           "createdAt":  "2024-07-18T18:32:39Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "SilvioSodre",
                                           "body":  "Hi All!\r\n\r\nI think this issue is a quite similar to issues [90024](https://github.com/dotnet/runtime/issues/90024), [82430](https://github.com/dotnet/runtime/issues/82430) e [94105](https://github.com/dotnet/aspnetcore/issues/49105). An error **\"The LDAP server is unavailable\"** emitted by **BeginSendRequest** when it try to rebind a ldap connection after a short random time interval (5-30 minutes). \r\n\r\nI liked the workaround mentioned by @RoadTrain , but I don\u0027t intend to implement it. For sure, there is a solution to this issue besides an implementation a sidecar code to keep the ldap connection up. \r\n\r\nHas someone got this error solved? I have seen in the Github forum many issues pointing to the same problem, but neither of them has really solved it. Has someone has any clue to solve the problem?",
                                           "updatedAt":  "2024-07-18T18:33:21Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "Linux: Support tcp keep-alive with openldap",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices",
                       "os-linux"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/59756",
        "createdAt":  "2021-09-29T15:37:03Z",
        "number":  59756,
        "author":  "ishikht",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-05-09T17:39:30Z",
        "body":  "The field: \r\ninternal SearchResultCollection? searchResult; \r\n\r\nwas never set. In older versions of the lib, the field was set in FindAll() method:\r\n\r\n      SearchResultCollection resultCollection = new SearchResultCollection(root, hSearchResult, strArray, this);\r\n      this.searchResult = resultCollection;\r\n      return resultCollection;\r\n\r\nNow:\r\n\r\n            return new SearchResultCollection(clonedRoot, resultsHandle, properties, this);\r\n\r\n\r\nAs result impossible to retrieve DirsyncCookie. ",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOW9Obbw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc43cyfE",
                                           "createdAt":  "2021-09-29T15:37:09Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\nThe field: \r\ninternal SearchResultCollection? searchResult; \r\n\r\nwas never set. In older versions of the lib, the field was set in FindAll() method:\r\n\r\n      SearchResultCollection resultCollection = new SearchResultCollection(root, hSearchResult, strArray, this);\r\n      this.searchResult = resultCollection;\r\n      return resultCollection;\r\n\r\nNow:\r\n\r\n            return new SearchResultCollection(clonedRoot, resultsHandle, properties, this);\r\n\r\n\r\nAs result impossible to retrieve DirsyncCookie. \n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eishikht\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2021-09-29T15:37:09Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc43c1a3",
                                           "createdAt":  "2021-09-29T15:51:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "This occurred here https://github.com/dotnet/corefx/pull/40321/files#diff-c3e651b2d7d4862e51442300df310213397a3f38e0dce30c02a86418df92e66cR669\r\n\r\n@stephentoub do you recall why you removed the set of the field here? ",
                                           "updatedAt":  "2021-09-29T15:51:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc43dtmw",
                                           "createdAt":  "2021-09-29T20:54:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCBDOxw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2021-11-03T17:52:48Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "for reference, the issue is that it will be null here\r\n\r\nhttps://github.com/dotnet/runtime/blob/e7b743cae325d4720fceaf7f84f68aaaf7bb7dbe/src/libraries/System.DirectoryServices/src/System/DirectoryServices/DirectorySearcher.cs#L504-L506\r\n\r\nand all our tests pass because they are calling the constructor of DirectorySynchronization and passing in the cookie directly.\r\n\r\n@ishikht do you have any interest in offering a PR to fix this, with a test?",
                                           "updatedAt":  "2021-09-29T20:54:58Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5b05tv",
                                           "createdAt":  "2023-05-09T17:39:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "This is fixed with https://github.com/dotnet/runtime/pull/79093 and the fix ported to 6.0/7.0, but no test added, keeping the issue open for adding a test case",
                                           "updatedAt":  "2023-05-09T17:39:03Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "Bug System.DirectoryServices.DirectorySearcher",
        "labels":  [
                       "area-System.DirectoryServices",
                       "test-enhancement",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/59900",
        "createdAt":  "2021-10-02T19:58:28Z",
        "number":  59900,
        "author":  "RoadTrain",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2021-11-23T19:40:16Z",
        "body":  "### Background and motivation\r\n\r\nAs per discussion at https://github.com/dotnet/runtime/issues/38609#issuecomment-897331400, it was suggested that runtime might benefit from LDAP query escape functionality.\r\n\r\nAs per [RFC 4515](https://tools.ietf.org/search/rfc4515#section-3), LDAP search filter arguments should be properly escaped.\r\nS.DS.P currently lacks such a functionality, which prevents some corner cases to work without consumer implementing such functionality themselves.\r\n\r\n### Detailed context (copied from https://github.com/dotnet/runtime/issues/38609#issuecomment-897331400): \r\nAnother case with escaping is when filter argument (e.g. group CN) contains parentheses, e.g. `Some (very) important group`.\r\nSince parentheses are a part of filter syntax itself, it might be problematic to correctly parse the filter.\r\n```\r\n(\u0026(objectClass=group)(sAMAccountName=Some (very) important group))\r\n```\r\n\r\nThe correct representation, [as per RFC](https://tools.ietf.org/search/rfc4515#section-3), is:\r\n```\r\n(\u0026(objectClass=group)(sAMAccountName=Some \\28very\\29 important group))\r\n```\r\nWhat\u0027s interesting is that the first one works on Windows, but fails on Linux.\r\nThe second one works on both Windows and Linux, as per my tests.\r\n\r\n\u003e If that is the case I propose to add the escaping functionality to System.DirectoryServices.Protocols.LdapConnection, so both libraries act the same on the windows as well as on linux.\r\n\r\nI think this might benefit from some general escape method which we can call manually when constructing filters, like:\r\n```\r\nvar filter = $\"(\u0026(objectClass=group)(sAMAccountName={LdapFilter.Escape(\"Some (very) important group\")}))\";\r\n```\r\nSomething along the lines of what I did here: https://github.com/dotnet/aspnetcore/pull/35279/commits/7f72499bb428bc1828d13e14367dc3c69c05b4d7\r\nIs it a good idea to provide such a method as part of core `System.DirectoryServices.Protocols` functionality?\r\n\r\n_Originally posted by @RoadTrain in https://github.com/dotnet/runtime/issues/38609#issuecomment-897331400_\r\n\r\n### API Proposal\r\n\r\n```C#\r\nnamespace System.DirectoryServices.Protocols\r\n{\r\n    public static class LdapFilter\r\n    {\r\n        public static string EscapeFilterArgument(string filterArgument);\r\n    }\r\n}\r\n```     \r\n\r\n\r\n### API Usage\r\n\r\n```C#\r\n// Construct the LDAP filter by correctly escaping filter arguments\r\nvar filter = $\"(\u0026(objectClass=group)(sAMAccountName={LdapFilter.EscapeFilterArgument(\"Some (very) important group\")}))\";\r\nConsole.WriteLine(filter);\r\n// Output:\r\n// (\u0026(objectClass=group)(sAMAccountName=Some \\28very\\29 important group))\r\n```     \r\n\r\n\r\n### Risks\r\n\r\nNone that I\u0027m aware of.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOOjvJ5Q==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc43mZfI",
                                           "createdAt":  "2021-10-02T19:58:34Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Background and motivation\n\nAs per discussion at https://github.com/dotnet/runtime/issues/38609#issuecomment-897331400, it was suggested that runtime might benefit from LDAP query escape functionality.\r\n\r\nAs per [RFC 4515](https://tools.ietf.org/search/rfc4515#section-3), LDAP search filter arguments should be properly escaped.\r\nS.DS.P currently lacks such a functionality, which prevents some corner cases to work without consumer implementing such functionality themselves.\r\n\r\n### Detailed context (copied from linked issue): \r\nAnother case with escaping is when filter argument (e.g. group CN) contains parentheses, e.g. `Some (very) important group`.\r\nSince parentheses are a part of filter syntax itself, it might be problematic to correctly parse the filter.\r\n```\r\n(\u0026(objectClass=group)(sAMAccountName=Some (very) important group))\r\n```\r\n\r\nThe correct representation, [as per RFC](https://tools.ietf.org/search/rfc4515#section-3), is:\r\n```\r\n(\u0026(objectClass=group)(sAMAccountName=Some \\28very\\29 important group))\r\n```\r\nWhat\u0027s interesting is that the first one works on Windows, but fails on Linux.\r\nThe second one works on both Windows and Linux, as per my tests.\r\n\r\n\u003e If that is the case I propose to add the escaping functionality to System.DirectoryServices.Protocols.LdapConnection, so both libraries act the same on the windows as well as on linux.\r\n\r\nI think this might benefit from some general escape method which we can call manually when constructing filters, like:\r\n```\r\nvar filter = $\"(\u0026(objectClass=group)(sAMAccountName={LdapFilter.Escape(\"Some (very) important group\")}))\";\r\n```\r\nSomething along the lines of what I did here: https://github.com/dotnet/aspnetcore/pull/35279/commits/7f72499bb428bc1828d13e14367dc3c69c05b4d7\r\nIs it a good idea to provide such a method as part of core `System.DirectoryServices.Protocols` functionality?\r\n\r\n_Originally posted by @RoadTrain in https://github.com/dotnet/runtime/issues/38609#issuecomment-897331400_\n\n### API Proposal\n\n```C#\r\nnamespace System.DirectoryServices.Protocols\r\n{\r\n    public static class LdapFilter\r\n    {\r\n        public static string EscapeFilterArgument(string filterArgument);\r\n    }\r\n}\r\n```     \r\n\n\n### API Usage\n\n```C#\r\n// Construct the LDAP filter by correctly escaping filter arguments\r\nvar filter = $\"(\u0026(objectClass=group)(sAMAccountName={LdapFilter.EscapeFilterArgument(\"Some (very) important group\")}))\";\r\nConsole.WriteLine(filter);\r\n// Output:\r\n// (\u0026(objectClass=group)(sAMAccountName=Some \\28very\\29 important group))\r\n```     \r\n\n\n### Risks\n\nNone that I\u0027m aware of.\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eRoadTrain\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`api-suggestion`, `area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2021-10-02T19:58:34Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc43mZn4",
                                           "createdAt":  "2021-10-02T20:03:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "One thing to consider: the escaping method should only do one thing -- replace reserved characters with their RFC-compliant form.\r\nSo the user of that method should be aware if the string is already escaped, because double-escaping would result in invalid argument value, i.e. the method cannot trivially be made idempotent.",
                                           "updatedAt":  "2021-10-02T20:05:12Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45NQ7A",
                                           "createdAt":  "2021-11-03T17:51:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "This sounds like a great feature, thanks for the proposal. Can you confirm a list of all characters that would need to be escaped for this? Also, we would need to make sure that the RFC-compliant form works for both wldap32 and libldap (openldap) which are the native libraries that we use underneath.",
                                           "updatedAt":  "2021-11-03T17:51:25Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45PQ01",
                                           "createdAt":  "2021-11-03T23:53:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCCBvxA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2021-11-10T18:28:28Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "\u003e This sounds like a great feature, thanks for the proposal. Can you confirm a list of all characters that would need to be escaped for this?\r\n\r\n[The RFC](https://tools.ietf.org/search/rfc4515#section-3) lists 5 characters that must be escaped:\r\n\u003e The \u003cvalueencoding\u003e rule ensures that the entire filter string is a\r\n   valid UTF-8 string and provides that the octets that represent the\r\n   ASCII characters \"*\" (ASCII 0x2a), \"(\" (ASCII 0x28), \")\" (ASCII\r\n   0x29), \"\\\" (ASCII 0x5c), and NUL (ASCII 0x00) are represented as a\r\n   backslash \"\\\" (ASCII 0x5c) followed by the two hexadecimal digits\r\n   representing the value of the encoded octet.\r\n\r\nFrom [Richard L. Mueller](https://www.rlmueller.net/CharactersEscaped.htm):\r\n![image](https://user-images.githubusercontent.com/2954604/140234434-ce76e44b-f5fa-4e68-838c-b21e3aff40a2.png)\r\n\r\n\u003e Also, we would need to make sure that the RFC-compliant form works for both wldap32 and libldap (openldap) which are the native libraries that we use underneath.\r\n\r\nThat would probably require some custom AD setup. In our case I tested probably the most common occurrence -- escaping parentheses. It worked on both Linux (openldap) and Windows (wldap32).\r\n\r\nThere\u0027s a note on this at [Technet](https://social.technet.microsoft.com/wiki/contents/articles/5312.active-directory-characters-to-escape.aspx#LDAP_Filters). An interesting detail is:\r\n\u003e Actually, the parentheses only need to be escaped if they are unmatched, as above. If instead the Common Name were \"James (Jim) Smith\", nothing would need to be escaped. However, any characters, including non-display characters, can be escaped in a similar manner in an LDAP filter.\r\n\r\nI believe it\u0027s an implementation detail of wldap32, since openldap still needs matched parentheses escaped.",
                                           "updatedAt":  "2021-11-06T15:44:37Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45jk_W",
                                           "createdAt":  "2021-11-10T18:34:56Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Great, I guess last thing to consider is whether we want to have this type public, or instead simply make it part of the LdapConnection request implementation detail, where we automatically escape all filters that get sent to us. what are your thoughts around that @RoadTrain? Main thinking behind that being that this way more folks would benefit from the escaping, as opposed to just folks who know about the new API.",
                                           "updatedAt":  "2021-11-10T18:35:42Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45kxI6",
                                           "createdAt":  "2021-11-11T02:43:12Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "@joperezr \r\n\u003e Great, I guess last thing to consider is whether we want to have this type public, or instead simply make it part of the LdapConnection request implementation detail, where we automatically escape all filters that get sent to us. what are your thoughts around that @RoadTrain? Main thinking behind that being that this way more folks would benefit from the escaping, as opposed to just folks who know about the new API.\r\n\r\nThat would be ideal, but the problem is that it would require parsing the entire query, which adds a whole bunch of issues and risks to the generalizability of implementation.\r\nFor example, for a query like\r\n```\r\n(\u0026(objectClass=group)(sAMAccountName=John Smith (work)))\r\n```\r\nwe would need to determine where the filter argument (`John Smith (work)`) starts and ends, then escape only that part.\r\nIf the argument is `John Smith work)`  instead, we would need to account for unmatched parentheses.\r\n\r\nI think this problem is better illustrated by this example: https://stackoverflow.com/a/62193991\r\nAnother reply there actually shows an approach that is equivalent to my proposal (except it\u0027s in Java :D ): https://stackoverflow.com/a/67284683 . The API is similar: https://nightlies.apache.org/directory/api/1.0.2/apidocs/org/apache/directory/api/ldap/model/filter/FilterEncoder.html#encodeFilterValue-java.lang.String-\r\n\r\nI personally don\u0027t know how many people use `LdapConnection` directly, my own use case is actually hidden behind ASP.NET Core APIs (i.e. RBAC authorization on Linux). So presumably, if such a functionality is implemented _and_ used inside ASP.NET Core, at least some customers would benefit indirectly.",
                                           "updatedAt":  "2021-11-11T02:43:12Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45kyCj",
                                           "createdAt":  "2021-11-11T02:53:19Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "Another approach might be to implement some form of an LDAP query builder.\r\nYet another one is parametrized queries.\r\nE.g.\r\n```\r\nvar filter = \"(\u0026(objectClass=group)(sAMAccountName={0}))\";\r\nvar searchRequest = new SearchRequest(distinguishedName, filter, new [] {accountName}, SearchScope.Subtree, null);\r\n```\r\nThat would require an additional parameter in the [constructor of `SearchRequest`](https://github.com/dotnet/runtime/blob/57bfe474518ab5b7cfe6bf7424a79ce3af9d6657/src/libraries/System.DirectoryServices.Protocols/src/System/DirectoryServices/Protocols/common/DirectoryRequest.cs#L230).\r\n\r\nMaybe the best way is to do both via statics:\r\n```\r\nnamespace System.DirectoryServices.Protocols\r\n{\r\n    public static class LdapFilter\r\n    {\r\n        public static string EscapeFilterArgument(string filterArgument);\r\n        public static string Format(string filter, string[] args);\r\n    }\r\n}\r\n```",
                                           "updatedAt":  "2021-11-11T03:01:54Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45kzwJ",
                                           "createdAt":  "2021-11-11T03:11:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCCFlAg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "RoadTrain",
                                                                               "createdAt":  "2021-11-11T03:13:49Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "joperezr",
                                           "body":  "You have a good point regarding it being better to scope it down to a helper method for now, specially since that way it can be used for something else and not just SearchRequest. I think this API is ready for review so I’ll mark it as such.",
                                           "updatedAt":  "2021-11-11T03:11:58Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc46FhnE",
                                           "createdAt":  "2021-11-19T22:59:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCDZwTA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "nil4",
                                                                               "createdAt":  "2021-11-20T08:25:40Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "joperezr",
                                           "body":  "One last question here, I was looking for precedence in the framework and found a similar pattern in Regex, which has the static API [Regex.Escape](https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.escape?view=net-6.0) for escaping special characters on a regex pattern directly onto the regex class. The question being, would it make sense to add these APIs directly into LdapConnection? That could help a lot with the visibility and discoverability of the API.",
                                           "updatedAt":  "2021-11-19T22:59:55Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc46G1zJ",
                                           "createdAt":  "2021-11-21T18:45:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "RoadTrain",
                                           "body":  "\u003e One last question here, I was looking for precedence in the framework and found a similar pattern in Regex, which has the static API [Regex.Escape](https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.escape?view=net-6.0) for escaping special characters on a regex pattern directly onto the regex class. The question being, would it make sense to add these APIs directly into LdapConnection? That could help a lot with the visibility and discoverability of the API.\r\n\r\nYeah, I think it\u0027s a valid approach. One thing to consider is possibly breaking SRP in case of `LdapConnection`. It *feels* like `Regex` is a bit more suited for escape functionality than `LdapConnection`. So they question really is whether `LdapConnection` is a good place for this method. \r\nI also can probably envision a situation where we might need other escape methods, e.g. for escaping Distinguished Names.\r\nI think it\u0027s something for the runtime team to decide :)\r\nI personally have no strong preferences, but I\u0027m leaning towards a separate static class.\r\nEither way will be good, so it\u0027s up to you.",
                                           "updatedAt":  "2021-11-21T18:48:36Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc46O8nl",
                                           "createdAt":  "2021-11-23T18:39:52Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODrVxCA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "RoadTrain",
                                                                               "createdAt":  "2021-11-24T17:00:43Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "k0st1x",
                                                                               "createdAt":  "2024-07-24T12:40:14Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  2
                                                         },
                                           "author":  "terrajobst",
                                           "body":  "[Video](https://www.youtube.com/watch?v=D9g8gYdViPY\u0026t=0h13m16s)\n\n* Do we need a new type? It seems more sensible to put it on an existing type.\r\n    - `SearchRequest`\r\n    - `LdapConnection` / `DirectoryConnection`\r\n* Is this specific to filters? If not, should we remove the term \"Filter\" from the method?\r\n* Do we need more a complex concept, such as builder-based approach?\r\n\r\n```C#\r\nnamespace System.DirectoryServices.Protocols\r\n{\r\n    public static class LdapFilter\r\n    {\r\n        public static string EscapeFilterArgument(string filterArgument);\r\n    }\r\n}\r\n```\r\n",
                                           "updatedAt":  "2021-11-23T19:40:16Z"
                                       }
                                   ],
                         "totalCount":  11
                     },
        "title":  "[API Proposal]: System.DirectoryServices.Protocols.LdapFilter",
        "labels":  [
                       "api-needs-work",
                       "api-suggestion",
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/60972",
        "createdAt":  "2021-10-28T14:59:20Z",
        "number":  60972,
        "author":  "macsux",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC_h71g==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "erosen03",
                                            "createdAt":  "2022-09-02T22:48:16Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "Jascha-N",
                                            "createdAt":  "2025-01-14T16:22:08Z"
                                        },
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "horihel",
                                            "createdAt":  "2025-02-27T08:44:35Z"
                                        }
                                    ],
                          "totalCount":  3
                      },
        "updatedAt":  "2025-07-26T10:39:10Z",
        "body":  "### Description\r\n\r\n`LdapConnection` fails to bind on Linux when running .NET `6.0.0-rc.2.21480.5` version of `System.DirectoryServices.Protocols` package and throws \r\n```\r\nUnhandled exception. System.DirectoryServices.Protocols.LdapException: The feature is not supported. \r\n   at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n   at System.DirectoryServices.Protocols.LdapConnection.Bind()\r\n```\r\nThe same code works when using switching to version 5.0.0 of `System.DirectoryServices.Protocols` or running under windows\r\n\r\n### Reproduction Steps\r\n\r\nRun the following code under Linux\r\n\r\n```xml\r\n\u003cProject Sdk=\"Microsoft.NET.Sdk\"\u003e\r\n  \u003cPropertyGroup\u003e\r\n    \u003cOutputType\u003eExe\u003c/OutputType\u003e\r\n    \u003cTargetFramework\u003enet6.0\u003c/TargetFramework\u003e\r\n    \u003cImplicitUsings\u003eenable\u003c/ImplicitUsings\u003e\r\n    \u003cNullable\u003eenable\u003c/Nullable\u003e\r\n  \u003c/PropertyGroup\u003e\r\n    \u003cItemGroup\u003e\r\n      \u003cPackageReference Include=\"System.DirectoryServices.Protocols\" Version=\"6.0.0-rc.2.21480.5\" /\u003e\r\n    \u003c/ItemGroup\u003e\r\n\u003c/Project\u003e\r\n```\r\n\r\n```csharp\r\nusing System.DirectoryServices.Protocols;\r\nusing System.Net;\r\n\r\nvar di = new LdapDirectoryIdentifier(server: \"ad.almirex.com\", 389);\r\nvar connection = new LdapConnection(di, new NetworkCredential(\"username\",\"password\",\"almirex.dc\"));\r\nconnection.Bind();\r\nConsole.WriteLine(\"Hello, World!\");\r\n```\r\n\r\nIf the package version is switched to `5.0.0`, the above code works.\r\n\r\n### Expected behavior\r\n\r\nThe code works\r\n\r\n### Actual behavior\r\n\r\nThe code throws\r\n\r\n### Regression?\r\n\r\nThis worked in .NET 5 version of the package.\r\n\r\n### Known Workarounds\r\n\r\nNone\r\n\r\n### Configuration\r\n\r\nTested with .NET 6.0.100-rc.2.21505.57 SDK on WSL2 Ubuntu\r\n\r\n### Other information\r\n\r\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOdecMXg==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc4429TH",
                                           "createdAt":  "2021-10-28T14:59:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\n`LdapConnection` fails to bind on Linux when running .NET `6.0.0-rc.2.21480.5` version of `System.DirectoryServices.Protocols` package and throws \r\n```\r\nUnhandled exception. System.DirectoryServices.Protocols.LdapException: The feature is not supported. \r\n   at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n   at System.DirectoryServices.Protocols.LdapConnection.Bind()\r\n```\r\nThe same code works when using switching to version 5.0.0 of `System.DirectoryServices.Protocols` or running under windows\n\n### Reproduction Steps\n\nRun the following code under Linux\r\n\r\n```xml\r\n\u003cProject Sdk=\"Microsoft.NET.Sdk\"\u003e\r\n  \u003cPropertyGroup\u003e\r\n    \u003cOutputType\u003eExe\u003c/OutputType\u003e\r\n    \u003cTargetFramework\u003enet6.0\u003c/TargetFramework\u003e\r\n    \u003cImplicitUsings\u003eenable\u003c/ImplicitUsings\u003e\r\n    \u003cNullable\u003eenable\u003c/Nullable\u003e\r\n  \u003c/PropertyGroup\u003e\r\n    \u003cItemGroup\u003e\r\n      \u003cPackageReference Include=\"System.DirectoryServices.Protocols\" Version=\"6.0.0-rc.2.21480.5\" /\u003e\r\n    \u003c/ItemGroup\u003e\r\n\u003c/Project\u003e\r\n```\r\n\r\n```csharp\r\nusing System.DirectoryServices.Protocols;\r\nusing System.Net;\r\n\r\nvar di = new LdapDirectoryIdentifier(server: \"ad.almirex.com\", 389);\r\nvar connection = new LdapConnection(di, new NetworkCredential(\"username\",\"password\",\"ad.almirex.dc\"));\r\nconnection.Bind();\r\nConsole.WriteLine(\"Hello, World!\");\r\n```\r\n\r\nIf the package version is switched to `5.0.0`, the above code works.\n\n### Expected behavior\n\nThe code works\n\n### Actual behavior\n\nThe code throws\n\n### Regression?\n\nThis worked in .NET 5 version of the package.\n\n### Known Workarounds\n\nNone\n\n### Configuration\n\nTested with .NET 6.0.100-rc.2.21505.57 SDK on WSL2 Ubuntu\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003emacsux\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2021-10-28T14:59:37Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc443Sb5",
                                           "createdAt":  "2021-10-28T16:41:47Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "macsux",
                                           "body":  "I think this is related to Ntlm somehow being broken on .NET 6. I switched it up like this:\r\n```csharp\r\nusing System.DirectoryServices.Protocols;\r\nusing System.Net;\r\n\r\nvar di = new LdapDirectoryIdentifier(server: \"ad.almirex.com\", 389);\r\nvar connection = new LdapConnection(di, new NetworkCredential(\"user\",\"password\", \"almirex.dc\"), AuthType.Ntlm);\r\nconnection.Bind();\r\nConsole.WriteLine(\"Hello, World!\");\r\n```\r\nand getting \r\n```\r\nUnhandled exception. System.DirectoryServices.Protocols.LdapException: An unknown authentication error occurred.\r\n   at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n   at System.DirectoryServices.Protocols.LdapConnection.Bind()\r\n```\r\n\r\nThe same code works with `5.0.0` package, and v6 version of package works on Windows.",
                                           "updatedAt":  "2021-10-28T16:41:47Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45NPgl",
                                           "createdAt":  "2021-11-03T17:44:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Thanks for logging the issue. Can you please try setting the connection auth type to Basic as well as setting the protocol version to 3.0?\r\n\r\n```c#\r\nvar di = new LdapDirectoryIdentifier(server: \"ad.almirex.com\", 389);\r\nvar connection = new LdapConnection(di, new NetworkCredential(\"user\", \"password\", \"almirex.dc\"));\r\nconnection.SessionOptions.ProtocolVersion = 3;\r\nconnection.AuthType = AuthType.Basic;\r\nconnection.Bind();\r\nConsole.WriteLine(\"Hello, World!\");\r\n```\r\n",
                                           "updatedAt":  "2021-11-03T17:44:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45Vp9_",
                                           "createdAt":  "2021-11-05T15:12:17Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "macsux",
                                           "body":  "Ok, that seems to have partially fixed the issue, I can connect to the LDAP endpoint on 389. It however fails to connect to LDAPS when running under linux, even though .NET 6 release notes says this is supposed to be supported. This is the code used:\r\n\r\n```csharp\r\nusing System.DirectoryServices.Protocols;\r\nusing System.Net;\r\n\r\nvar useSsl = true;\r\nvar port = useSsl ? 636 : 389;\r\nvar di = new LdapDirectoryIdentifier(server: \"ad.almirex.com\", port);\r\nvar connection = new LdapConnection(di, new NetworkCredential(\"username\",\"password\"), AuthType.Basic);\r\nif (useSsl)\r\n{\r\n    connection.SessionOptions.SecureSocketLayer = true;\r\n    connection.SessionOptions.VerifyServerCertificate = (ldapConnection, certificate) =\u003e true;\r\n}\r\nconnection.Bind();\r\nConsole.WriteLine(\"Hello, World!\");\r\n```",
                                           "updatedAt":  "2021-11-05T15:12:17Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45VrQb",
                                           "createdAt":  "2021-11-05T15:18:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I believe ldaps is only supported when using protocol version 3. Can you try setting the protocol version to 3.0 in your connection before calling bind?",
                                           "updatedAt":  "2021-11-05T15:18:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45Vsce",
                                           "createdAt":  "2021-11-05T15:24:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "macsux",
                                           "body":  "Didn\u0027t help. Looking closer it\u0027s actually choking on the setter for this line when run under Linux, but works fine on windows.\r\n\r\n```csharp\r\nconnection.SessionOptions.VerifyServerCertificate = (ldapConnection, certificate) =\u003e true;\r\n```\r\n\r\n```\r\nUnhandled exception. System.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable.\r\n   at System.DirectoryServices.Protocols.ErrorChecking.CheckAndSetLdapError(Int32 error)\r\n   at System.DirectoryServices.Protocols.LdapSessionOptions.set_VerifyServerCertificate(VerifyServerCertificateCallback value)\r\n   at Program.\u003cMain\u003e$(String[] args) in /mnt/c/projects/ldapplay/Program.cs:line 12\r\n```",
                                           "updatedAt":  "2021-11-05T15:24:42Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45bxm_",
                                           "createdAt":  "2021-11-08T21:17:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I see, that is definitely a bug in Linux that we should fix, I\u0027ll update the title of the issue to say that this specific session option is the one that isn\u0027t working correctly. Out of curiosity, is there a specific reason you are defining that callback? I ask because the SSL handshake will automatically verify the server certificate already, and seems like yours isn\u0027t really changing anything. Can we get confirmation that if you remove that line the code works as expected? ",
                                           "updatedAt":  "2021-11-08T21:17:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45byry",
                                           "createdAt":  "2021-11-08T21:22:35Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Actually after looking this more closely, looks like the Option that this is internally trying to set is indeed not supported anywhere other than wldap32 (meaning this setting is not part of the LDAP spec) which explains why it doesn\u0027t work on Linux.\r\n\r\nhttps://github.com/dotnet/runtime/blob/704f023147b49692cec842427b116e9ee7e64305/src/libraries/Common/src/Interop/Interop.Ldap.cs#L91\r\n\r\nPerhaps what this issue should track is just to have the right documentation on this API to mention that this is not supported in Linux, and we should be throwing a better exception with better details on it.",
                                           "updatedAt":  "2021-11-08T21:22:35Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45cL2j",
                                           "createdAt":  "2021-11-09T00:10:43Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "macsux",
                                           "body":  "We are trying to ignore ssl cert validation at least in lower tier\nenvironments, is this possible? The ability to ignore cert validation is a\nusual option in most TLS libraries.\n\nOn Mon., Nov. 8, 2021, 4:22 p.m. Jose Perez Rodriguez, \u003c\n***@***.***\u003e wrote:\n\n\u003e Actually after looking this more closely, looks like the Option that this\n\u003e is internally trying to set is indeed not supported anywhere other than\n\u003e wldap32 (meaning this setting is not part of the LDAP spec) which explains\n\u003e why it doesn\u0027t work on Linux.\n\u003e\n\u003e\n\u003e https://github.com/dotnet/runtime/blob/704f023147b49692cec842427b116e9ee7e64305/src/libraries/Common/src/Interop/Interop.Ldap.cs#L91\n\u003e\n\u003e Perhaps what this issue should track is just to have the right\n\u003e documentation on this API to mention that this is not supported in Linux,\n\u003e and we should be throwing a better exception with better details on it.\n\u003e\n\u003e —\n\u003e You are receiving this because you authored the thread.\n\u003e Reply to this email directly, view it on GitHub\n\u003e \u003chttps://github.com/dotnet/runtime/issues/60972#issuecomment-963586802\u003e,\n\u003e or unsubscribe\n\u003e \u003chttps://github.com/notifications/unsubscribe-auth/AAINFWH7IEF2BQMLB6G5NALULA5SLANCNFSM5G5DSI3A\u003e\n\u003e .\n\u003e Triage notifications on the go with GitHub Mobile for iOS\n\u003e \u003chttps://apps.apple.com/app/apple-store/id1477376905?ct=notification-email\u0026mt=8\u0026pt=524675\u003e\n\u003e or Android\n\u003e \u003chttps://play.google.com/store/apps/details?id=com.github.android\u0026referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub\u003e.\n\u003e\n\u003e\n",
                                           "updatedAt":  "2021-11-09T00:10:43Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45e1ed",
                                           "createdAt":  "2021-11-09T17:43:51Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC-byUw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "AndreyFedorovIID",
                                                                               "createdAt":  "2023-06-20T15:23:30Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "macsux",
                                           "body":  "Also, I\u0027m getting a `CA1416` warning on `connection.SessionOptions.SecureSocketLayer = options.UseSsl;` telling me this API is windows only. Is this a left over that forgot to be removed after LDAPS supported was added for Linux?",
                                           "updatedAt":  "2021-11-09T17:43:51Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45fGaY",
                                           "createdAt":  "2021-11-09T19:12:16Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Oh good catch, seems like when we added this feature we forgot to remove this attribute:\r\n\r\nhttps://github.com/dotnet/runtime/blob/9c37cdc559a141c92e20e123c9a594fed3692fec/src/libraries/System.DirectoryServices.Protocols/ref/System.DirectoryServices.Protocols.cs#L375\r\n\r\nWould you be interested in submitting a PR fixing that? 😃 ",
                                           "updatedAt":  "2021-11-09T19:12:16Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45fHGC",
                                           "createdAt":  "2021-11-09T19:15:51Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "\u003e We are trying to ignore ssl cert validation at least in lower tier\r\nenvironments, is this possible?\r\n\r\nI\u0027m not sure that is supported as the TLS handshaking happens at the openldap layer and we particularly want to make sure that this happens correctly, as any error during the handshaking process could result in openldap not encrypting the communication if we were to ignore the failure with the handshake. ",
                                           "updatedAt":  "2021-11-09T19:15:51Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45f_jS",
                                           "createdAt":  "2021-11-10T01:09:24Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "macsux",
                                           "body":  "I\u0027ve submitted a PR to remove the leftover warning attribute.\r\n\r\nI\u0027ve found a workaround for this problem that works for me. By setting `LDAPTLS_REQCERT=never` environmental variable I can opt-out of SSL validation by OpenSSL as described by [OpenSSL configuration](https://www.openldap.org/software//man.cgi?query=ldap.conf\u0026sektion=5\u0026apropos=0\u0026manpath=OpenLDAP+2.4-Release). Interestingly trying to do this from within the process via `Environment.SetEnvironmentVariable(\"LDAPTLS_REQCERT\",\"never\");` does not work. \r\n\r\nThe existing API `VerifyServerCertificate` offers a flexible callback that would allow users to provide a custom delegate on how cert validation should be performed. It seems that such callback feature is only available on Windows, as the only options that OpenSSL exposes are:\r\n```\r\n       TLS_REQCERT \u003clevel\u003e\r\n              Specifies what checks to perform on server certificates in a TLS\r\n              session, if any. The \u003clevel\u003e can be  specified  as  one  of  the\r\n              following keywords:\r\n\r\n              never  The   client   will  not  request  or  check  any  server\r\n                     certificate.\r\n\r\n              allow  The server certificate is requested. If no certificate is\r\n                     provided,   the  session  proceeds  normally.  If  a  bad\r\n                     certificate is provided,  it  will  be  ignored  and  the\r\n                     session proceeds normally.\r\n\r\n              try    The server certificate is requested. If no certificate is\r\n                     provided,  the  session  proceeds  normally.  If  a   bad\r\n                     certificate  is  provided,  the  session  is  immediately\r\n                     terminated.\r\n\r\n              demand | hard\r\n                     These keywords are equivalent. The server certificate  is\r\n                     requested.  If  no  certificate  is  provided,  or  a bad\r\n                     certificate  is  provided,  the  session  is  immediately\r\n                     terminated. This is the default setting.\r\n```\r\n\r\nWhile my workaround works for my use case, it\u0027s not very good long term because\r\n1. It has to be set outside of the process\r\n2. It affects ALL LDAP connections in the app.\r\n\r\nI think it\u0027s worth discussing at this point whether a simplified `SkipCertificateValidation` or similarly named boolean property should be added to the `LdapSessionOptions` to give some degree of control over cert validation within code. While not as powerful as the callback offered by `VerifyServerCertificate`, 99% of the time developers are just trying to do a blanked bypass of cert validation without any custom logic. \r\n\r\nI believe the only thing that would be required is to call `ldap_set_option` with `LDAP_OPT_X_TLS_REQUIRE_CERT` to one of `LDAP_OPT_X_TLS_NEVER` if the above property is true. More details [here](https://www.openldap.org/software/man.cgi?query=ldap_set_option\u0026apropos=0\u0026sektion=0\u0026manpath=OpenLDAP+2.6-Release\u0026arch=default\u0026format=html#TLS_OPTIONS).\r\n",
                                           "updatedAt":  "2021-11-10T01:14:04Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc45j3e_",
                                           "createdAt":  "2021-11-10T20:08:02Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Thanks for submitting the PR. I\u0027d be interested in debugging why setting it through Environment.SetEnvironmentVariable didn\u0027t work as I would have expected that to work.",
                                           "updatedAt":  "2021-11-10T20:08:02Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc469ffa",
                                           "createdAt":  "2021-12-08T21:10:16Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCdtmvQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "macsux",
                                                                               "createdAt":  "2021-12-08T21:13:29Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "mazocode",
                                                                               "createdAt":  "2022-05-19T15:12:04Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  2
                                                         },
                                           "author":  "jborean93",
                                           "body":  "\u003e Interestingly trying to do this from within the process via Environment.SetEnvironmentVariable(\"LDAPTLS_REQCERT\",\"never\"); does not work.\r\n\r\nThis is most likely because .NET sets environment vars for a process in a separate layer to the actual process environment block. I came across this issue before when trying to set `KRB5_TRACE=/dev/stdout` (or any of the other GSSAPI env vars) to debug some stuff and the C layer was unable to see these env vars.\r\n\r\nTo set an env var at runtime for use by a called \"PInvoke\" function you need to essentially call `setenv` in `libc` like\r\n\r\n```csharp\r\nusing System;\r\nusing System.Runtime.InteropServices;\r\n\r\nnamespace Native\r\n{\r\n    public class Libc\r\n    {\r\n        [DllImport(\"libc\")]\r\n        public static extern void setenv(string name, string value);\r\n\r\n        [DllImport(\"libc\")]\r\n        public static extern void unsetenv(string name);\r\n    }\r\n}\r\n```\r\n\r\nYou would then do `Native.Libc.setenv(\"LDAPTLS_REQCERT\", \"never\");` to set the env var.",
                                           "updatedAt":  "2021-12-08T21:10:16Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4_2CcR",
                                           "createdAt":  "2022-03-17T17:34:01Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "parrssee",
                                           "body":  "@joperezr @macsux So, I still did not understand whether the SSL connection works on Linux or not. I have already searched all similar threads on this topic and could not find a normal solution. Here\u0027s code snippet that I took from @macsux to simply connect to my LDAP server over 636 port:\r\n```\r\nusing System;\r\nusing System.DirectoryServices.Protocols;\r\nusing System.Net;\r\n\r\nvar di = new LdapDirectoryIdentifier(server: \"\u003cserver\u003e\", 636);\r\nusing var connection = new LdapConnection(di, new NetworkCredential(\"LDAP\\\\user\", \"password\"), AuthType.Basic);\r\nconnection.SessionOptions.ProtocolVersion = 3;\r\nconnection.SessionOptions.SecureSocketLayer = true;\r\nConsole.WriteLine(\"Hello, World!\");\r\n```\r\nAm I missing something? I also tried to use\r\n` connection.SessionOptions.VerifyServerCertificate += (ldapConnection, certificate) =\u003e true;`\r\nbut it doesn\u0027t help at all, and according to this thread this code doesn\u0027t work for Linux. \r\nI\u0027m always get this kind of errors:\r\n```\r\nUnhandled exception. System.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable.\r\n   at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n   at System.DirectoryServices.Protocols.LdapConnection.Bind()\r\n   at \u003cProgram\u003e$.\u003cMain\u003e$(String[] args) in Program.cs:line 10\r\n```\r\nIt worth to mention that if I connect through 389 port everything is OK.\r\nDoes this library currently support SSL connection on Linux?\r\nI\u0027m quite stuck and would be very grateful for help.",
                                           "updatedAt":  "2022-03-17T17:42:15Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4_2DWz",
                                           "createdAt":  "2022-03-17T17:37:56Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "macsux",
                                           "body":  "It works but if you\u0027re looking to skip ssl validation you have to do it via env var rather then the callback event. See my earlier comments",
                                           "updatedAt":  "2022-03-17T17:37:56Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4_2D1Y",
                                           "createdAt":  "2022-03-17T17:39:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "parrssee",
                                           "body":  "\u003e It works but if you\u0027re looking to skip ssl validation you have to do it via env var rather then the callback event. See my earlier comments\r\n\r\nQuite the contrary, I don\u0027t need to skip this validation and because of this I don\u0027t know how to connect over 636 port",
                                           "updatedAt":  "2022-03-17T17:39:58Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4_2EsJ",
                                           "createdAt":  "2022-03-17T17:43:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODLichQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HOORAY",
                                                                               "user":  "kelseidy",
                                                                               "createdAt":  "2023-11-01T08:22:28Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "macsux",
                                           "body":  "This code is confirmed to work\nhttps://github.com/NMica/NMica.Security/blob/3868ceab4880058fbca4b66d651a169d04757d1d/src/NMica.AspNetCore.Authentication.Spnego/Ldap/LdapRolesClaimsTransformation.cs#L204\n\nOn Thu., Mar. 17, 2022, 1:40 p.m. parrssee, ***@***.***\u003e\nwrote:\n\n\u003e It works but if you\u0027re looking to skip ssl validation you have to do it\n\u003e via env var rather then the callback event. See my earlier comments\n\u003e\n\u003e Quite the contrary, I don\u0027t need to skip this validation and because of\n\u003e this I don\u0027t know how to connect over 636 port\n\u003e\n\u003e —\n\u003e Reply to this email directly, view it on GitHub\n\u003e \u003chttps://github.com/dotnet/runtime/issues/60972#issuecomment-1071136088\u003e,\n\u003e or unsubscribe\n\u003e \u003chttps://github.com/notifications/unsubscribe-auth/AAINFWDKZ2X7GY7L4T3LU33VANU7RANCNFSM5G5DSI3A\u003e\n\u003e .\n\u003e Triage notifications on the go with GitHub Mobile for iOS\n\u003e \u003chttps://apps.apple.com/app/apple-store/id1477376905?ct=notification-email\u0026mt=8\u0026pt=524675\u003e\n\u003e or Android\n\u003e \u003chttps://play.google.com/store/apps/details?id=com.github.android\u0026referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub\u003e.\n\u003e\n\u003e You are receiving this because you were mentioned.Message ID:\n\u003e ***@***.***\u003e\n\u003e\n",
                                           "updatedAt":  "2022-03-17T17:43:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4_2FAW",
                                           "createdAt":  "2022-03-17T17:45:01Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "parrssee",
                                           "body":  "@macsux,\r\nThank You. I\u0027ll try this out",
                                           "updatedAt":  "2022-03-17T17:45:01Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc4_6XaO",
                                           "createdAt":  "2022-03-18T10:13:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODHaHxQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "Chebura",
                                                                               "createdAt":  "2023-09-21T11:01:12Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "parrssee",
                                           "body":  "@macsux I tried Your solution but got the same error as always:\r\n```\r\nUnhandled exception. System.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable.\r\n   at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n   at System.DirectoryServices.Protocols.LdapConnection.Bind()\r\n   at \u003cProgram\u003e$.\u003cMain\u003e$(String[] args) in Program.cs:line 25\r\n```\r\nI use the same server address string as for Windows: \r\n`var di = new LdapDirectoryIdentifier(server: \"10.6.1.162\", 636, true, false);`\r\nAm I using wrong connection string? Maybe external connection to this IP address through 636 port is blocked, I\u0027ll try to contact my DevOps.",
                                           "updatedAt":  "2022-03-18T10:30:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5C7mNK",
                                           "createdAt":  "2022-05-10T21:53:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "akamud",
                                           "body":  "\u003e @macsux I tried Your solution but got the same error as always:\r\n\u003e \r\n\u003e ```\r\n\u003e Unhandled exception. System.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable.\r\n\u003e    at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n\u003e    at System.DirectoryServices.Protocols.LdapConnection.Bind()\r\n\u003e    at \u003cProgram\u003e$.\u003cMain\u003e$(String[] args) in Program.cs:line 25\r\n\u003e ```\r\n\u003e \r\n\u003e I use the same server address string as for Windows: `var di = new LdapDirectoryIdentifier(server: \"10.6.1.162\", 636, true, false);` Am I using wrong connection string? Maybe external connection to this IP address through 636 port is blocked, I\u0027ll try to contact my DevOps.\r\n\r\n\r\nHave you managed to solve this?\r\nI\u0027m trying the same thing on a Mac, and nothing on this thread worked, I am still getting a \"The LDAP server is unavailable\" message when I bind. I\u0027m connecting pretty much exactly like mentioned [here](https://github.com/NMica/NMica.Security/blob/3868ceab4880058fbca4b66d651a169d04757d1d/src/NMica.AspNetCore.Authentication.Spnego/Ldap/LdapRolesClaimsTransformation.cs#L204).\r\n\r\nThis is the code right now:\r\n\r\n```csharp\r\n        var ldapInfo = new LdapDirectoryIdentifier(config.Server, config.Port);\r\n        var ldapCred =\r\n            new NetworkCredential(ldapCred.User, ldapCred.Password, ldapCred.Domain);\r\n        _ldapConnection = new LdapConnection(ldapInfo, ldapCred)\r\n        {\r\n            AuthType = AuthType.Basic,\r\n            SessionOptions =\r\n            {\r\n                ReferralChasing = ReferralChasingOptions.None,\r\n                ProtocolVersion = 3,\r\n#pragma warning disable CA1416\r\n                SecureSocketLayer = true\r\n#pragma warning restore CA1416\r\n            }\r\n        };\r\n```",
                                           "updatedAt":  "2022-05-10T21:53:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5DCNfG",
                                           "createdAt":  "2022-05-12T07:55:31Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOC-cJJw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "AndreyFedorovIID",
                                                                               "createdAt":  "2023-06-20T16:09:21Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "parrssee",
                                           "body":  "@akamud \r\nWe\u0027ve found out that this issue was related to the wrong configurated LDAP server \u0026 missing certificates. Also, I found that specifying FQDN as server address in the **LdapDirectoryIdentifier** not working on the Linux platform, probably because of [this](https://github.com/dotnet/runtime/blob/d3af4921f36dba8dde35ade7dff59a3a192edddb/src/libraries/System.DirectoryServices.Protocols/src/System/DirectoryServices/Protocols/ldap/LdapConnection.Linux.cs#L23).\r\nAlso, there\u0027s the **VerifyServerCertificate** callback in which you must validate your LDAP certificate, but this functionality not working on the Linux (because, on the Linux, we are basically only passing through the Bind to the underlying native library), and I\u0027m not sure about Mac platform.\r\n\r\nHere\u0027s the code sample of the class that I wrote to manage LDAP connections (I changed the code a bit so as not to violate the police company I work with):\r\n```\r\nstring address = \"some.ldap.server.com\"; // You can specify port number here and then extract it from this string\r\nint port = IsSsl ? 636 : 389;           \r\nvar directoryIdentifier = new LdapDirectoryIdentifier(address, port);\r\n_ldapConnection = new LdapConnection(directoryIdentifier, credential, AuthType.Basic);\r\n_ldapConnection.SessionOptions.ReferralChasing = _referralChasingOptions; // All\r\n_ldapConnection.SessionOptions.ProtocolVersion = LDAP3ProtocolVersion; // 3\r\n_ldapConnection.SessionOptions.SecureSocketLayer = IsSsl;\r\n_ldapConnection.Timeout = Timeout;\r\n_ldapConnection.AutoBind = AutoBind; \r\n// When using LDAPS in Linux we are basically only passing through the Bind to the underlying native library (openldap), which does perform a certificate validation.\r\n// If the certificate fails to validate successfully, we will get an exception during call to Bind() which should have more info saying that the certificate was invalid or\r\n// that the connection with the server couldn\u0027t be established.\r\n// In case of Win NT systems we can use the built-in verification functionality provided in the X509Cerificate2 class\r\nif (Environment.OSVersion.Platform == PlatformID.Win32NT)\r\n{\r\n    _ldapConnection.SessionOptions.VerifyServerCertificate += \r\n        (ldapConnection, certificate) =\u003e new X509Certificate2(certificate).Verify();\r\n}   \r\n```\r\nIn the case of Mac, maybe you must verify the certificate yourself too (like on Win), so try to do some experiments with this sample.",
                                           "updatedAt":  "2022-05-12T07:55:31Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5DHwmc",
                                           "createdAt":  "2022-05-13T14:15:26Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "akamud",
                                           "body":  "\u003e @akamud We\u0027ve found out that this issue was related to the wrong configurated LDAP server \u0026 missing certificates. Also, I found that specifying FQDN as server address in the **LdapDirectoryIdentifier** not working on the Linux platform, probably because of [this](https://github.com/dotnet/runtime/blob/d3af4921f36dba8dde35ade7dff59a3a192edddb/src/libraries/System.DirectoryServices.Protocols/src/System/DirectoryServices/Protocols/ldap/LdapConnection.Linux.cs#L23). Also, there\u0027s the **VerifyServerCertificate** callback in which you must validate your LDAP certificate, but this functionality not working on the Linux (because, on the Linux, we are basically only passing through the Bind to the underlying native library), and I\u0027m not sure about Mac platform.\r\n\u003e \r\n\u003e Here\u0027s the code sample of the class that I wrote to manage LDAP connections (I changed the code a bit so as not to violate the police company I work with):\r\n\u003e \r\n\u003e ```\r\n\u003e string address = \"some.ldap.server.com\"; // You can specify port number here and then extract it from this string\r\n\u003e int port = IsSsl ? 636 : 389;           \r\n\u003e var directoryIdentifier = new LdapDirectoryIdentifier(address, port);\r\n\u003e _ldapConnection = new LdapConnection(directoryIdentifier, credential, AuthType.Basic);\r\n\u003e _ldapConnection.SessionOptions.ReferralChasing = _referralChasingOptions; // All\r\n\u003e _ldapConnection.SessionOptions.ProtocolVersion = LDAP3ProtocolVersion; // 3\r\n\u003e _ldapConnection.SessionOptions.SecureSocketLayer = IsSsl;\r\n\u003e _ldapConnection.Timeout = Timeout;\r\n\u003e _ldapConnection.AutoBind = AutoBind; \r\n\u003e // When using LDAPS in Linux we are basically only passing through the Bind to the underlying native library (openldap), which does perform a certificate validation.\r\n\u003e // If the certificate fails to validate successfully, we will get an exception during call to Bind() which should have more info saying that the certificate was invalid or\r\n\u003e // that the connection with the server couldn\u0027t be established.\r\n\u003e // In case of Win NT systems we can use the built-in verification functionality provided in the X509Cerificate2 class\r\n\u003e if (Environment.OSVersion.Platform == PlatformID.Win32NT)\r\n\u003e {\r\n\u003e     _ldapConnection.SessionOptions.VerifyServerCertificate += \r\n\u003e         (ldapConnection, certificate) =\u003e new X509Certificate2(certificate).Verify();\r\n\u003e }   \r\n\u003e ```\r\n\u003e \r\n\u003e In the case of Mac, maybe you must verify the certificate yourself too (like on Win), so try to do some experiments with this sample.\r\n\r\nThanks for the reply, in fact we found something similar here. One of our servers wasn\u0027t correctly configured, when we tried the other one it worked. Now we configured the server correctly and everything is working fine.\r\n\r\nRegarding the `VerifyServerCertificate`, it doesn\u0027t work on macOS either, so I used the same strategy of setting the `LDAPTLS_REQ` env for the openldap verification.\r\n\r\n@joperezr any chance the error messages from theses cases can be more helpful? I used Apache Directory Server to try and connect to the server using SSL and it provided me better error messages, only then we started to investigate our server. The \"server is unavailable\" message from the .NET implementation is very generic.",
                                           "updatedAt":  "2022-05-13T14:15:26Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5FwH22",
                                           "createdAt":  "2022-06-29T17:01:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCtB9-g==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "akamud",
                                                                               "createdAt":  "2022-06-29T17:27:29Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "erosen03",
                                                                               "createdAt":  "2022-09-02T22:48:01Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "FelixSFD",
                                                                               "createdAt":  "2022-09-29T13:35:09Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Yes, we have several issues for trying to surface the error messages better, we can use this issue to track the work of making that better for .NET 7",
                                           "updatedAt":  "2022-06-29T17:01:03Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5JrHo1",
                                           "createdAt":  "2022-09-03T03:40:39Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "erosen03",
                                           "body":  "@joperezr was LdapSessionOptions.VerifyServerCertificate ever implemented on Linux? I\u0027m having the exact same issues as the other folks on this thread, and the only workaround was to issue `export LDAPTLS_REQCERT=never` in the parent process of pwsh (i.e. the bash shell that spawns PowerShell). \r\n\r\nThis is not a great workaround, because the `export` must be run prior to spawning the PowerShell process. It cannot be run from within a PowerShell script. This is very problematic when working with an AWS PowerShell Lambda Function.",
                                           "updatedAt":  "2022-09-03T03:40:39Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5JrQBD",
                                           "createdAt":  "2022-09-03T08:24:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "jborean93",
                                           "body":  "You can set it in proc but you need to use PInvoke to call setenv in libc directly and not through the dotnet APIs. It’s not ideal but it at least doesn’t rely on the env var being set before the process starts.",
                                           "updatedAt":  "2022-09-03T08:24:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5L6yWh",
                                           "createdAt":  "2022-10-10T19:01:50Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "\u003e @joperezr was LdapSessionOptions.VerifyServerCertificate ever implemented on Linux? I\u0027m having the exact same issues as the other folks on this thread, and the only workaround was to issue export LDAPTLS_REQCERT=never in the parent process of pwsh (i.e. the bash shell that spawns PowerShell).\r\n\r\nWe haven\u0027t been able to prioritize this issue to add the support in Linux yet, but we would definitely be open into taking a contribution that addresses this in case anyone is interested in  helping. Otherwise, we will keep it in the backlog and hopefully be able to get to it in 8.0, but that would greatly depend on the work going to the rest of the libraries and their priorities.",
                                           "updatedAt":  "2022-10-10T19:01:50Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YUG1D",
                                           "createdAt":  "2023-03-23T18:04:48Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GeertvanHorrik",
                                           "body":  "Been struggling with this as well (LPAP via SSL on Linux). A few things that might be useful for others:\r\n\r\n1. It\u0027s important to set the environment variable before creating the connection. I did it after creating the connection (where I used to set the server certificate validation callback), but then the underlying library seems to have already read the state and won\u0027t do that again. So if you are using the workaround by setting the environment via the `setenv`, make sure to do it earlier if it\u0027s not working for you.\r\n\r\n2. As suggested [here](https://github.com/dotnet/runtime/issues/60972#issuecomment-964688082), I\u0027ve tried doing this \"per connection / instance\" instead by using the handle with custom interop. It looks like it\u0027s a global (handle should be `null` (or `IntPtr.Zero`)) setting according to [this post](https://www.openldap.com/lists/openldap-technical/201112/msg00268.html) and cannot be set per instance.\r\n\r\nThe [Novell.Directory.Ldap.NETStandard](https://github.com/dsbenghe/Novell.Directory.Ldap.NETStandard) library that some have mentioned can do this per connection / instance, but it would require a rewrite of most of the LDAP / AD related code.",
                                           "updatedAt":  "2023-03-23T18:04:48Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YZyT5",
                                           "createdAt":  "2023-03-24T17:19:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "michiproep",
                                           "body":  "\u003e This code is confirmed to work https://github.com/NMica/NMica.Security/blob/3868ceab4880058fbca4b66d651a169d04757d1d/src/NMica.AspNetCore.Authentication.Spnego/Ldap/LdapRolesClaimsTransformation.cs#L204\r\n\u003e […](#)\r\n\u003e On Thu., Mar. 17, 2022, 1:40 p.m. parrssee, ***@***.***\u003e wrote: It works but if you\u0027re looking to skip ssl validation you have to do it via env var rather then the callback event. See my earlier comments Quite the contrary, I don\u0027t need to skip this validation and because of this I don\u0027t know how to connect over 636 port — Reply to this email directly, view it on GitHub \u003c[#60972 (comment)](https://github.com/dotnet/runtime/issues/60972#issuecomment-1071136088)\u003e, or unsubscribe \u003chttps://github.com/notifications/unsubscribe-auth/AAINFWDKZ2X7GY7L4T3LU33VANU7RANCNFSM5G5DSI3A\u003e . Triage notifications on the go with GitHub Mobile for iOS \u003chttps://apps.apple.com/app/apple-store/id1477376905?ct=notification-email\u0026mt=8\u0026pt=524675\u003e or Android \u003chttps://play.google.com/store/apps/details?id=com.github.android\u0026referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub\u003e. You are receiving this because you were mentioned.Message ID: ***@***.***\u003e\r\n\r\nI cannot believe that this is working on Linux.\r\nLine 214 \"connection.SessionOptions.SecureSocketLayer = options.UseSsl;\" is not support on Linux. It throws an exception.\r\n\r\nAll in all, this is quite a mess. My code is fully working on windows but I cannot connect using port 636 on linux. If I use 389, I can connect, but I have to use the full distinguished name as username and all my other methods in my class fail (e.g. searching users, etc).\r\nAlso, I\u0027m missing a good example on how to setup a dockerfile which includes all dependencies which actually works.\r\nAny help would be aprreciated.\r\nbtw, I\u0027m using .net 7",
                                           "updatedAt":  "2023-03-24T17:19:27Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YdNzR",
                                           "createdAt":  "2023-03-26T10:23:19Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GeertvanHorrik",
                                           "body":  "On linux (simplified version):\r\n\r\n```\r\n// call invoke on setting environment variable if you need to disable ssl verification\r\n\r\nvar identifier = new LdapDirectoryIdentifier(\"your-host\", 636);\r\nvar networkCredential = new NetworkCredential(username, password, domain);\r\n\r\nvar connection = new LdapConnection(identifier, networkCredential, AuthType.Basic)\r\n{\r\n    AutoBind = false,\r\n};\r\n\r\nconnection.SessionOptions.ProtocolVersion = 3;\r\nconnection.SessionOptions.SecureSocketLayer = true;\r\n\r\nconnection.Bind();\r\n```",
                                           "updatedAt":  "2023-03-26T10:23:19Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YdN6O",
                                           "createdAt":  "2023-03-26T10:25:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "michiproep",
                                           "body":  "For setting securesocketlayer I get a \"not supported on this platform\" exception ",
                                           "updatedAt":  "2023-03-26T10:25:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YdOBQ",
                                           "createdAt":  "2023-03-26T10:28:28Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GeertvanHorrik",
                                           "body":  "Did you use the *exact* code provided (auto bind to false, etc)? It works fine here.",
                                           "updatedAt":  "2023-03-26T10:28:28Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YdPBL",
                                           "createdAt":  "2023-03-26T10:50:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "michiproep",
                                           "body":  "I\u0027ll send a Screenshot tomorrow ",
                                           "updatedAt":  "2023-03-26T10:50:22Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YdXoT",
                                           "createdAt":  "2023-03-26T13:16:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "michiproep",
                                           "body":  "@GeertvanHorrik \r\n![grafik](https://user-images.githubusercontent.com/12296115/227778206-5b609e89-46c2-4336-be18-e6f9528be5b9.png)\r\n\r\n\r\nThis is the corresponding docker file:\r\n\r\nFROM mcr.microsoft.com/dotnet/aspnet:7.0-alpine AS base\r\nWORKDIR /app\r\nRUN apk update \\\r\n    \u0026\u0026 apk add --upgrade libldap \\\r\n    \u0026\u0026 ln -s libldap.so.2 /usr/lib/libldap-2.4.so.2\r\nENV LDAPTLS_REQCERT=never\r\nEXPOSE 80\r\nEXPOSE 443",
                                           "updatedAt":  "2023-03-26T13:17:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5YdgDB",
                                           "createdAt":  "2023-03-26T15:18:16Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "GeertvanHorrik",
                                           "body":  "Just to make sure:\n\nAre you sure you are loading the correct runtime assemblies (Linux), not the reference ones from the nuget package?\n\nThe only difference I noticed in your example code is I am using net 6 jammy (Ubuntu) but that doesn\u0027t explain the difference in behavior.",
                                           "updatedAt":  "2023-03-26T15:18:16Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Ydj_E",
                                           "createdAt":  "2023-03-26T16:07:19Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "michiproep",
                                           "body":  "no. I\u0027m not sure.  how can I check? and which ones are the correct ones?",
                                           "updatedAt":  "2023-03-26T16:07:19Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Yds72",
                                           "createdAt":  "2023-03-26T18:31:13Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "michiproep",
                                           "body":  "Ok, this is a very confusing issue.\r\nI did reference \r\nSystem.DirectoryServices --version 7.0.1\r\nwhich actually includes the System.DirectoryServices.Protocols namespace.\r\nNow, I found that there is another package available: \r\nSystem.DirectoryServices.Protocols --version 7.0.0\r\n\r\nThis one seems to work! Thanks for the hint.\r\n\r\nBut still confused about these two packages...",
                                           "updatedAt":  "2023-03-26T18:31:13Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Yz3Bq",
                                           "createdAt":  "2023-03-30T09:31:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "wast",
                                           "body":  "This is working for me\r\n\r\n```cs\r\n// when using this constructor with servers, it doesn\u0027t work, it throws System.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable\r\n// var ldapDirectoryIdentifier = new LdapDirectoryIdentifier(_ldapSettings.Servers, _ldapSettings.Port, false, false); \r\n\r\nvar ldapDirectoryIdentifier = new LdapDirectoryIdentifier(_ldapSettings.Servers.First(), _ldapSettings.Port);\r\nusing var ldapConnection = new LdapConnection(ldapDirectoryIdentifier);\r\nvar credentials = new NetworkCredential(_ldapSettings.ServiceUsername, _ldapSettings.ServicePassword);\r\nldapConnection.SessionOptions.ProtocolVersion = 3;\r\nldapConnection.AuthType = AuthType.Basic;\r\nldapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\nldapConnection.SessionOptions.SecureSocketLayer = true;\r\n```\r\n\r\nAlso I added issuing and root certificates to certificates store in Dockerfile.",
                                           "updatedAt":  "2023-03-30T09:32:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ZFfTj",
                                           "createdAt":  "2023-04-03T16:14:31Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "YuriiSaichuk",
                                           "body":  "Hello everyone, I have the same problem as described in the title of the article. \r\nAt first I was getting the error \r\n\r\nSystem.DirectoryServices.Protocols.LdapException: The feature is not supported. \r\n   at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential new Credential, Boolean needSetCredential)\r\n\r\nBut after adding additional parameters to the connection, the error changed to \r\n\r\nThe LDAP server is unavailable.; Trace: at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n\r\nHere my code and config samples:\r\n\r\n\r\n\r\n`\r\n            LdapDirectoryIdentifier identifier = new LdapDirectoryIdentifier(Domain);\r\n            NetworkCredential credential = new NetworkCredential(Login, Password);\r\n            string filter = $\"(\u0026(objectCategory=person)(SAMAccountName={samName}))\";\r\n            string[] attributesToReturn = { \"SAMAccountName\", \"givenname\", \"sn\", \"mail\", \"userPassword\" };\r\n\r\n            SearchRequest searchRequest = new SearchRequest(SomeGroup, filter, SearchScope.Subtree, attributesToReturn);\r\n\r\n            try\r\n            {\r\n                using (LdapConnection connection = new LdapConnection(identifier, credential))\r\n                {\r\n                    connection.SessionOptions.ProtocolVersion = 3;\r\n                    connection.AuthType = AuthType.Basic;\r\n                    connection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\n                    connection.SessionOptions.SecureSocketLayer = true;\r\n                    connection.Bind();\r\n\r\n                    SearchResponse searchResponse = connection.SendRequest(searchRequest) as SearchResponse;\r\n\r\n                    return searchResponse.Entries.Count \u003e 0;\r\n                }\r\n            }\r\n`\r\n\r\nwhere \r\nSomeGroup  e.g. OU=Group,DC=example,DC=com\r\nLogin and Password  - credentials for group\r\n![image](https://user-images.githubusercontent.com/57576745/229560955-71a7c742-6b8c-4691-8df0-13b1bfd94329.png)\r\n\r\nand docker config sample \r\n![image](https://user-images.githubusercontent.com/57576745/229565025-e219e545-3482-4b43-85bc-492ff9cb661c.png)\r\n\r\nI may have configured the docker incorrectly (did not install the ldap client) or something else.\r\n\r\nThe test version of the program works correctly on Windows Server 2016 under IIS inside the domain controller. The version with the docker works on a different subnet connected via a CISCO router. The ldap server is pinged from the docker image.\r\n\r\nThe domain parameter for the test version is example.com. For the docker version, I tried different things, including the ldap server IP\r\n\"System.DirectoryServices.Protocols\" \"7.0.0\"\r\n\"System.DirectoryServices\" \"7.0.1\"\r\n\r\n",
                                           "updatedAt":  "2023-04-03T19:03:05Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ZFwOZ",
                                           "createdAt":  "2023-04-03T17:05:28Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "michiproep",
                                           "body":  "@YuriiSaichuk : The only thing which worked for me is completly removing System.DirectoryServices-Package and just keep the .protocols package.",
                                           "updatedAt":  "2023-04-03T17:05:28Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5bfH0C",
                                           "createdAt":  "2023-05-04T14:29:00Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "jhughesjha",
                                           "body":  "@joperezr\r\nWe are using the LdapConnection with LDAPS on Linux and need a way to validate the server certificate is the expected one per call. I know the VerifyServerCertificate is not supported due to the ldap option that it tries to set. Is there another way to validate the server certificate? Or do you recommend moving to another package for this use case?",
                                           "updatedAt":  "2023-05-04T14:29:00Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5bgMhY",
                                           "createdAt":  "2023-05-04T17:42:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "IIRC, in Linux the certificate is always validated automatically, the problem is that this is done by openldap layer which LdapConnection PInvokes into, but as you noted there is no hook (that I\u0027m aware of) into OpenLdap validation process in order to run custom code for additional validation. My best guess is that if that is what is desired here (running custom validation apart from the general validation of the server certificate) you\u0027d need to look into open ldap\u0027s documentation and see if there is something you can configure there.",
                                           "updatedAt":  "2023-05-04T17:42:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5jduBR",
                                           "createdAt":  "2023-08-08T00:19:33Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "CenturySparkle",
                                           "body":  "\u003e This is working for me\r\n\u003e \r\n\u003e ```cs\r\n\u003e // when using this constructor with servers, it doesn\u0027t work, it throws System.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable\r\n\u003e // var ldapDirectoryIdentifier = new LdapDirectoryIdentifier(_ldapSettings.Servers, _ldapSettings.Port, false, false); \r\n\u003e \r\n\u003e var ldapDirectoryIdentifier = new LdapDirectoryIdentifier(_ldapSettings.Servers.First(), _ldapSettings.Port);\r\n\u003e using var ldapConnection = new LdapConnection(ldapDirectoryIdentifier);\r\n\u003e var credentials = new NetworkCredential(_ldapSettings.ServiceUsername, _ldapSettings.ServicePassword);\r\n\u003e ldapConnection.SessionOptions.ProtocolVersion = 3;\r\n\u003e ldapConnection.AuthType = AuthType.Basic;\r\n\u003e ldapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\n\u003e ldapConnection.SessionOptions.SecureSocketLayer = true;\r\n\u003e ```\r\n\r\nOMG!  This saved my bacon.  This is working for me under .Net 7 running under the Ubuntu 22.04 container.  (I do have the certificates installed as well.)  It was setting the connection SessionOptions that got it working for me.\r\n\r\n",
                                           "updatedAt":  "2023-08-08T00:45:30Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5rgqgb",
                                           "createdAt":  "2023-11-09T12:17:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "Deepak260726",
                                           "body":  " LdapDirectoryIdentifier identifier = new LdapDirectoryIdentifier(\"ldap.example.com\", 389);\r\n NetworkCredential networkCredential = new NetworkCredential(username, userLoginparameter.Password);\r\n\r\n LdapConnection ldapConnection = new LdapConnection(identifier, networkCredential);\r\n\r\n if (Environment.OSVersion.Platform == PlatformID.Win32NT)\r\n {\r\n     ldapConnection.SessionOptions.VerifyServerCertificate = (ldapConnection, certificate) =\u003e true;\r\n }\r\n else if (!Environment.GetEnvironmentVariables().Contains(\"LDAPTLS_REQCERT\"))\r\n {\r\n     _logger.LogWarning(\"LDAPS certificate validation is disabled in config, but LDAPTLS_REQCERT environmental variable is not set. On non-Windows environments certificate validation must be disabled by setting environmental variable LDAPTLS_REQCERT to \u0027never\u0027\");\r\n }\r\n\r\n ldapConnection.Bind(networkCredential);\r\n \r\n \r\n i have tried all your opinion still getting the errors in Linux server but not in windows",
                                           "updatedAt":  "2023-11-09T12:17:44Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xAvuN",
                                           "createdAt":  "2024-01-17T15:15:06Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOEdU0tA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "jalexander-bb",
                                                                               "createdAt":  "2024-03-25T23:22:01Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "bbrauns",
                                                                               "createdAt":  "2024-07-22T13:26:48Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "zimbres",
                                                                               "createdAt":  "2024-07-25T03:51:34Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "haker93",
                                                                               "createdAt":  "2024-09-21T18:20:15Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "vicocz",
                                                                               "createdAt":  "2025-03-05T12:16:51Z"
                                                                           },
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "stefanopallicca-imagicle",
                                                                               "createdAt":  "2025-08-06T14:37:29Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  6
                                                         },
                                           "author":  "DanielHabenicht",
                                           "body":  "This error was driving me crazy. Although it manifested slightly differently. I got the following error, which I think is slightly worse as it directs you into a completely different direction: \r\n```\r\nSystem.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable.\r\nat System.DirectoryServices.Protocols.ErrorChecking.CheckAndSetLdapError(Int32 error)\r\nat System.DirectoryServices.Protocols.LdapSessionOptions.set_VerifyServerCertificate(VerifyServerCertificateCallback value)\r\n```\r\nOn `net8.0` (8.0.101) with the configuration `VerifyServerCertificate = (ldapConnection, certificate) =\u003e true` (for illustration in development) on Docker `mcr.microsoft.com/dotnet/aspnet:8.0` with installed `libldap-2.4-2_2.4.49`. \r\n\r\nWorkaround for me: \r\n1. Removing the `VerifyServerCertificate` Property. \r\n2. Adding `LDAPTLS_REQCERT=never` before starting the dotnet program in the docker container.\r\n\r\n",
                                           "updatedAt":  "2024-01-17T15:15:06Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc515wxe",
                                           "createdAt":  "2024-03-05T06:54:28Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "madetara",
                                           "body":  "To anyone stumbling upon this: the issue with SSL/TLS on Linux still persists even when you explicitly disable certificate verification (which I advise you to not do)\r\n\r\nI would suggest simply switching to [Novell LDAP client](https://github.com/dsbenghe/Novell.Directory.Ldap.NETStandard): it works on Linux and has better API",
                                           "updatedAt":  "2024-03-05T06:54:28Z"
                                       }
                                   ],
                         "totalCount":  47
                     },
        "title":  "LdapSessionOptions.VerifyServerCertificate is not supported in non-Windows and error message is not helpful.",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/63273",
        "createdAt":  "2022-01-03T04:42:25Z",
        "number":  63273,
        "author":  "arora-kushal",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-04-19T14:30:23Z",
        "body":  "I am using DirSync Control Cookie(https://docs.microsoft.com/en-us/windows/win32/ad/polling-for-changes-using-the-dirsync-control) to get the latest changes using the below technique. Is it possible to get that result with pagination ?\r\n\r\nExample: If 500 updates have happened, can i get updates from 1-50, or 51-100 (paging with skip) ?\r\n\r\nAccording to this very old article (https://docs.microsoft.com/en-us/archive/blogs/isrpfeplat/using-the-dirsync-control), it seems that it is not possible. If so, Do we have any workaround?\r\n\r\nAlternatively, Can I have some save point like functionality? Like If I get 800 records, and lets say I have processed 200 records and my code crashes. Then, can I get next 600 records only (not 800) using the same previous cookie?",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOQXc_QQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc471dKh",
                                           "createdAt":  "2022-01-03T04:42:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "I couldn\u0027t figure out the best area label to add to this issue. If you have write-permissions please help me learn by adding exactly one [area label](https://github.com/dotnet/runtime/blob/master/docs/area-owners.md).",
                                           "updatedAt":  "2022-01-03T04:42:29Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc471dQ9",
                                           "createdAt":  "2022-01-03T04:45:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "arora-kushal",
                                           "body":  "Tagging the area owners @buyaa-n @joperezr @steveharter @BRDPM @grubioe @jay98014",
                                           "updatedAt":  "2022-01-03T04:45:04Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc471dzb",
                                           "createdAt":  "2022-01-03T04:59:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\nI am using DirSync Control Cookie(https://docs.microsoft.com/en-us/windows/win32/ad/polling-for-changes-using-the-dirsync-control) to get the latest changes using the below technique. Is it possible to get that result with pagination ?\r\n\r\nExample: If 500 updates have happened, can i get updates from 1-50, or 51-100 (paging with skip) ?\r\n\r\nAccording to this very old article (https://docs.microsoft.com/en-us/archive/blogs/isrpfeplat/using-the-dirsync-control), it seems that it is not possible. If so, Do we have any workaround?\r\n\r\nAlternatively, Can I have some save point like functionality? Like If I get 800 records, and lets say I have processed 200 records and my code crashes. Then, can I get next 600 records only (not 800) using the same previous cookie?\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003earora-kushal\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2022-01-03T04:59:42Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc48VBvz",
                                           "createdAt":  "2022-01-13T13:38:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "vdailly",
                                           "body":  "Using the `DirSyncRequestControl` control it is unknown how many results would be returned by the search until. You have to loop indefinitely until the server return a `DirSyncResponseControl` control with `DirSyncResponseControl.MoreData == false`. The server can return 0 entries in a loop but the search is not yet done. The `DirSyncResponseControl` control returned by the server on each loop contains a `DirSyncResponseControl.Cookie` which is an opaque structure. Nevertheless the content of the cookie is very close of the replUpToDateVector attribute stored on the NC. It does contains replication information with most of the replication partner for this NC in the domain.\r\n`DirSyncRequestControl` and `PageResultRequestControl` works very differently. Under the hood `DirSyncRequestControl` calls the domain controller replication APIs.\r\n\r\nI wouldn\u0027t recommend to yield results or process them unless the complete search loop is done.\r\nThe purpose of a search with a `DirSyncRequestControl` is to obtain only latest changed records. Instead run the query frequently on a frequently updated domain controller to get minimal records to process in a row.\r\n\r\nSo to answer your questions:\r\n- If 500 updates have happened, can i get updates from 1-50, or 51-100 (paging with skip) ?\r\nNot really, unless you store the latest processed item. But you cannot guarantee that objects may be ordered the same on next query, especially if the connection connects to another domain controller.\r\nIn a full meshed Active Directory environnement the `DirSyncResponseControl.Cookie` value store replication information about all the domain controllers, so that you get only latest updated records whatever the domain controller you connect to.\r\nIn a non-full meshed Active Directory environnement, it is possible that the search start from scratch even while providing a Cookie value and so your saved index will be wrong.\r\n\r\n- Alternatively, Can I have some save point like functionality? Like If I get 800 records, and lets say I have processed 200 records and my code crashes. Then, can I get next 600 records only (not 800) using the same previous cookie?\r\nIf you get 800 records in a loop (among 2000 by example), and you process the 800, then you may use the intermediate `DirSyncResponseControl.Cookie` value returned by the server to get the remaining 1200. This should work.\r\nIf you fail to process the 800 records in a loop, then you must restart with the previous cookie to ensure data integrity.\r\n\r\nHere a very minimal example to search on a domain controller with a DirSyncRequestControl.\r\n```\r\nvar con = new LdapConnection(\"server\");\r\ncon.Bind();\r\n\r\nvar req = new SearchRequest();\r\nvar dirsync = new DirSyncRequestControl();\r\nreq.Controls.Add(dirsync);\r\n\r\nbool moredata = true;\r\nwhile(moredata) {\r\n    var res = (SearchResponse)con.Send(req);\r\n    dirsyncres = (DirSyncResponseControl)res.Controls[0]\r\n    dirsync.Cookie = dirsyncres.Cookie\r\n    moredata = dirsyncres.MoreData\r\n}\r\n```",
                                           "updatedAt":  "2022-01-13T13:38:57Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ALBxU",
                                           "createdAt":  "2022-03-23T17:46:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "@jay98014 @kumarravi do you mind taking a look at this one?",
                                           "updatedAt":  "2022-03-23T17:46:42Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5AOmE9",
                                           "createdAt":  "2022-03-24T12:19:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "kumarravi",
                                           "body":  "Hi Jose\n\nI am super stomped with work right now and am also working from India\ntemporarily. I am sorry I will not be able to look into it for at least a\nmonth. I can try after that.\n\nThanks and Regards\nRavi Kumar\n\nOn Wed, Mar 23, 2022 at 10:46 AM Jose Perez Rodriguez \u003c\n***@***.***\u003e wrote:\n\n\u003e @jay98014 \u003chttps://github.com/jay98014\u003e @kumarravi\n\u003e \u003chttps://github.com/kumarravi\u003e do you mind taking a look at this one?\n\u003e\n\u003e —\n\u003e Reply to this email directly, view it on GitHub\n\u003e \u003chttps://github.com/dotnet/runtime/issues/63273#issuecomment-1076632660\u003e,\n\u003e or unsubscribe\n\u003e \u003chttps://github.com/notifications/unsubscribe-auth/ABQNE64HGBMQSRB2SJKJ6ITVBNKIZANCNFSM5LEP2CQQ\u003e\n\u003e .\n\u003e You are receiving this because you were mentioned.Message ID:\n\u003e ***@***.***\u003e\n\u003e\n",
                                           "updatedAt":  "2022-03-24T12:19:14Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5AQSXH",
                                           "createdAt":  "2022-03-24T19:28:53Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "BRDPM",
                                           "body":  "Looping @Travis ***@***.***\u003e since this is ADFS space.\n\nTravis - not sure who is on point this month (maybe we should edit our invite to specify) but we should probably create an RFC for tracking this.\n\nFrom: Ravi Kumar ***@***.***\u003e\nSent: Thursday, March 24, 2022 5:19 AM\nTo: dotnet/runtime ***@***.***\u003e\nCc: Cliff Fisher ***@***.***\u003e; Mention ***@***.***\u003e\nSubject: Re: [dotnet/runtime] Can I combine DirSync Cookie with paging? Or some save-point functionality? (Issue #63273)\n\nHi Jose\n\nI am super stomped with work right now and am also working from India\ntemporarily. I am sorry I will not be able to look into it for at least a\nmonth. I can try after that.\n\nThanks and Regards\nRavi Kumar\n\nOn Wed, Mar 23, 2022 at 10:46 AM Jose Perez Rodriguez \u003c\n***@***.***\u003cmailto:***@***.***\u003e\u003e wrote:\n\n\u003e @jay98014 \u003chttps://github.com/jay98014\u003e @kumarravi\n\u003e \u003chttps://github.com/kumarravi\u003e do you mind taking a look at this one?\n\u003e\n\u003e -\n\u003e Reply to this email directly, view it on GitHub\n\u003e \u003chttps://github.com/dotnet/runtime/issues/63273#issuecomment-1076632660\u003e,\n\u003e or unsubscribe\n\u003e \u003chttps://github.com/notifications/unsubscribe-auth/ABQNE64HGBMQSRB2SJKJ6ITVBNKIZANCNFSM5LEP2CQQ\u003e\n\u003e .\n\u003e You are receiving this because you were mentioned.Message ID:\n\u003e ***@***.***\u003cmailto:***@***.***\u003e\u003e\n\u003e\n\n\n-\nReply to this email directly, view it on GitHub\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Fruntime%2Fissues%2F63273%23issuecomment-1077567805\u0026data=04%7C01%7CCliff.Fisher%40microsoft.com%7C7a76e3ca36a547cbe41008da0d908a34%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837211696442150%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=Apw184v0PSXAltFK8NTeCE41NmEU4nkoRtNvJRy0Xcs%3D\u0026reserved=0\u003e, or unsubscribe\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FAVUHGVZNKMYDANKAJJ3XXX3VBRMU5ANCNFSM5LEP2CQQ\u0026data=04%7C01%7CCliff.Fisher%40microsoft.com%7C7a76e3ca36a547cbe41008da0d908a34%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837211696442150%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=iASX%2B0NnTvnV7FdTvurk3lsxP1o3J1kAlwBAQY6lLAM%3D\u0026reserved=0\u003e.\nYou are receiving this because you were mentioned.Message ID: ***@***.******@***.***\u003e\u003e\n",
                                           "updatedAt":  "2022-03-24T19:28:53Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ARfQK",
                                           "createdAt":  "2022-03-24T21:11:52Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "BRDPM",
                                           "body":  "It looks like vdailly\u003chttps://github.com/vdailly\u003e provided a good response regarding available options on 1/13. Would it be possible to get elaboration on what add\u0027l information is required?\n\nThanks,\nTravis\n\n\nFrom: Cliff Fisher ***@***.***\u003e\nSent: Thursday, March 24, 2022 12:29 PM\nTo: dotnet/runtime ***@***.***\u003e; dotnet/runtime ***@***.***\u003e; Travis Collavo ***@***.***\u003e\nCc: Mention ***@***.***\u003e\nSubject: RE: [dotnet/runtime] Can I combine DirSync Cookie with paging? Or some save-point functionality? (Issue #63273)\n\nLooping @Travis ***@***.***\u003e since this is ADFS space.\n\nTravis - not sure who is on point this month (maybe we should edit our invite to specify) but we should probably create an RFC for tracking this.\n\nFrom: Ravi Kumar ***@***.******@***.***\u003e\u003e\nSent: Thursday, March 24, 2022 5:19 AM\nTo: dotnet/runtime ***@***.******@***.***\u003e\u003e\nCc: Cliff Fisher ***@***.******@***.***\u003e\u003e; Mention ***@***.******@***.***\u003e\u003e\nSubject: Re: [dotnet/runtime] Can I combine DirSync Cookie with paging? Or some save-point functionality? (Issue #63273)\n\nHi Jose\n\nI am super stomped with work right now and am also working from India\ntemporarily. I am sorry I will not be able to look into it for at least a\nmonth. I can try after that.\n\nThanks and Regards\nRavi Kumar\n\nOn Wed, Mar 23, 2022 at 10:46 AM Jose Perez Rodriguez \u003c\n***@***.***\u003cmailto:***@***.***\u003e\u003e wrote:\n\n\u003e @jay98014 \u003chttps://github.com/jay98014\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fjay98014\u0026data=04%7C01%7Ctcolla%40microsoft.com%7C66a1311186b046802e1b08da0dcc83d9%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837469275552470%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=9uNAWboz6fffz4J%2BpYlRIs7CGRoTrrBBwrlkMnUAL%2B4%3D\u0026reserved=0\u003e\u003e @kumarravi\n\u003e \u003chttps://github.com/kumarravi\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fkumarravi\u0026data=04%7C01%7Ctcolla%40microsoft.com%7C66a1311186b046802e1b08da0dcc83d9%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837469275552470%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=2lTpCGk%2F1xSk1ZLx%2FAw%2FfaHvuQW0x4VdJXp5DdH6Y0s%3D\u0026reserved=0\u003e\u003e do you mind taking a look at this one?\n\u003e\n\u003e -\n\u003e Reply to this email directly, view it on GitHub\n\u003e \u003chttps://github.com/dotnet/runtime/issues/63273#issuecomment-1076632660\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Fruntime%2Fissues%2F63273%23issuecomment-1076632660\u0026data=04%7C01%7Ctcolla%40microsoft.com%7C66a1311186b046802e1b08da0dcc83d9%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837469275552470%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=%2F2K2NM1PZ9HqtJuioLSwo%2B5ERrW7NL3OqVmvLQcfTmQ%3D\u0026reserved=0\u003e\u003e,\n\u003e or unsubscribe\n\u003e \u003chttps://github.com/notifications/unsubscribe-auth/ABQNE64HGBMQSRB2SJKJ6ITVBNKIZANCNFSM5LEP2CQQ\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FABQNE64HGBMQSRB2SJKJ6ITVBNKIZANCNFSM5LEP2CQQ\u0026data=04%7C01%7Ctcolla%40microsoft.com%7C66a1311186b046802e1b08da0dcc83d9%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837469275602481%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=9O74XtffGDtvlzA4PXdD8CZo%2Bb%2BoLEDSrUHm3b7Y3MU%3D\u0026reserved=0\u003e\u003e\n\u003e .\n\u003e You are receiving this because you were mentioned.Message ID:\n\u003e ***@***.***\u003cmailto:***@***.***\u003e\u003e\n\u003e\n\n-\nReply to this email directly, view it on GitHub\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Fruntime%2Fissues%2F63273%23issuecomment-1077567805\u0026data=04%7C01%7Ctcolla%40microsoft.com%7C66a1311186b046802e1b08da0dcc83d9%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837469275602481%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=rQ4Sjx753ZkZfkGTUGT3E03bBusVH5dQkk0M3%2BIDsJY%3D\u0026reserved=0\u003e, or unsubscribe\u003chttps://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FAVUHGVZNKMYDANKAJJ3XXX3VBRMU5ANCNFSM5LEP2CQQ\u0026data=04%7C01%7Ctcolla%40microsoft.com%7C66a1311186b046802e1b08da0dcc83d9%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637837469275602481%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000\u0026sdata=FkTGCnZlzS1BxBFfI47TnOILQ4zLcHhnmbPaAI9UcO8%3D\u0026reserved=0\u003e.\nYou are receiving this because you were mentioned.Message ID: ***@***.******@***.***\u003e\u003e\n",
                                           "updatedAt":  "2022-03-24T21:11:52Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Ay41X",
                                           "createdAt":  "2022-04-04T03:55:26Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "arora-kushal",
                                           "body":  "Hi @BRDPM , @vdailly indeed provided very good explaination on whatever is available.\r\n\r\nI am here requesting to provide additional functionality which is not supported yet. \r\n\r\n1. Paging with skip functionality. As per the comment it looks like in order to achieve this items should always be returned in exact same order. Always.\r\n2. Currently, DirSync Cookie is a opaque structure. Can we somehow build our own Dirsync cookie with information like (old DirSync cookie (or some static info) + new timestamp) ?",
                                           "updatedAt":  "2022-04-04T03:55:26Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Bdz9B",
                                           "createdAt":  "2022-04-13T18:01:19Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "vdailly",
                                           "body":  "The cookie is your **timestamp**. It is a point in time about the last time you performed `DirSync` search against a specific domain controller (and its associated highest USN at the time of your request). Additionnaly, the cookie contains information about the current domain controller replication partners.\r\nEach time you perform the request, you need to backup the cookie in a file or anywhere you want. You can serialize/deserialize as base64 string if you want.\r\n```\r\nbyte[] cookie = LoadFromFileOrAnywhere();\r\nvar dirsync = new DirSyncRequestControl(cookie);\r\n```\r\n[DirSync](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/2213a7f2-0a36-483c-b2a4-8574d53aa1e3) searches are bound to a Naming Context, you cannot start your search anywhere in the tree (unlike with `PageResultRequestControl`), and generally speaking requires the `Replicate Directory Changes` right granted on the NC (unless you use the option `DirectorySynchronizationOptions.ObjectSecurity` on the control). \r\n\r\nImagine 2 domains controllers `DC A` and `DC B`, with `DC A` having the `highestCommittedUSN`: 12458  (this is an attribute of the RootDSE). \r\n```\r\nExpanding base \u0027DC=domain,DC=local\u0027...\r\nGetting 1 entries:\r\nDn: DC=domain,DC=local\r\n...\r\nreplUpToDateVector: dwVersion: 2, dwReserved1: 0, V2.cNumCursors: 1, V2.dwReserved2: 0, rgCursors: \r\n\t{uuidDsa: 12ebc578-aa4c-4d2c-a986-c5606b85db9, usnHighPropUpdate: 589654, timeLastSyncSuccess: 04/15/2020 13:42:06}, \r\n...\r\n```\r\n\r\n`cNumCursors` represent the number of replication partners (available, shutdown or even not existing anymore), and `rgCursors` the list of each replication partner.\r\nWhen the first DirSync request is performed on `DC A`, then the last `Cookie` returned by the server will contain:\r\n- `DC A` TimeStamp: 13/04/2022 14:05:20 highestCommittedUSN: 12458\r\n- the `replUpToDateVector` of `DC A` containing the most up to date value known for `DC B` commited on `DC A`.\r\n\r\nYou can refer to [Microsoft documentation on the DirSync pseudo-code](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/0e61ce24-eac7-40d1-a014-37854e932b43) to get more detailed information. Even with that some details are not well documented.\r\n\r\nThe next time you perform the search you must provide the saved `Cookie` to the `DirSyncRequestControl`, everything depends on which domain controller you connect:\r\n- if the next search you perform is against `DC A`, then `DC A` will return all changed entries since the last highestCommittedUSN: 12458. If highestCommittedUSN is now 12558, then there is **100 attribute updates** on `DC A`.\r\n- if the next search you perform is against `DC B`, then `DC B` will use the `replUpToDateVector` of `DC A` to get the `usnHighPropUpdate` value of itself `DC B`, so that `DC B` (which has now a `highestCommittedUSN` of 589664) will return only 10 attributes updates. These updates may be some updates that you already received initially from `DC A` that `DC B` is replicating and commiting.\r\n\r\nThe mechanism ensure that you don\u0027t miss any update. But this doesn\u0027t mean you may not see some updates multiple times, especially when connecting to alternate domain controllers very frequently.\r\n\r\nYou can code something equivalent using `highestCommittedUSN` and `uSNCreated` / `uSNChanged` attributes on objects and using the basic `PageResultRequestControl`. Anyway you may need to include the `ShowDeletedControl` if you want to detect deleted objects. `PageResultRequestControl` returns only \"living\" objects while `DirSyncRequestControl` include also most recent deleted objects. And you may parse yourself `replUpToDateVector` if you want failover with replication partners. But using this strategy you don\u0027t know which attributes have changed exactly on an object. You get only the complete object (all requested attributes) unless you dig into attributes metadata `replPropertyMetaData`. But `replPropertyMetaData` is a constructed attribute you can request only with a `Base` search scope, meaning for each object returned by a `PageResultRequestControl` search you would need to search again using the base scope (with no guarantee the object hasn\u0027t been moved or deleted in between).  That\u0027s where the DirSync control is much more powerful but it may not be appropriate for each use case.\r\n\r\nFor some cases, the not well known [DirSyncEx control](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/a568cbbe-5082-45ca-9427-0a6793646b89) available with from Windows Server 2012 instructs the search to include **always** some desired attributes. By default, only the `DistinguishedName` and the `objectguid` attribute are returned. When requesting some attributes, you can add the suffix `;dirSyncAlwaysReturn`. By example `objectclass;dirSyncAlwaysReturn` would always return the `objectclass` attribute, which may be desired. In a classical `DirSync` search, the `objectclass` is returned only the first time (first request or newly created object on subsequent searches) because it does never change (unless adding some auxiliary class to the object by example ...).\r\n\r\nForward-Linked attributes (like `member` attribute  on `groups`) have their own subtilities, depending the usage of the option `DirectorySynchronizationOptions.IncrementalValues`. The forwrd link attribute is not returned as the requested `member` but with a suffix `member;range=0-0` and `member;range=1-1` or something like that in the attribute name. Few information is available but match the [LinkStamp function](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/85075a8f-f8a8-48d3-90e6-33ca806e31a7). But `attribute;range=0-0` are the deleted values and `attribute;range=1-1` the added values. This is especially useful if you handle very large groups that are updated frequently.\r\n\r\nIn any case, while powerful I would reserve the `DirSync` control to very large directories or advanced use cases.",
                                           "updatedAt":  "2022-04-19T14:30:23Z"
                                       }
                                   ],
                         "totalCount":  10
                     },
        "title":  "Can I combine DirSync Cookie with paging? Or some save-point functionality?",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/66945",
        "createdAt":  "2022-03-21T14:05:06Z",
        "number":  66945,
        "author":  "pollymykh",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC2VT4Q==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "JayVDZ",
                                            "createdAt":  "2024-03-06T08:29:39Z"
                                        }
                                    ],
                          "totalCount":  1
                      },
        "updatedAt":  "2025-07-09T18:49:58Z",
        "body":  "### Description\r\n\r\nWe have a simple LDAP connector in our app that currently works with System.DirectoryServices.Protocols 5.0.0 nuget package.\r\nTo use SSL/TLS features I\u0027m trying to upgrade in to package 6.0.0 and higher, but when I do that I find that it\u0027s not possible to connect using Ntlm or Kerberos AuthType anymore and those are what our clients mostly use.\r\n\r\n### Reproduction Steps\r\n\r\nApp is netcore3.1.\r\nThe connection code looks like this\r\n\r\n`\t\t\t\t_ldapConnection = new LdapConnection(_ldapServer) {\r\n\t\t\t\t\tAuthType = authType\r\n\t\t\t\t};\r\n\t\t\t\t_ldapConnection.SessionOptions.ProtocolVersion = 3;\r\n\t\t\t\tif (IsWindows()) {\r\n\t\t\t\t\t_ldapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\n\t\t\t\t}\r\n\t\t\t\tif (useSsl) {\r\n\t\t\t\t\t_ldapConnection.SessionOptions.SecureSocketLayer = true;\r\n\t\t\t\t\tif (IsWindows()) {\r\n\t\t\t\t\t\t_ldapConnection.SessionOptions.VerifyServerCertificate = new VerifyServerCertificateCallback(VerifyServerCertificate);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar credentials = new NetworkCredential(_ldapServerLogin, _ldapServerPassword, keyDistributionCenter ?? string.Empty);\r\n\t\t\t\t_ldapConnection.Bind(credentials);`\r\n\r\nThe only thing I change is nuget package version from 5.0.0 to 6.0.0.\r\n\r\n### Expected behavior\r\n\r\nSuccessful bind when AuthType is Ntlm or Kerberos and app runs on Windows or Linux\r\n\r\n### Actual behavior\r\n\r\nSuccessful bind on Windows, but on Linux I get the following errors\r\nNtlm: Error code AuthUnknown (86) (System.DirectoryServices.Protocols.LdapException: An unknown authentication error occurred.)\r\nKerberos: Error code NotSupported (92) (System.DirectoryServices.Protocols.LdapException: The feature is not supported.)\r\n\r\n### Regression?\r\n\r\nWorks with System.DirectoryServices.Protocols 5.0.0 nuget package on both Windows and Linux\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Configuration\r\n\r\n_No response_\r\n\r\n### Other information\r\n\r\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOtgM22A==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5AAwQ5",
                                           "createdAt":  "2022-03-21T14:05:11Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nWe have a simple LDAP connector in our app that currently works with System.DirectoryServices.Protocols 5.0.0 nuget package.\r\nTo use SSL/TLS features I\u0027m trying to upgrade in to package 6.0.0 and higher, but when I do that I find that it\u0027s not possible to connect using Ntlm or Kerberos AuthType anymore and those are what our clients mostly use.\n\n### Reproduction Steps\n\nApp is netcore3.1.\r\nThe connection code looks like this\r\n\r\n`\t\t\t\t_ldapConnection = new LdapConnection(_ldapServer) {\r\n\t\t\t\t\tAuthType = authType\r\n\t\t\t\t};\r\n\t\t\t\t_ldapConnection.SessionOptions.ProtocolVersion = 3;\r\n\t\t\t\tif (IsWindows()) {\r\n\t\t\t\t\t_ldapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\n\t\t\t\t}\r\n\t\t\t\tif (useSsl) {\r\n\t\t\t\t\t_ldapConnection.SessionOptions.SecureSocketLayer = true;\r\n\t\t\t\t\tif (IsWindows()) {\r\n\t\t\t\t\t\t_ldapConnection.SessionOptions.VerifyServerCertificate = new VerifyServerCertificateCallback(VerifyServerCertificate);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar credentials = new NetworkCredential(_ldapServerLogin, _ldapServerPassword, keyDistributionCenter ?? string.Empty);\r\n\t\t\t\t_ldapConnection.Bind(credentials);`\r\n\r\nThe only thing I change is nuget package version from 5.0.0 to 6.0.0.\n\n### Expected behavior\n\nSuccessful bind when AuthType is Ntlm or Kerberos and app runs on Windows or Linux\n\n### Actual behavior\n\nSuccessful bind on Windows, but on Linux I get the following errors\r\nNtlm: Error code AuthUnknown (86)\r\nKerberos: Error code NotSupported (92)\n\n### Regression?\n\nWorks with System.DirectoryServices.Protocols 5.0.0 nuget package on both Windows and Linux\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003epollymykh\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2022-03-21T14:05:11Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ABEvx",
                                           "createdAt":  "2022-03-21T15:13:11Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "filipnavara",
                                           "body":  "Did you test both of the .NET versions on the same machine against the same server? Is the gss-ntlmssp package installed on the machine?",
                                           "updatedAt":  "2022-03-21T15:13:11Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ABgFt",
                                           "createdAt":  "2022-03-21T16:37:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "pollymykh",
                                           "body":  "@filipnavara yes, same machine to run app, same AD server, same credentials, same codebase except the indicated nuget package version.\r\ngss-ntlmssp isn\u0027t installed on the machine I run my app on, should it be?",
                                           "updatedAt":  "2022-03-21T16:37:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ABiVa",
                                           "createdAt":  "2022-03-21T16:47:35Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "filipnavara",
                                           "body":  "I believe @iinuwa may have some insight about what is going on but I am not particularly familiar with LDAP.\r\n\r\nThe error message look like something returned by GSSAPI library (the one that is responsible for Kerberos, NTLM and Negotiate authentication). Specifically, the Linux GSSAPI implementation is provided with the `krb5` package and the `gss-ntlmssp` optional package. The `AuthUnknown` error code is something that I would expect if `krb5` was intalled and `gss-ntlmssp` was not installed.\r\n\r\nHowever, I cannot find any explanation for the fact that it works with older version of the System.DirectoryServices.Protocols package. Majority of the fixes in that library after version 5.0.0 focused on unrelated bug fixes (TLS, referral chasing options). While it could be some unintentional side effect I cannot see any change that would be directly related.",
                                           "updatedAt":  "2022-03-21T16:47:35Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ABmbq",
                                           "createdAt":  "2022-03-21T16:59:47Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "filipnavara",
                                           "body":  "The only change that touched the code, as far as I can see, is https://github.com/dotnet/runtime/pull/52904.",
                                           "updatedAt":  "2022-03-21T16:59:47Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ABo0b",
                                           "createdAt":  "2022-03-21T17:08:33Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODLVOow==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "HEART",
                                                                               "user":  "jitkahubnerova",
                                                                               "createdAt":  "2023-10-30T12:39:51Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "filipnavara",
                                           "body":  "My suspicion is that the authentication type may have inadvertently been ignored in version 5.0.0 (on Linux) and it silently proceeded with Basic authentication. Would it be possible to run Wireshark traces for both package versions? (assuming that it may fail early for 6.0.0 and not produce anything useful)",
                                           "updatedAt":  "2022-03-21T17:09:37Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ACutZ",
                                           "createdAt":  "2022-03-21T21:52:11Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODwS2JA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "EYES",
                                                                               "user":  "t00",
                                                                               "createdAt":  "2023-02-22T15:57:06Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "menees",
                                                                               "createdAt":  "2024-08-29T19:57:23Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  2
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Hello @pollymykh thank you for logging the issue, and thanks @filipnavara for the initial triage. Seems like you are using credentials to login, and in such case, you aren\u0027t really doing `Kerberos` authentication. If you take a look at [this comment](https://github.com/dotnet/runtime/issues/54274#issuecomment-882308535) on an issue that was logged right after 5.0 release, we discovered that in the 5.0.0 package setting `AuthType` to a value like `Kerberos` would basically be incorrectly discarded if you provided credentials, since we were silently falling back to `Basic`. I suspect this is why if you use 5.0.0 NuGet package it \"works\" (quoted since you aren\u0027t really doing Kerberos auth, we are silently falling back to basic auth instead.), but in 6.0.0 it doesn\u0027t. This is because after figuring out we had this problem, we now fail if you try to use `Kerberos` auth in 6.0 (and also in package 5.0.1 BTW) and provided credentials.\r\n\r\nIn Linux, we currently only support two types of authentication:\r\n- AuthType.Basic = You use credentials to authenticate. This is NOT the default value, so you do need to change your code and specifically set your AuthType to basic when using credentials. You can decide to use this over SSL or TLS so that credentials are encrypted when the connection happens.\r\n- AuthType.Negotiate = You don\u0027t provide credentials to authenticate, and you are running on a machine/user that is domain-joined (AD-joined) to the LDAP server. In this case, we use the underlying GSSAPI libs to authenticate using the machine/user existing kerberos token.\r\n\r\nAll of the rest of the Authentication types are currently not supported  in Linux. We do plan to add support for them, but haven\u0027t planned that work for a milestone yet.",
                                           "updatedAt":  "2022-03-21T21:52:11Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ACvXS",
                                           "createdAt":  "2022-03-21T21:56:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "\u003e My suspicion is that the authentication type may have inadvertently been ignored in version 5.0.0 (on Linux) and it silently proceeded with Basic authentication.\r\n\r\n@filipnavara this is almost 100% sure what is going on. If you take a look at 5.0 branch, you can see under a feature flag what our code (incorrectly) used to do:\r\n\r\nhttps://github.com/dotnet/runtime/blob/c7a22f1d9d7fa40464d888f2438f78af0b200ef2/src/libraries/System.DirectoryServices.Protocols/src/System/DirectoryServices/Protocols/ldap/LdapConnection.Linux.cs#L28-L38\r\n\r\nWe provided that feature flag only because this was a breaking change we made in 5.0.1 to fix this incorrect behavior we had in 5.0.0, so the feature flag allowed code to continue working in case they depended on the 5.0.0 behavior. If you see what we used to do, is basically that if credentials were used, then no matter which AuthType you had selected, we would always fallback to a simple bind (meaning AuthType.Basic)",
                                           "updatedAt":  "2022-03-21T21:56:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ACxy-",
                                           "createdAt":  "2022-03-21T22:10:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCT9aLw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "joperezr",
                                                                               "createdAt":  "2022-03-21T23:02:07Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "filipnavara",
                                           "body":  "\u003e and also in package 5.0.1 BTW\r\n\r\nThat explains why I missed the change. I always look at the tip of the servicing branches. 😅",
                                           "updatedAt":  "2022-03-21T22:10:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5AEXCV",
                                           "createdAt":  "2022-03-22T08:41:10Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "pollymykh",
                                           "body":  "@joperezr thank you for clarification. It seems like we have little choice now but to use Basic explicitly (since we\u0027re actually already using it with 5.0.0 logic). Does this behavior (switching to Basic when using credentials) only apply to Linux?",
                                           "updatedAt":  "2022-03-22T08:41:10Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5AGm18",
                                           "createdAt":  "2022-03-22T18:20:33Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODLVOjA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "pollymykh",
                                                                               "createdAt":  "2022-03-22T20:47:35Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "filipnavara",
                                                                               "createdAt":  "2022-03-22T20:59:12Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "jitkahubnerova",
                                                                               "createdAt":  "2023-10-30T12:39:38Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Yes it only applies to Linux. If your Linux box is already domain-joined to your LDAP server and have a valid kerberos ticket for it, then you should be able to use that as well if you don\u0027t want to use credentials. Otherwise, yes, the choice would be to use Basic auth and if your LDAP server supports it, then using setting SSL or TLS options to true before calling Bind in order to encrypt the communication before passing your credentials to authenticate.",
                                           "updatedAt":  "2022-03-22T18:20:33Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5sUm4y",
                                           "createdAt":  "2023-11-18T03:00:40Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "jmhickman",
                                           "body":  "@joperezr Is the request to support other `AuthType`s being tracked anywhere? My use-case is such that the user is on a non-domain joined machine, but has their username and password. It\u0027s (rather) unlikely that they would know their full DN for the account, making using the `AuthType.Basic` kind of a no-go for me. From my testing on Windows, it seems like `AuthType.Ntlm` would allow the workflow I\u0027m aiming for. \r\n\r\nUnless there\u0027s a programmatic way to retrieve the user\u0027s DN before connecting to the directory...but that seems like a chicken and egg problem.",
                                           "updatedAt":  "2023-11-18T03:03:10Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5s_qtL",
                                           "createdAt":  "2023-11-27T21:17:17Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "I can\u0027t find an issue for it from a quick search, so we can either create one for that or we can just re-use this one to track this (which is doing it specifically for Ntlm and Kerberos.)\r\n",
                                           "updatedAt":  "2023-11-27T21:17:17Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5tRA8e",
                                           "createdAt":  "2023-11-30T06:22:28Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "corsiva",
                                           "body":  "hi @joperezr,\r\nWhat do you think about issue #82430?\r\n\r\nBR,",
                                           "updatedAt":  "2023-11-30T06:22:28Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5tWlI7",
                                           "createdAt":  "2023-11-30T22:05:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODOHlOA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "corsiva",
                                                                               "createdAt":  "2023-12-01T00:30:33Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Hi @corsiva, unfortunately I\u0027m no longer focusing on System.DirectoryServices.* libraries, but looks like my colleagues who now own this are already engaged in that issue with you 😃 ",
                                           "updatedAt":  "2023-11-30T22:05:03Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5wWuIR",
                                           "createdAt":  "2024-01-10T14:55:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "nhart12",
                                           "body":  "```\r\nusing LdapConnection conn = new(new LdapDirectoryIdentifier(hostname, 636));\r\nconn.AuthType = AuthType.Negotiate;\r\nconn.SessionOptions.SecureSocketLayer = true;\r\nconn.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\nconn.Bind();\r\n```\r\nIs there any updates on this or any tips to help troubleshoot? I\u0027m trying to do an ldap search in an ubuntu container using kuberos. The above code is giving me the same \"The feature is not supported\" error when attempting the Bind. ",
                                           "updatedAt":  "2024-01-10T14:55:44Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5wXEn-",
                                           "createdAt":  "2024-01-10T15:39:17Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Hello, The main AuthType supported in Linux is AuthType.Basic which will also need you to pass in credentials. Are you trying to reuse a connection on a system that is already domain joined?",
                                           "updatedAt":  "2024-01-10T15:39:17Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5wXUV9",
                                           "createdAt":  "2024-01-10T16:13:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "nhart12",
                                           "body":  "Yes, I have a container that is doing kuberos auth to sql server (running kinit in a sidecar).. I was hoping I\u0027d be able to piggy back on that to do ldap searches also so I don\u0027t need to mount a keytab as well as pass in the credentials",
                                           "updatedAt":  "2024-01-10T16:13:42Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xTTei",
                                           "createdAt":  "2024-01-19T18:19:07Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "nhart12",
                                           "body":  "@joperezr  are you saying AuthType.Negotiate is no longer a supported use-case in linux?",
                                           "updatedAt":  "2024-01-19T18:19:07Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xUN6O",
                                           "createdAt":  "2024-01-19T21:15:51Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "It is supported, but only in the scenario where you are domain joined. Note that having run kinit is likely not enough, as that doesn\u0027t mean your machine is truly domain-joined and instead you may just be authenticated. My suggestion would be for you to try to run the ldapsearch linux utilities without passing in your credentials, and seeing if you are able to do that. Main reason why I ask is because the PInvokes we make in Linux for a Sasl bind is very similar to the one that those command line utilities do, so I would expect those won\u0027t work either. We unfortunately don\u0027t have good error messages for these issues, so another advantage from running those commands is that turning on the verbose output may give you more information on what is wrong with your configuration.",
                                           "updatedAt":  "2024-01-19T21:15:51Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xUPkN",
                                           "createdAt":  "2024-01-19T21:22:02Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "nhart12",
                                           "body":  "makes sense, thank you!",
                                           "updatedAt":  "2024-01-19T21:22:02Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xUivx",
                                           "createdAt":  "2024-01-19T22:22:26Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "iinuwa",
                                           "body":  "FWIW, `ldapsearch` does work with `kinit` on non-domain joined Linux computers.",
                                           "updatedAt":  "2024-01-19T22:22:26Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc52CZ6s",
                                           "createdAt":  "2024-03-06T08:37:24Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "JayVDZ",
                                           "body":  "I too need NTLM/Kerberos support as well under Linux.\r\nOddly, I did have it working, but seemingly without changing anything, it\u0027s stopped working. Clearly I\u0027m going mad.\r\n\r\nScenario:\r\n- Home computer, so Win11 non-domain joined\r\n- Docker Compose .NET 6.0 Blazor Server app\r\n- mcr.microsoft.com/dotnet/aspnet:6.0 base image\r\n- Passing in JaysPC\\serviceaccount and password as credential\r\n- AuthMode.NTLM set\r\n- Bind\r\n\r\nDockerfile has some packages added:\r\n```\r\nRUN apt-get update \\\r\n    \u0026\u0026 apt-get install -y libldap-2.4-2\r\n```\r\n\r\nFor a week or so this worked, but now just get the following exception:\r\n\r\n```\r\nSystem.DirectoryServices.Protocols.LdapException\r\n  HResult=0x80131500\r\n  Message=An unknown authentication error occurred.\r\n  Source=System.DirectoryServices.Protocols\r\n  StackTrace:\r\n   at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\r\n```\r\n\r\nI\u0027m using a Windows credential instead of an application partition one as I need to read the schema partition. I don\u0027t think you can do that using an application partition credential (so DN format). I have tried.\r\n\r\nAny help from MS/others appreciated.",
                                           "updatedAt":  "2024-03-06T08:37:24Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc56KEuf",
                                           "createdAt":  "2024-04-11T11:18:01Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "johnm123",
                                           "body":  "Hi,\r\n\r\nI\u0027ve hoping to use the DirectoryServices.Protocols (8.0.0) package on a Linux host to integrate with an LDAP server using Kerberos authentication. In earlier post by @joperezr, it appears that Basic and Negotiate are supported. Does this mean, by extension, that Kerberos is supported? Apologies as this appears to have been discussed, but the original discussion is regarding earlier versions and am wondering what the official line is now. \r\n\r\nI\u0027ve also been developing locally using this package on a MacOS machine. Basic authenication works fine but as soon as I use either a Negotiate or Kerberos AuthType to connect I get \"LdapException: The feature is not supported.\". Should the story for MacOS be the same as for Linux? I\u0027ve noticed another [post](https://github.com/dotnet/aspnetcore/issues/40025#issuecomment-1031248583) (in a slightly different context) suggesting this error message may be misleading.\r\n\r\nAny clarification would be much appreciated.\r\n",
                                           "updatedAt":  "2024-04-11T11:18:01Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6IEVmq",
                                           "createdAt":  "2024-08-11T17:52:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "jmhickman",
                                           "body":  "Hoping for some movement on this. I\u0027d like to make my tooling multi-platform by using S.DS.P, but I need to use the NTLM auth workflow. 🙏",
                                           "updatedAt":  "2024-08-11T17:52:37Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6TJAPw",
                                           "createdAt":  "2024-11-11T16:45:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "careless6666",
                                           "body":  "Maybe this will help, there is an implementation of the same problem on go\nhttps://github.com/go-ldap/ldap/pull/449/files",
                                           "updatedAt":  "2024-11-11T16:45:42Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc62AzbY",
                                           "createdAt":  "2025-07-09T18:49:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "StidOfficial",
                                           "body":  "The implementation of OpenLdap in the runtime worked with Kerberos for LDAP and LDAPS with Active Directory.\n\nGenerally speaking, you can use `ldapsearch` to have much useful informations for the debugging.\n\nIf you have the error `The LDAP server is unavailable` with LDAPS and `SessionOptions.ProtocolVersion = 3`, you may need to add `SASL_SECPROPS minssf=0,maxssf=0` in `/etc/openldap/ldap.conf`.\n\n\u003e ```\n\u003e using LdapConnection conn = new(new LdapDirectoryIdentifier(hostname, 636));\n\u003e conn.AuthType = AuthType.Negotiate;\n\u003e conn.SessionOptions.SecureSocketLayer = true;\n\u003e conn.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\n\u003e conn.Bind();\n\u003e ```\n\u003e \n\u003e Is there any updates on this or any tips to help troubleshoot? I\u0027m trying to do an ldap search in an ubuntu container using kuberos. The above code is giving me the same \"The feature is not supported\" error when attempting the Bind.\n\nYou probably need to set `conn.SessionOptions.ProtocolVersion = 3;`, bytheway `Auth.Negotiate` is by default with `LdapConnection`.\n\n\u003e I too need NTLM/Kerberos support as well under Linux. Oddly, I did have it working, but seemingly without changing anything, it\u0027s stopped working. Clearly I\u0027m going mad.\n\u003e \n\u003e Scenario:\n\u003e \n\u003e     * Home computer, so Win11 non-domain joined\n\u003e \n\u003e     * Docker Compose .NET 6.0 Blazor Server app\n\u003e \n\u003e     * mcr.microsoft.com/dotnet/aspnet:6.0 base image\n\u003e \n\u003e     * Passing in JaysPC\\serviceaccount and password as credential\n\u003e \n\u003e     * AuthMode.NTLM set\n\u003e \n\u003e     * Bind\n\u003e \n\u003e \n\u003e Dockerfile has some packages added:\n\u003e \n\u003e ```\n\u003e RUN apt-get update \\\n\u003e     \u0026\u0026 apt-get install -y libldap-2.4-2\n\u003e ```\n\u003e \n\u003e For a week or so this worked, but now just get the following exception:\n\u003e \n\u003e ```\n\u003e System.DirectoryServices.Protocols.LdapException\n\u003e   HResult=0x80131500\n\u003e   Message=An unknown authentication error occurred.\n\u003e   Source=System.DirectoryServices.Protocols\n\u003e   StackTrace:\n\u003e    at System.DirectoryServices.Protocols.LdapConnection.BindHelper(NetworkCredential newCredential, Boolean needSetCredential)\n\u003e ```\n\u003e \n\u003e I\u0027m using a Windows credential instead of an application partition one as I need to read the schema partition. I don\u0027t think you can do that using an application partition credential (so DN format). I have tried.\n\u003e \n\u003e Any help from MS/others appreciated.\n\nThis is due to missing GSSAPI package (`libsasl2-2` or `cyrus-sasl-gssapi`).\n",
                                           "updatedAt":  "2025-07-09T18:49:58Z"
                                       }
                                   ],
                         "totalCount":  27
                     },
        "title":  "System.DirectoryServices.Protocols LdapConnection doesn\u0027t work with Ntlm and Kerberos on Linux",
        "labels":  [
                       "enhancement",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/70559",
        "createdAt":  "2022-06-10T13:30:59Z",
        "number":  70559,
        "author":  "bzuidgeest",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2022-06-29T16:48:12Z",
        "body":  "### Background and motivation\n\nDirectoryEntry has an nice Exist function to check if an object exists in the directory. However this function does not allow for supplying credentials or authenticationtype. So this only works for when the application is in the same domain or an trusted domain for application identity. For applications that connect to a random directory at command, this make this function useless.\r\n\r\nLooking at the code. It create an directryentry for the supplied path and then calls bind. and check Bound. Unfortunately both Bound and Bind are private functions, so I cannot make equivalent code myself easily. (I suppose one could use reflection)\r\n\r\nOnce an overload to the existing exists is added one could check existence of objects in any directory not just forest local ones\n\n### API Proposal\n\n```csharp\r\nnamespace System.Collections.Generic;\r\n\r\npublic class DirectoryEntry\r\n{\r\n    public static bool Exists(string path, string username, string password, AuthenticationType authenticationType);\r\n}\r\n```\r\n\n\n### API Usage\n\n```csharp\r\nDirectoryEntry.Exists(\"pathtoobject\", \"username\", \"password\" AuthenticationType.Secure)\r\n\n\n### Alternative Designs\n\nnone\n\n### Risks\n\nVery little as it just pertains adding a simple overload for an existing function ",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHORcBMAg==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5Er7Ho",
                                           "createdAt":  "2022-06-10T13:31:02Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "I couldn\u0027t figure out the best area label to add to this issue. If you have write-permissions please help me learn by adding exactly one [area label](https://github.com/dotnet/runtime/blob/master/docs/area-owners.md).",
                                           "updatedAt":  "2022-06-10T13:31:02Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Er_1l",
                                           "createdAt":  "2022-06-10T13:49:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Background and motivation\n\nDirectoryEntry has an nice Exist function to check if an object exists in the directory. However this function does not allow for supplying credentials or authenticationtype. So this only works for when the application is in the same domain or an trusted domain for application identity. For applications that connect to a random directory at command, this make this function useless.\r\n\r\nLooking at the code. It create an directryentry for the supplied path and then calls bind. and check Bound. Unfortunately both Bound and Bind are private functions, so I cannot make equivalent code myself easily. (I suppose one could use reflection)\r\n\r\nOnce an overload to the existing exists is added one could check existence of objects in any directory not just forest local ones\n\n### API Proposal\n\n```csharp\r\nnamespace System.Collections.Generic;\r\n\r\npublic class DirectoryEntry\r\n{\r\n    public static bool Exists(string path, string username, string password, AuthenticationType authenticationType);\r\n}\r\n```\r\n\n\n### API Usage\n\n```csharp\r\nDirectoryEntry.Exists(\"pathtoobject\", \"username\", \"password\" AuthenticationType.Secure)\r\n\n\n### Alternative Designs\n\nnone\n\n### Risks\n\nVery little as it just pertains adding a simple overload for an existing function \n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003ebzuidgeest\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`api-suggestion`, `area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2022-06-10T13:49:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5EsAXw",
                                           "createdAt":  "2022-06-10T13:52:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "huoyaoyuan",
                                           "body":  "Note: (I don\u0027t have permission to edit the issue)\r\n\r\nThis\u0027s referring to `System.DirectoryServices.DirectoryEntry`.\r\nThere is already a constructor accepting these parameters: `public DirectoryEntry(string? path, string? username, string? password, System.DirectoryServices.AuthenticationTypes authenticationType)`",
                                           "updatedAt":  "2022-06-10T13:52:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5EuB5f",
                                           "createdAt":  "2022-06-11T12:25:53Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "bzuidgeest",
                                           "body":  "\r\n@huoyaoyuan  This is not referring to the constructor. Its referring to the static \"Exists\" function on DirectoryEntry, which does not have these parameters. My proposal is for editing an overload for Exist static function, not for requesting a constructor.",
                                           "updatedAt":  "2022-06-11T12:27:24Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5EuE6B",
                                           "createdAt":  "2022-06-11T13:36:32Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "huoyaoyuan",
                                           "body":  "\u003e This is not referring to the constructor.\r\n\r\nThe constructor is referred for the rationale of the set of parameters. I would be questionable about directly exposing the username and password in parameter.",
                                           "updatedAt":  "2022-06-11T13:36:32Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ExKlB",
                                           "createdAt":  "2022-06-13T10:20:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "bzuidgeest",
                                           "body":  "\u003e The constructor is referred for the rationale of the set of parameters. I would be questionable about directly exposing the username and password in parameter.\r\n\r\nThe constructor and its parameters does not apply to a static functions. \"Exists\" is an static function and cannot access instance parameters. So the only way to provide the credential is directly to the static function.\r\nI also doubt there is any real difference pertaining to security in providing these parameters to a constructor as to an static function. In both cases the application needs access to the credential.",
                                           "updatedAt":  "2022-06-13T10:20:52Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Fvnax",
                                           "createdAt":  "2022-06-29T15:16:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "gabeluci",
                                           "body":  "I\u0027ve seen this asked before: https://stackoverflow.com/questions/4284253/how-to-provide-directoryentry-exists-with-credentials\r\n\r\nThis could look something like this:\r\n\r\n```c#\r\npublic static bool Exists(string path, string username, string password, AuthenticationTypes authenticationType = AuthenticationTypes.Secure)\r\n{\r\n    DirectoryEntry entry = new DirectoryEntry(path, username, password, authenticationType);\r\n    try\r\n    {\r\n        entry.Bind(true);       // throws exceptions (possibly can break applications) \r\n        return entry.Bound;\r\n    }\r\n    catch (System.Runtime.InteropServices.COMException e)\r\n    {\r\n        if (e.ErrorCode == unchecked((int)0x80072030) ||\r\n             e.ErrorCode == unchecked((int)0x80070003) ||   // ERROR_DS_NO_SUCH_OBJECT and path not found (not found in strict sense)\r\n             e.ErrorCode == unchecked((int)0x800708AC))     // Group name could not be found\r\n            return false;\r\n        throw;\r\n    }\r\n    finally\r\n    {\r\n        entry.Dispose();\r\n    }\r\n}\r\n```",
                                           "updatedAt":  "2022-06-29T15:16:42Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5FwEwC",
                                           "createdAt":  "2022-06-29T16:47:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "cc: @BRDPM @grubioe @jay98014 who are the owners of System.DirectoryServices.dll",
                                           "updatedAt":  "2022-06-29T16:47:58Z"
                                       }
                                   ],
                         "totalCount":  8
                     },
        "title":  "[API Proposal]: DirectoryEntry.Exists with authentication credentials",
        "labels":  [
                       "api-suggestion",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/80675",
        "createdAt":  "2023-01-15T23:56:20Z",
        "number":  80675,
        "author":  "adammankowski1",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-01-18T23:54:16Z",
        "body":  "### Description\r\n\r\nI\u0027ve implemented Windows Auhtentication login to my .NET 7 application, but I\u0027m stuck on resolving groups.  \r\n\r\nSometimes, some of elements of the result of `UserPrincipal.GetAuthorizationGroups()` are just null, but count of the `UserPrincipal.GetAuthorizationGroups` result is always the same.\r\n\r\nI\u0027ve tried to debug this issue and I\u0027ve noticed that executing `UserPrincipal.GetAuthorizationGroups().ToList()` in the watch on breakpoint set on the `throw new Exception()` in the code in reproduction steps in Visual Studio results in getting all groups correctly.\r\nLike there is some delay to get data from Active Directory and I\u0027m receiving not complete results.\r\n\r\nI\u0027ve noticed that calling `up.GetGroups()` instead of `up.GetAuthorizationGroups()` seems to works fine, but it doesn\u0027t return all groups I need.\r\n\r\nWhat is the correct way to use `UserPrincipal.GetAuthorizationGroups()` method and what is the reason of some null groups in the result?\r\n\r\nDomain user I\u0027ve run the code is not any kind of user with special privileges. It\u0027s kind of usual domain user.\r\n\r\n### Reproduction Steps\r\n\r\nMy current code.\r\n\r\n```\r\nusing (var pc = new PrincipalContext(ContextType.Domain))\r\n{\r\n\tvar up = UserPrincipal.FindByIdentity(pc, \"domainUserName\");\r\n\tvar authorizationGroups = up.GetAuthorizationGroups();\r\n\r\n\tforeach (var group in authorizationGroups)\r\n\t{\r\n\t\tif (group == null)\r\n\t\t{\r\n\t\t\tthrow new Exception(\"One of the groups is null\".);\r\n\t\t}\r\n\t\tclaims.Add(\r\n\t\t\tnew Claim(ClaimTypes.Role, group.Name)\r\n\t\t);\r\n\t}\r\n}\r\n```\r\n\r\nTried changing \r\n```\r\nvar authorizationGroups = up.GetAuthorizationGroups();\r\n```\r\nto\r\n```\r\nvar authorizationGroups = up.GetAuthorizationGroups().ToList();\r\n```\r\nWith no change.\r\n\r\n### Expected behavior\r\n\r\n`UserPrincipal.GetAuthorizationGroups()` returns results with randomly null objects.\r\n\r\n### Actual behavior\r\n\r\n`UserPrincipal.GetAuthorizationGroups()` returns results without any null objects.\r\nThrowing exception or give a way to get reason of returning null objects.\r\n\r\n### Regression?\r\n\r\nI didn\u0027t try my code on earlier version of .NET.\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Configuration\r\n\r\n- .NET 7 SDK\r\n- Windows 11\r\n- x64 Architecture\r\n- API application\r\n\r\n### Other information\r\n\r\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOUzkGXw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5Sc1SU",
                                           "createdAt":  "2023-01-15T23:56:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "I couldn\u0027t figure out the best area label to add to this issue. If you have write-permissions please help me learn by adding exactly one [area label](https://github.com/dotnet/runtime/blob/master/docs/area-owners.md).",
                                           "updatedAt":  "2023-01-15T23:56:25Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Sc1bp",
                                           "createdAt":  "2023-01-15T23:59:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-security, @vcsjones\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nI\u0027ve implemented Windows Auhtentication login to my .NET 7 application, but I\u0027m stuck on resolving groups.  \r\n\r\nSometimes, some of elements of the result of `UserPrincipal.GetAuthorizationGroups()` are just null, but count of the `UserPrincipal.GetAuthorizationGroups` result is always the same.\r\n\r\nI\u0027ve tried to debug this issue and I\u0027ve noticed that executing `UserPrincipal.GetAuthorizationGroups().ToList()` in the watch on breakpoint set on the `throw new Exception()` in the code in reproduction steps in Visual Studio results in getting all groups correctly.\r\nLike there is some delay to get data from Active Directory and I\u0027m receiving not complete results.\r\n\r\nI\u0027ve noticed that calling `up.GetGroups()` instead of `up.GetAuthorizationGroups()` seems to works fine, but it doesn\u0027t return all groups I need.\r\n\r\nWhat is the correct way to use `UserPrincipal.GetAuthorizationGroups()` method and what is the reason of some null groups in the result.\r\n\r\nDomain user I\u0027ve run the code is not any kind of user with special privileges. It\u0027s kind of usual domain user.\n\n### Reproduction Steps\n\nMy current code.\r\n\r\n```\r\nusing (var pc = new PrincipalContext(ContextType.Domain))\r\n{\r\n\tvar up = UserPrincipal.FindByIdentity(pc, \"domainUserName\");\r\n\tvar authorizationGroups = up.GetAuthorizationGroups();\r\n\r\n\tforeach (var group in authorizationGroups)\r\n\t{\r\n\t\tif (group.Name == null)\r\n\t\t{\r\n\t\t\tthrow new Exception(\"One of the groups is null\".);\r\n\t\t}\r\n\t\tclaims.Add(\r\n\t\t\tnew Claim(ClaimTypes.Role, group.Name)\r\n\t\t);\r\n\t}\r\n}\r\n```\r\n\r\nTried changing \r\n```\r\nvar authorizationGroups = up.GetAuthorizationGroups();\r\n```\r\nto\r\n```\r\nvar authorizationGroups = up.GetAuthorizationGroups().ToList();\r\n```\r\nWith no change.\n\n### Expected behavior\n\n`UserPrincipal.GetAuthorizationGroups()` returns results with randomly null objects.\n\n### Actual behavior\n\n`UserPrincipal.GetAuthorizationGroups()` returns results without any null objects.\r\nThrowing exception or give a way to get reason of returning null objects.\n\n### Regression?\n\nI didn\u0027t try my code on earlier version of .NET.\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n- .NET 7 SDK\r\n- Windows 11\r\n- x64 Architecture\r\n- API application\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eadammankowski1\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.Security`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-01-15T23:59:18Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Sc1nZ",
                                           "createdAt":  "2023-01-16T00:01:43Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOCyrgEA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "vcsjones",
                                                                               "createdAt":  "2023-01-16T00:45:24Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "adammankowski1",
                                           "body":  "Hi @danmoseley, I think \"area-System.DirectoryServices\" would be a more appropriate label.\r\nMy issue is about [System.DirectoryServices.AccountManagement.UserPrincipal.GetAuthorizationGroups](https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.accountmanagement.userprincipal.getauthorizationgroups?view=dotnet-plat-ext-7.0)",
                                           "updatedAt":  "2023-01-16T00:08:16Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5Sc5Id",
                                           "createdAt":  "2023-01-16T00:39:56Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nI\u0027ve implemented Windows Auhtentication login to my .NET 7 application, but I\u0027m stuck on resolving groups.  \r\n\r\nSometimes, some of elements of the result of `UserPrincipal.GetAuthorizationGroups()` are just null, but count of the `UserPrincipal.GetAuthorizationGroups` result is always the same.\r\n\r\nI\u0027ve tried to debug this issue and I\u0027ve noticed that executing `UserPrincipal.GetAuthorizationGroups().ToList()` in the watch on breakpoint set on the `throw new Exception()` in the code in reproduction steps in Visual Studio results in getting all groups correctly.\r\nLike there is some delay to get data from Active Directory and I\u0027m receiving not complete results.\r\n\r\nI\u0027ve noticed that calling `up.GetGroups()` instead of `up.GetAuthorizationGroups()` seems to works fine, but it doesn\u0027t return all groups I need.\r\n\r\nWhat is the correct way to use `UserPrincipal.GetAuthorizationGroups()` method and what is the reason of some null groups in the result.\r\n\r\nDomain user I\u0027ve run the code is not any kind of user with special privileges. It\u0027s kind of usual domain user.\n\n### Reproduction Steps\n\nMy current code.\r\n\r\n```\r\nusing (var pc = new PrincipalContext(ContextType.Domain))\r\n{\r\n\tvar up = UserPrincipal.FindByIdentity(pc, \"domainUserName\");\r\n\tvar authorizationGroups = up.GetAuthorizationGroups();\r\n\r\n\tforeach (var group in authorizationGroups)\r\n\t{\r\n\t\tif (group.Name == null)\r\n\t\t{\r\n\t\t\tthrow new Exception(\"One of the groups is null\".);\r\n\t\t}\r\n\t\tclaims.Add(\r\n\t\t\tnew Claim(ClaimTypes.Role, group.Name)\r\n\t\t);\r\n\t}\r\n}\r\n```\r\n\r\nTried changing \r\n```\r\nvar authorizationGroups = up.GetAuthorizationGroups();\r\n```\r\nto\r\n```\r\nvar authorizationGroups = up.GetAuthorizationGroups().ToList();\r\n```\r\nWith no change.\n\n### Expected behavior\n\n`UserPrincipal.GetAuthorizationGroups()` returns results with randomly null objects.\n\n### Actual behavior\n\n`UserPrincipal.GetAuthorizationGroups()` returns results without any null objects.\r\nThrowing exception or give a way to get reason of returning null objects.\n\n### Regression?\n\nI didn\u0027t try my code on earlier version of .NET.\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n- .NET 7 SDK\r\n- Windows 11\r\n- x64 Architecture\r\n- API application\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eadammankowski1\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-01-16T00:39:56Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5TOQZf",
                                           "createdAt":  "2023-01-18T23:54:02Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "CC: @BRDPM @grubioe @jay98014 please take a look",
                                           "updatedAt":  "2023-01-18T23:54:02Z"
                                       }
                                   ],
                         "totalCount":  5
                     },
        "title":  "UserPrincipal.GetAuthorizationGroups() returns null group objects",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/82035",
        "createdAt":  "2023-02-13T14:36:46Z",
        "number":  82035,
        "author":  "merlinschumacher",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-02-17T18:25:58Z",
        "body":  "### Description\r\n\r\nThe method `System.DirectoryServices GroupPrincipal.GetMembers` should return a list of group members of a given `GroupPrincipal`. Each element contains multiple attributes of the returned `UserPrincipals`. The results also contain e-mail addresses. But the `EmailAddress` property of the last element is always empty, regardless of which AD entry it is.\r\n\r\n\r\n\r\n### Reproduction Steps\r\n\r\n```csharp\r\nusing System.DirectoryServices.AccountManagement;\r\n\r\nvar server = \"YOUR-AD-SERVER:3268\";\r\nvar searchBase = \"DC=example,DC=com\";\r\nvar group = @\"example-com\\UserGroup\";\r\n\r\nvar context = new PrincipalContext(ContextType.Domain, server, searchBase);\r\n\r\nGroupPrincipal gPrincipal = GroupPrincipal.FindByIdentity(context, IdentityType.SamAccountName, group);\r\n\r\nPrincipalSearchResult\u003cPrincipal\u003e groupMembers = gPrincipal.GetMembers(false);\r\n\r\nUserPrincipal lastUser = (UserPrincipal)groupMembers.Last();\r\n\r\n// Will show no mail address\r\nConsole.WriteLine($\"Last user is {lastUser.SamAccountName} with {lastUser.EmailAddress}\");\r\n\r\nvar userPrincipal = UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, groupMembers.Last().SamAccountName);\r\n\r\n// Will show a mail address\r\nConsole.WriteLine($\"Last user is {userPrincipal.SamAccountName} with {userPrincipal.EmailAddress}\");\r\n```\r\n\r\n### Expected behavior\r\n\r\nThe last entry should include the AD user\u0027s E-Mail address.\r\n\r\n### Actual behavior\r\n\r\nThe last entries `EmailAddress` property is always null. \r\n\r\n### Regression?\r\n\r\nUnknown.\r\n\r\n### Known Workarounds\r\n\r\nA workaround would be to get all group members one by one to retrieve the proper entries. Or just get the missing last one.\r\n\r\n`var userPrincipal = UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, groupMembers.Last().SamAccountName);`\r\n\r\n### Configuration\r\n\r\nAffected .NET Platforms:. NET7, .NET 6, .NET Framework 4.7.2\r\nOS: Windows 10, Windows Server 2016\r\nArchitecture: x64\r\n\r\n\r\n\r\n### Other information\r\n\r\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOVYltFQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5VHkak",
                                           "createdAt":  "2023-02-13T14:36:53Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nThe method `System.DirectoryServices GroupPrincipal.GetMembers` should return a list of group members of a given `GroupPrincipal`. Each element contains multiple attributes of the returned `UserPrincipals`. The results also contain e-mail addresses. But the `EmailAddress` property of the last element is always empty, regardless of which AD entry it is.\r\n\r\n\n\n### Reproduction Steps\n\n```csharp\r\nusing System.DirectoryServices.AccountManagement;\r\n\r\nvar server = \"YOUR-AD-SERVER:3268\";\r\nvar searchBase = \"DC=example,DC=com\";\r\nvar group = @\"example-com\\UserGroup\";\r\n\r\nvar context = new PrincipalContext(ContextType.Domain, server, searchBase);\r\n\r\nGroupPrincipal gPrincipal = GroupPrincipal.FindByIdentity(context, IdentityType.SamAccountName, group);\r\n\r\nPrincipalSearchResult\u003cPrincipal\u003e groupMembers = gPrincipal.GetMembers(false);\r\n\r\nUserPrincipal lastUser = (UserPrincipal)groupMembers.Last();\r\n\r\n// Will show no mail address\r\nConsole.WriteLine($\"Last user is {lastUser.SamAccountName} with {lastUser.EmailAddress}\");\r\n\r\nvar userPrincipal = UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, groupMembers.Last().SamAccountName);\r\n\r\n// Will show a mail address\r\nConsole.WriteLine($\"Last user is {userPrincipal.SamAccountName} with {userPrincipal.EmailAddress}\");\r\n```\n\n### Expected behavior\n\nThe last entry should include the AD user\u0027s E-Mail address.\n\n### Actual behavior\n\nThe last entries `EmailAddress` property is always null. \n\n### Regression?\n\nUnknown.\n\n### Known Workarounds\n\nA workaround would be to get all group members one by one to retrieve the proper entries.\r\n\r\n`var userPrincipal = UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, groupMembers.Last().SamAccountName);`\n\n### Configuration\n\nAffected .NET Platforms: .NET 6, .NET Framework 4.7.2\r\nOS: Windows 10, Windows Server 2016\r\nArchitecture: x64\r\n\r\n\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003emerlinschumacher\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-02-13T14:36:53Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ViW0V",
                                           "createdAt":  "2023-02-17T18:25:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "@BRDPM @grubioe @jay98014 please take a look",
                                           "updatedAt":  "2023-02-17T18:25:58Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "System.DirectoryServices GroupPrincipal.GetMembers always returns null for EmailAddress of last element.",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/82430",
        "createdAt":  "2023-02-21T12:51:27Z",
        "number":  82430,
        "author":  "McMlok",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHODBtXMQ==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "valeri2",
                                            "createdAt":  "2025-04-25T08:11:16Z"
                                        }
                                    ],
                          "totalCount":  1
                      },
        "updatedAt":  "2024-07-18T18:14:28Z",
        "body":  "### Description\n\nI\u0027m using Negotiate authentication in ASP.NET Core app. The application runs in docker container in on-prem K8s. I also setup loading roles to ClaimPrincipal with EnableLdap settings method. Auth works fine and loading roles but after 15minutes of inactivity in the app I got exception from LdapConnection with \"The LDAP server is unavailable.\". After some debugging, I end with a small console app where I open a connection perform a search then wait 15 minutes and perform the search again. When I run this app on windows everything is OK but on WSL (Ubuntu 18.04 with libldap 2.4) first iteration is OK second fails.\r\n\r\nI tried to setup AutoReconnect  = true in LdapConnection settings but with this connection is not able to Bind with error \"The LDAP server is unavailable\".\r\n\r\nIs it possible to have singleton instance of LdapConnection? Or is there a way how to setup auto reconect when app runs in Linux machine?\r\n\r\nThank you\n\n### Reproduction Steps\n\n- Create console app\r\n- Create LdapConnection\r\n- Bind the connection\r\n- perform search\r\n- wait 16 minutes\r\n- perform search again.\r\n- run app in Linux based machine (Ubuntu/Alpine)\r\n\r\nOr here is my [small repo](https://github.com/McMlok/LdapLinuxTimeOutTest) where I test it.\n\n### Expected behavior\n\nLdapConnection can perform search after 15 minutes of inactivity\n\n### Actual behavior\n\nI could not perform search after connection is inactive more than 15minutes.\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\nLocal dev setup\r\n- Windows 10 21H2\r\n- dotnet 6.0.13\r\n- System.DirectoryServices 7.0.1\r\n- System.DirectoryServices.Protocols 7.0.0\r\n\r\nWSL setup\r\n- Ubuntu 18.04\r\n- dotnet 6.0.13\r\n- System.DirectoryServices 7.0.1\r\n- System.DirectoryServices.Protocols 7.0.0\r\n\r\nK8s 1.24 setup\r\n- Alpine 3.13\r\n- dotnet 6.0.13\r\n- System.DirectoryServices 7.0.1\r\n- System.DirectoryServices.Protocols 7.0.0\n\n### Other information\n\nOriginally, I hit this issue in [Microsoft.AspNetCore.Authentication.Negotiate](https://github.com/dotnet/aspnetcore/tree/main/src/Security/Authentication/Negotiate) when I run my app on Linux box. But as I understand their code there is also only one LdapConnection instance for app and is reused for all search.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOhVkGJQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5VvXkZ",
                                           "createdAt":  "2023-02-21T13:20:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nI\u0027m using Negotiate authentication in ASP.NET Core app. The application runs in docker container in on-prem K8s. I also setup loading roles to ClaimPrincipal with EnableLdap settings method. Auth works fine and loading roles but after 15minutes of inactivity in the app I got exception from LdapConnection with \"The LDAP server is unavailable.\". After some debugging, I end with a small console app where I open a connection perform a search then wait 15 minutes and perform the search again. When I run this app on windows everything is OK but on WSL (Ubuntu 18.04 with libldap 2.4) first iteration is OK second fails.\r\n\r\nI tried to setup AutoReconnect  = true in LdapConnection settings but with this connection is not able to Bind with error \"The LDAP server is unavailable\".\r\n\r\nIs it possible to have singleton instance of LdapConnection? Or is there a way how to setup auto reconect when app runs in Linux machine?\r\n\r\nThank you\n\n### Reproduction Steps\n\n- Create console app\r\n- Create LdapConnection\r\n- Bind the connection\r\n- perform search\r\n- wait 16 minutes\r\n- perform search again.\r\n- run app in Linux based machine (Ubuntu/Alpine)\r\n\r\nOr here is my [small repo](https://github.com/McMlok/LdapLinuxTimeOutTest) where I test it.\n\n### Expected behavior\n\nLdapConnection can perform search after 15 minutes of inactivity\n\n### Actual behavior\n\nI could not perform search after connection is inactive more than 15minutes.\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\nLocal dev setup\r\n- Windows 10 21H2\r\n- dotnet 6.0.13\r\n- System.DirectoryServices 7.0.1\r\n- System.DirectoryServices.Protocols 7.0.0\r\n\r\nWSL setup\r\n- Ubuntu 18.04\r\n- dotnet 6.0.13\r\n- System.DirectoryServices 7.0.1\r\n- System.DirectoryServices.Protocols 7.0.0\r\n\r\nK8s 1.24 setup\r\n- Alpine 3.13\r\n- dotnet 6.0.13\r\n- System.DirectoryServices 7.0.1\r\n- System.DirectoryServices.Protocols 7.0.0\n\n### Other information\n\nOriginally, I hit this issue in [Microsoft.AspNetCore.Authentication.Negotiate](https://github.com/dotnet/aspnetcore/tree/main/src/Security/Authentication/Negotiate) when I run my app on Linux box. But as I understand their code there is also only one LdapConnection instance for app and is reused for all search.\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eMcMlok\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-02-21T13:20:05Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5V3KaR",
                                           "createdAt":  "2023-02-22T18:04:40Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "\u003e Or here is my [small repo](https://github.com/McMlok/LdapLinuxTimeOutTest) where I test it.\r\n\r\nThat link is broken.",
                                           "updatedAt":  "2023-02-22T18:04:40Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5V3Kjf",
                                           "createdAt":  "2023-02-22T18:05:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been marked `needs-author-action` and may be missing some important information.",
                                           "updatedAt":  "2023-02-22T18:05:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5V3Xn7",
                                           "createdAt":  "2023-02-22T18:31:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "McMlok",
                                           "body":  "Sorry, I did not mark repo as public. Now it is working, I hope.",
                                           "updatedAt":  "2023-02-22T18:31:44Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5s5mlA",
                                           "createdAt":  "2023-11-27T02:41:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "corsiva",
                                           "body":  "Hi @McMlok,\r\n\r\nI\u0027m facing a similar issue.\r\nHave you resolved the issue?\r\n\r\nBR,\r\n",
                                           "updatedAt":  "2023-11-27T02:41:03Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5s6dgl",
                                           "createdAt":  "2023-11-27T07:27:16Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODNplpQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "corsiva",
                                                                               "createdAt":  "2023-11-27T07:28:09Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "McMlok",
                                           "body":  "Hello @corsiva,\r\n\r\nunfortunately, not.  But I was able to implement my own libraries to get data from LDAP with Novell.Directory.Ldap.NETStandard Nuget package. ",
                                           "updatedAt":  "2023-11-27T07:27:16Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5tQ87N",
                                           "createdAt":  "2023-11-30T06:04:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "corsiva",
                                           "body":  "How can we work on this issue?\r\nThe issue still occurs.\r\nI did test and found out that the issue is not happening when I start the application from command line like dotnet application.dll .\r\nI need a help to fix this issue but I don\u0027t know how developers of Microsoft pick issues for resolving them.\r\n\r\nBR,",
                                           "updatedAt":  "2023-11-30T06:04:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5tZMVr",
                                           "createdAt":  "2023-12-01T02:24:41Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "corsiva",
                                           "body":  "Hi @buyaa-n ,\r\nHave you recently worked on this issue?\r\n\r\nBR,",
                                           "updatedAt":  "2023-12-01T02:24:41Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5u0jNK",
                                           "createdAt":  "2023-12-17T20:05:00Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "kgrodimov",
                                           "body":  "@buyaa-n @steveharter Hello, I have the same issue, can you help?",
                                           "updatedAt":  "2023-12-17T20:05:00Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6Cpdbo",
                                           "createdAt":  "2024-06-26T14:50:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "chrbauer",
                                           "body":  "Since it still happens:\r\na workaround (!!) is to send a dummy Request of over the ldap connection, e.g. every 10 minutes.\r\n\r\nTcp KeepAlive doen\u0027t help. The LDAP Server closes the connection of inactivity. Proper solution would be auto rebind.",
                                           "updatedAt":  "2024-06-26T14:50:25Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6FWQYl",
                                           "createdAt":  "2024-07-18T18:14:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "SilvioSodre",
                                           "body":  "Hi All!\r\n\r\nI have the same issue. Has someone get this error solved? I have seen in the Github forum many issues pointing to the same problem, but neither of them has really solved it. \r\n\r\nI liked the workaround suggested by @chrbauer, but I don\u0027t intend to implement it. For sure, there is a solution to this issue besides the implementation of a sidecar code to keep the ldap connection up. \r\n\r\nHas someone has any clue to solve the problem?",
                                           "updatedAt":  "2024-07-18T18:14:27Z"
                                       }
                                   ],
                         "totalCount":  11
                     },
        "title":  "LdapConnection stop working after 15minutes of inactivity",
        "labels":  [
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/82601",
        "createdAt":  "2023-02-24T13:51:20Z",
        "number":  82601,
        "author":  "t00",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-07-21T09:59:13Z",
        "body":  "### Description\n\nWhen using LdapConnection with a password containing point symbol (£) on Linux, the server consistently responds with Invalid Credentials error code.\r\n\r\nWhen browsing the code, SessionOptions.ProtocolVersion does not seem to affect the way password is marshalled to ldap_sasl_bind function, LdapPal.StringToPtr function is always used (StringToHGlobalAnsi, StringToAnsiString) meaning the pound character will be converted to ANSI codepage or dropped.\r\n\r\nThis issue leaves out a lot of users using non-latin characters without access to LDAP authentication through dotnet, running on Linux.\n\n### Reproduction Steps\n\n```\r\nvar ldapInfo = new LdapDirectoryIdentifier(\"1.2.3.4\", 389);\r\nvar credental = new NetworkCredential(\"rich\", \"1337£\", \"test-ad\")\r\n\r\nusing (var ldapConnection = new LdapConnection(ldapInfo, credential))\r\n{\r\n   ldapConnection.AuthType = AuthType.Basic;\r\n   ldapConnection.SessionOptions.ProtocolVersion = 3;\r\n   ldapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\n   ldapConnection.Bind();\r\n}\r\n```\n\n### Expected behavior\n\nIf ProtocolVersion is set to 3, marshalling should be done using UTF8, as described on https://www.ibm.com/docs/en/zos/2.1.0?topic=routines-ldap-sasl-bind-ldap-sasl-bind-s as well as parameter LDAP_OPT_UTF8_IO should be set.\n\n### Actual behavior\n\nInvalid Credentials response is returned.\n\n### Regression?\n\nFunctionality work on my automated tests in dotnet 5, not sure what have changed internally in dotnet.\n\n### Known Workarounds\n\nDo not use special characters in a password?\n\n### Configuration\n\ndotnet 6 LTS, latest Manjaro\n\n### Other information\n\nadd label: area-System.DirectoryServices ",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOuIkHAA==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5WEp5S",
                                           "createdAt":  "2023-02-24T17:14:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "stephentoub",
                                           "body":  "Same as https://github.com/dotnet/runtime/issues/76426?\r\ncc: @joperezr ",
                                           "updatedAt":  "2023-02-24T17:14:27Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5WFUNg",
                                           "createdAt":  "2023-02-24T18:39:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "It does seem very similar, except that in the one that was closed it was never confirmed if ProtocolVersion was set to 3.0 or not, and on this one it does seem like the right version is set. It is interesting that @t00 mentions that this worked fine on 5.0 and has regressed since then, I wouldn\u0027t expect that since IIRC we didn\u0027t fully support sasl_bind in 5.0, but I may be misremembering. @t00  can you confirm which versions of the S.DS.Protocols package work for you and which ones don\u0027t?",
                                           "updatedAt":  "2023-02-24T18:39:55Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5WFbYe",
                                           "createdAt":  "2023-02-24T18:57:06Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nWhen using LdapConnection with a password containing point symbol (£) on Linux, the server consistently responds with Invalid Credentials error code.\r\n\r\nWhen browsing the code, SessionOptions.ProtocolVersion does not seem to affect the way password is marshalled to ldap_sasl_bind function, LdapPal.StringToPtr function is always used (StringToHGlobalAnsi, StringToAnsiString) meaning the pound character will be converted to ANSI codepage or dropped.\r\n\r\nThis issue leaves out a lot of users using non-latin characters without access to LDAP authentication through dotnet, running on Linux.\n\n### Reproduction Steps\n\n```\r\nvar ldapInfo = new LdapDirectoryIdentifier(\"1.2.3.4\", 389);\r\nvar credental = new NetworkCredential(\"rich\", \"1337£\", \"test-ad\")\r\n\r\nusing (var ldapConnection = new LdapConnection(ldapInfo, credential))\r\n{\r\n   ldapConnection.AuthType = AuthType.Basic;\r\n   ldapConnection.SessionOptions.ProtocolVersion = 3;\r\n   ldapConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\n   ldapConnection.Bind();\r\n}\r\n```\n\n### Expected behavior\n\nIf ProtocolVersion is set to 3, marshalling should be done using UTF8, as described on https://www.ibm.com/docs/en/zos/2.1.0?topic=routines-ldap-sasl-bind-ldap-sasl-bind-s as well as parameter LDAP_OPT_UTF8_IO should be set.\n\n### Actual behavior\n\nInvalid Credentials response is returned.\n\n### Regression?\n\nFunctionality work on my automated tests in dotnet 5, not sure what have changed internally in dotnet.\n\n### Known Workarounds\n\nDo not use special characters in a password?\n\n### Configuration\n\ndotnet 6 LTS, latest Manjaro\n\n### Other information\n\nadd label: area-System.DirectoryServices \n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003et00\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-02-24T18:57:06Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5WFhos",
                                           "createdAt":  "2023-02-24T19:10:46Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "t00",
                                           "body":  "I cannot check version 2 on dotnet 5, but on dotnet 6 version 3 does not work on Linux with the same AD but works on Windows just fine.\r\nI will do more checks over the weekend with a simple password to rule out non-unicode character issues.",
                                           "updatedAt":  "2023-02-24T19:10:46Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5WF4o3",
                                           "createdAt":  "2023-02-24T20:05:35Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "That would be great, thanks so much for checking. As an FYI, for this particular library (and for this particular APIs that you are calling) we have different implementations for Windows and Linux, so what would work best to get the information that we need is if we can have a repro in the same OS (so in this case Linux) and perhaps even against the same AD and same credentials. Essentially, if we can get that info, as well as which version of a NuGet package you are using when it breaks and which version you are using when it works would get us most of what we need. 😄 ",
                                           "updatedAt":  "2023-02-24T20:05:35Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5WIWuj",
                                           "createdAt":  "2023-02-25T08:36:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "t00",
                                           "body":  "I prepared a test project which have shown that dotnet 5, 6 and 7 behave the same way which contradicts what I had mentioned before - sorry for confusion. It might have been working fine with some other libraries on the system but it would be impossible to reproduce again so please assume dotnet 5 did not work with unicode as well.\r\n\r\nWhat indeed continuously does not work is unicode password on both AD and ApacheDS I am using for tests. Also interestingly ApacheDS refuses working with ProtocolVersion 2 while AD works if the credentials are not unicode.\r\n\r\nHere is test code which I ran:\r\n\r\n```\r\n        [Test, Combinatorial]\r\n        public void Test1(\r\n            [Values(true, false)] bool isActiveDirectory,\r\n            [Values(true, false)] bool isUnicode,\r\n            [Values(true, false)] bool isVersion3\r\n        )\r\n        {\r\n            var username = isUnicode ? \"wróżka\" : \"fairy\";\r\n            var password = isUnicode ? \"wążMa£1000\" : \"snakeHas1000GBP\";\r\n            if (!isActiveDirectory)\r\n            {\r\n                username = $\"uid={username},ou=users,dc=my-development,dc=com\";\r\n            }\r\n\r\n            var port = isActiveDirectory ? 389 : 10389;\r\n            var domain = isActiveDirectory ? \"my-ad\" : \"\";\r\n            var hostIdentifier = new LdapDirectoryIdentifier(\"1.2.3.4\", port);\r\n            using var searchConnection = new LdapConnection(hostIdentifier, new NetworkCredential(username, password, domain));\r\n            searchConnection.AuthType = AuthType.Basic;\r\n            searchConnection.Timeout = TimeSpan.FromSeconds(5);\r\n            searchConnection.SessionOptions.ProtocolVersion = isVersion3 ? 3 : 2;\r\n            searchConnection.SessionOptions.ReferralChasing = ReferralChasingOptions.None;\r\n            try\r\n            {\r\n                searchConnection.Bind();\r\n            }\r\n            catch (Exception e)\r\n            {\r\n                Assert.Fail($\"{Environment.Version}: Exception {e.GetType()} thrown: {e.Message}\");\r\n            }\r\n        }\r\n```\r\n\r\nBelow are results on Linux:\r\n\r\n```\r\nTestLdapDotNet (24 tests) Failed: 15 tests failed\r\n  TestLdapDotNet (24 tests) Failed: 15 tests failed\r\n    Tests (net5.0) (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n      Test1 (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n        Test1(False,False,False) Failed: 5.0.17: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,False,True) Success\r\n        Test1(False,True,False) Failed: 5.0.17: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,True,True) Failed: 5.0.17: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,False,False) Success\r\n        Test1(True,False,True) Success\r\n        Test1(True,True,False) Failed: 5.0.17: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,True,True) Failed: 5.0.17: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n    Tests (net7.0) (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n      Test1 (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n        Test1(False,False,False) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,False,True) Success\r\n        Test1(False,True,False) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,True,True) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,False,False) Success\r\n        Test1(True,False,True) Success\r\n        Test1(True,True,False) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,True,True) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n    Tests (net6.0) (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n      Test1 (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n        Test1(False,False,False) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,False,True) Success\r\n        Test1(False,True,False) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,True,True) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,False,False) Success\r\n        Test1(True,False,True) Success\r\n        Test1(True,True,False) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,True,True) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n```\r\n\r\nAnd here are same test results on Windows:\r\n\r\n```\r\nTest\tDuration\tTraits\tError Message\r\nProject: TestLdapDotNet (net5.0) Failed (8)\t396 ms\t\t\r\nNamespace: TestLdapDotNet Failed (8)\t396 ms\t\t\r\nClass: Tests Failed (8)\t396 ms\t\t\r\nTest Group: TestLdapDotNet.Tests.Test1 Failed (8)\t396 ms\t\t\r\nTest1(False,False,False) Failed\t39 ms\t\t5.0.16: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\nTest1(False,False,True) Passed\t44 ms\t\t\r\nTest1(False,True,False) Failed\t44 ms\t\t5.0.16: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\nTest1(False,True,True) Passed\t42 ms\t\t\r\nTest1(True,False,False) Passed\t44 ms\t\t\r\nTest1(True,False,True) Passed\t40 ms\t\t\r\nTest1(True,True,False) Failed\t88 ms\t\t5.0.16: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\nTest1(True,True,True) Passed\t55 ms\t\t\r\nProject: TestLdapDotNet (net6.0) Failed (8)\t460 ms\t\t\r\nNamespace: TestLdapDotNet Failed (8)\t460 ms\t\t\r\nClass: Tests Failed (8)\t460 ms\t\t\r\nTest Group: TestLdapDotNet.Tests.Test1 Failed (8)\t460 ms\t\t\r\nTest1(False,False,False) Failed\t42 ms\t\t6.0.13: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\nTest1(False,False,True) Passed\t44 ms\t\t\r\nTest1(False,True,False) Failed\t48 ms\t\t6.0.13: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\nTest1(False,True,True) Passed\t42 ms\t\t\r\nTest1(True,False,False) Passed\t41 ms\t\t\r\nTest1(True,False,True) Passed\t46 ms\t\t\r\nTest1(True,True,False) Failed\t136 ms\t\t6.0.13: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\nTest1(True,True,True) Passed\t61 ms\t\t\r\nProject: TestLdapDotNet (net7.0) Failed (8)\t393 ms\t\t\r\nNamespace: TestLdapDotNet Failed (8)\t393 ms\t\t\r\nClass: Tests Failed (8)\t393 ms\t\t\r\nTest Group: TestLdapDotNet.Tests.Test1 Failed (8)\t393 ms\t\t\r\nTest1(False,False,False) Failed\t44 ms\t\t7.0.2: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\nTest1(False,False,True) Passed\t39 ms\t\t\r\nTest1(False,True,False) Failed\t46 ms\t\t7.0.2: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\nTest1(False,True,True) Passed\t39 ms\t\t\r\nTest1(True,False,False) Passed\t38 ms\t\t\r\nTest1(True,False,True) Passed\t34 ms\t\t\r\nTest1(True,True,False) Failed\t89 ms\t\t7.0.2: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\nTest1(True,True,True) Passed\t64 ms\t\t\r\n```\r\n\r\nClearly unicode tests are passing on Windows and only ProtocolVersion 2 expectedly fails on a few occassions.",
                                           "updatedAt":  "2023-02-25T08:37:07Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5WIZhi",
                                           "createdAt":  "2023-02-25T09:42:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "t00",
                                           "body":  "Sorry forgot to mention, using DirectoryServices.Protocols version 6.0.1. After upgrading to the latest 7.0.0 it seems dotnet 5 is not supported anymore but the remaining tests on Linux fail on exactly same tests:\r\n\r\n```\r\nTestLdapDotNet (24 tests) Failed: 18 tests failed\r\n  TestLdapDotNet (24 tests) Failed: 18 tests failed\r\n    Tests (net5.0) (8 tests) Failed: One or more child tests had errors: 8 tests failed\r\n      Test1 (8 tests) Failed: One or more child tests had errors: 8 tests failed\r\n        Test1(False,False,False) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n        Test1(False,False,True) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n        Test1(False,True,False) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n        Test1(False,True,True) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n        Test1(True,False,False) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n        Test1(True,False,True) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n        Test1(True,True,False) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n        Test1(True,True,True) Failed: System.PlatformNotSupportedException : System.DirectoryServices.Protocols is not supported on this platform.\r\n    Tests (net7.0) (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n      Test1 (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n        Test1(False,False,False) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,False,True) Success\r\n        Test1(False,True,False) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,True,True) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,False,False) Success\r\n        Test1(True,False,True) Success\r\n        Test1(True,True,False) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,True,True) Failed: 7.0.2: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n    Tests (net6.0) (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n      Test1 (8 tests) Failed: One or more child tests had errors: 5 tests failed\r\n        Test1(False,False,False) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,False,True) Success\r\n        Test1(False,True,False) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.DirectoryOperationException thrown: A protocol error occurred.\r\n        Test1(False,True,True) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,False,False) Success\r\n        Test1(True,False,True) Success\r\n        Test1(True,True,False) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n        Test1(True,True,True) Failed: 6.0.14: Exception System.DirectoryServices.Protocols.LdapException thrown: The supplied credential is invalid.\r\n```",
                                           "updatedAt":  "2023-02-25T09:47:00Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5W1wNl",
                                           "createdAt":  "2023-03-06T20:31:01Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "t00",
                                           "body":  "@joperezr Do you have any updates on how the issue is progressing on your end?",
                                           "updatedAt":  "2023-03-06T20:31:01Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5aru-O",
                                           "createdAt":  "2023-04-25T08:49:24Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODD5h0Q==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "CONFUSED",
                                                                               "user":  "isupovs",
                                                                               "createdAt":  "2023-08-17T08:07:53Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "Menci77",
                                           "body":  "Hello, I have a similar problem but on WINDOWS. I\u0027m not sure if it is linked to this problem. I can open a new issue for this if needed.\r\n\r\nWe are using  DirectoryServices.Protocols version 7.0.0.\r\n` _ldapConnection.AuthType = AuthType.Basic;\r\n  _ldapConnection.SessionOptions.ProtocolVersion = 3;`\r\nAnd when the user\u0027s password contains accented characters (éáöüó..) the auth fails with \u0027Invalid Credentials\u0027.\r\n",
                                           "updatedAt":  "2023-04-25T08:49:24Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5rHSr8",
                                           "createdAt":  "2023-11-07T00:21:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODL-Lgw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "flohoff",
                                                                               "createdAt":  "2023-11-07T09:09:34Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "t00",
                                           "body":  "@joperezr Will this issue be fixed in upcoming .NET 8? It might be a niche use case to use LdapConnection in dotnet on Linux, but still this is a serious bug in an integral part of the released framework :(",
                                           "updatedAt":  "2023-11-07T00:22:20Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5rWrJQ",
                                           "createdAt":  "2023-11-08T05:21:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "joperezr",
                                           "body":  "Thanks for the ping. Unfortunately we didn’t get a a chance to fix this issue during .NET 8 release. @dotnet/area-system-directoryservices is this something that we think we can get to for .NET 9? Alternatively, @t00 it would be awesome if you happen to be interested in helping us and contributing a PR with a fix 😃 ",
                                           "updatedAt":  "2023-11-08T05:21:22Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5rk5Ez",
                                           "createdAt":  "2023-11-09T23:19:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e https://github.com/orgs/dotnet/teams/area-system-directoryservices is this something that we think we can get to for .NET 9?\r\n\r\nNot sure if we can handle it in .NET 9, most likely will rely on community contribution.",
                                           "updatedAt":  "2023-11-09T23:19:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5wn8HR",
                                           "createdAt":  "2024-01-12T15:33:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODx-Rzw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_DOWN",
                                                                               "user":  "mc-paula",
                                                                               "createdAt":  "2024-01-12T15:51:17Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "gelatincrypto",
                                                                               "createdAt":  "2024-04-08T11:12:06Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "umoelli",
                                                                               "createdAt":  "2024-09-12T09:38:51Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  3
                                                         },
                                           "author":  "PavPav",
                                           "body":  "Seems to be already fixed by https://github.com/dotnet/runtime/pull/76127\r\nSeems to be included into DirectoryServices.Protocols version 8.0.0.",
                                           "updatedAt":  "2024-01-12T15:33:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc64iQcA",
                                           "createdAt":  "2025-07-21T09:58:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ThomasPrioul",
                                           "body":  "I ran into this exact unicode chars in password problem at work using our corporate AD servers.\nI fixed it with the following change :\n```diff\n+ connection.SessionOptions.ProtocolVersion = 3;\n```\nIn this snippet :\n```csharp\nprivate LdapConnection GetLdapConnection(string username, string password)\n{\n    if (!username.Contains(configuration.Domain, StringComparison.InvariantCultureIgnoreCase))\n    {\n        username = $\"{username}@{configuration.Domain}\".ToLower();\n    }\n\n    var serverId = new LdapDirectoryIdentifier(authServers, configuration.Port, false, false);\n    var connection = new LdapConnection(\n        serverId,\n        new NetworkCredential(username.ToLower(), password),\n        AuthType.Basic);\n    connection.SessionOptions.ProtocolVersion = 3;\n    return connection;\n}\n```\n\nI haven\u0027t looked into the defaults of each parameter, and it probably depends on the server too as it was still broken for others in this thread. But it did fix it for me somehow (I\u0027m on linux too).\nI\u0027m using .NET 9 and System.DirectoryServices.Protocols v9.0.4",
                                           "updatedAt":  "2025-07-21T09:59:13Z"
                                       }
                                   ],
                         "totalCount":  14
                     },
        "title":  "LdapConnection does not handle passwords containing UTF-8 characters on Linux",
        "labels":  [
                       "area-System.DirectoryServices",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/84825",
        "createdAt":  "2023-04-14T08:18:01Z",
        "number":  84825,
        "author":  "Michel20367",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-08-28T21:41:00Z",
        "body":  "### Description\n\nUnsupported LdapConnection.SessionOptions throws LdapException with Message **\"The LDAP server is unavailable\"** on Linux.\r\nThis is very misleading.\n\n### Reproduction Steps\n\nRun this Code:\r\n```\r\nvar ldapDirectoryIdentifier = new LdapDirectoryIdentifier(\"server\", 389);\r\nusing var conn = new LdapConnection(ldapDirectoryIdentifier);\r\nconn.SessionOptions.AutoReconnect = true;\r\n```\r\n\n\n### Expected behavior\n\nA PlatformNotSupportedExeption or NotImplementedExeption must be thrown.\r\nWhen getting just return null or an empty string if possible.\n\n### Actual behavior\n\nOn **set** or **get** on an unsupported property LdapException with message \"The LDAP server is unavailable\" is thrown on Linux.\r\nSee Quick Watch below\r\n\r\n\u003c!DOCTYPE html\u003e\r\n\u003cHTML\u003e\r\n\u003chead\u003e\u003c/head\u003e\r\n\u003cbody\u003e\r\n\u003c!--StartFragment--\u003e\r\n\r\n\r\n  | Name | Value | Type\r\n-- | -- | -- | --\r\n◢ | conn.SessionOptions | {System.DirectoryServices.Protocols.LdapSessionOptions} | System.DirectoryServices.Protocols.LdapSessionOptions\r\n  | ▶ AutoReconnect | \u0027conn.SessionOptions.AutoReconnect\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ DomainName | \u0027conn.SessionOptions.DomainName\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | string {System.DirectoryServices.Protocols.LdapException}\r\n  | HostName | \"dc02.mydomain.de:389\" | string\r\n  | ▶ HostReachable | \u0027conn.SessionOptions.HostReachable\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ LocatorFlag | \u0027conn.SessionOptions.LocatorFlag\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.DirectoryServices.Protocols.LocatorFlags {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ PingKeepAliveTimeout | \u0027conn.SessionOptions.PingKeepAliveTimeout\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.TimeSpan {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ PingLimit | \u0027conn.SessionOptions.PingLimit\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | int {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ PingWaitTimeout | \u0027conn.SessionOptions.PingWaitTimeout\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.TimeSpan {System.DirectoryServices.Protocols.LdapException}\r\n  | ProtocolVersion | 2 | int\r\n  | QueryClientCertificate | null | System.DirectoryServices.Protocols.QueryClientCertificateCallback\r\n  | ▶ ReferralCallback | {System.DirectoryServices.Protocols.ReferralCallback} | System.DirectoryServices.Protocols.ReferralCallback\r\n  | ReferralChasing | All | System.DirectoryServices.Protocols.ReferralChasingOptions\r\n  | ▶ ReferralHopLimit | \u0027conn.SessionOptions.ReferralHopLimit\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | int {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ RootDseCache | \u0027conn.SessionOptions.RootDseCache\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | SaslMethod | \"GSS-SPNEGO\" | string\r\n  | Sealing | false | bool\r\n  | SecureSocketLayer | false | bool\r\n  | ▶ SecurityContext | {System.DirectoryServices.Protocols.SecurityHandle} | object {System.DirectoryServices.Protocols.SecurityHandle}\r\n  | ▶ SendTimeout | \u0027conn.SessionOptions.SendTimeout\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.TimeSpan {System.DirectoryServices.Protocols.LdapException}\r\n  | Signing | false | bool\r\n  | ▶ SslInformation | \u0027conn.SessionOptions.SslInformation\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.DirectoryServices.Protocols.SecurityPackageContextConnectionInformation {System.DirectoryServices.Protocols.LdapException}\r\n  | SspiFlag | 0 | int\r\n  | ▶ TcpKeepAlive | \u0027conn.SessionOptions.TcpKeepAlive\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | VerifyServerCertificate | null | System.DirectoryServices.Protocols.VerifyServerCertificateCallback\r\n\r\n\r\n\u003c!--EndFragment--\u003e\r\n\u003c/body\u003e\r\n\u003c/HTML\u003e\r\n\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n.NET 6.0.14\r\nSystem.DirectoryServices.Protocols 7.0.0\r\nBoth WSL2 with Windows10  and 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64 GNU/Linux\n\n### Other information\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOig_mdQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5Z5BQ0",
                                           "createdAt":  "2023-04-14T08:18:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nUnsupported LdapConnection.SessionOptions throws LdapException with Message **\"The LDAP server is unavailable\"** on Linux.\r\nThis is very misleading.\n\n### Reproduction Steps\n\nRun this Code:\r\n```\r\nvar ldapDirectoryIdentifier = new LdapDirectoryIdentifier(\"server\", 389);\r\nusing var conn = new LdapConnection(ldapDirectoryIdentifier);\r\nconn.SessionOptions.AutoReconnect = true;\r\n```\r\n\n\n### Expected behavior\n\nA PlatformNotSupportedExeption or NotImplementedExeption must be thrown.\r\nWhen getting just return null or an empty string if possible.\n\n### Actual behavior\n\nOn **set** or **get** on an unsupported property LdapException with message \"The LDAP server is unavailable\" is thrown on Linux.\r\nSee Quick Watch below\r\n\r\n\u003c!DOCTYPE html\u003e\r\n\u003cHTML\u003e\r\n\u003chead\u003e\u003c/head\u003e\r\n\u003cbody\u003e\r\n\u003c!--StartFragment--\u003e\r\n\r\n\r\n  | Name | Value | Type\r\n-- | -- | -- | --\r\n◢ | conn.SessionOptions | {System.DirectoryServices.Protocols.LdapSessionOptions} | System.DirectoryServices.Protocols.LdapSessionOptions\r\n  | ▶ AutoReconnect | \u0027conn.SessionOptions.AutoReconnect\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ DomainName | \u0027conn.SessionOptions.DomainName\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | string {System.DirectoryServices.Protocols.LdapException}\r\n  | HostName | \"dc02.mydomain.de:389\" | string\r\n  | ▶ HostReachable | \u0027conn.SessionOptions.HostReachable\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ LocatorFlag | \u0027conn.SessionOptions.LocatorFlag\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.DirectoryServices.Protocols.LocatorFlags {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ PingKeepAliveTimeout | \u0027conn.SessionOptions.PingKeepAliveTimeout\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.TimeSpan {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ PingLimit | \u0027conn.SessionOptions.PingLimit\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | int {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ PingWaitTimeout | \u0027conn.SessionOptions.PingWaitTimeout\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.TimeSpan {System.DirectoryServices.Protocols.LdapException}\r\n  | ProtocolVersion | 2 | int\r\n  | QueryClientCertificate | null | System.DirectoryServices.Protocols.QueryClientCertificateCallback\r\n  | ▶ ReferralCallback | {System.DirectoryServices.Protocols.ReferralCallback} | System.DirectoryServices.Protocols.ReferralCallback\r\n  | ReferralChasing | All | System.DirectoryServices.Protocols.ReferralChasingOptions\r\n  | ▶ ReferralHopLimit | \u0027conn.SessionOptions.ReferralHopLimit\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | int {System.DirectoryServices.Protocols.LdapException}\r\n  | ▶ RootDseCache | \u0027conn.SessionOptions.RootDseCache\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | SaslMethod | \"GSS-SPNEGO\" | string\r\n  | Sealing | false | bool\r\n  | SecureSocketLayer | false | bool\r\n  | ▶ SecurityContext | {System.DirectoryServices.Protocols.SecurityHandle} | object {System.DirectoryServices.Protocols.SecurityHandle}\r\n  | ▶ SendTimeout | \u0027conn.SessionOptions.SendTimeout\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.TimeSpan {System.DirectoryServices.Protocols.LdapException}\r\n  | Signing | false | bool\r\n  | ▶ SslInformation | \u0027conn.SessionOptions.SslInformation\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | System.DirectoryServices.Protocols.SecurityPackageContextConnectionInformation {System.DirectoryServices.Protocols.LdapException}\r\n  | SspiFlag | 0 | int\r\n  | ▶ TcpKeepAlive | \u0027conn.SessionOptions.TcpKeepAlive\u0027 threw an exception of type \u0027System.DirectoryServices.Protocols.LdapException\u0027 | bool {System.DirectoryServices.Protocols.LdapException}\r\n  | VerifyServerCertificate | null | System.DirectoryServices.Protocols.VerifyServerCertificateCallback\r\n\r\n\r\n\u003c!--EndFragment--\u003e\r\n\u003c/body\u003e\r\n\u003c/HTML\u003e\r\n\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n.NET 6.0.14\r\nSystem.DirectoryServices.Protocols 7.0.0\r\nBoth WSL2 with Windows10  and 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64 GNU/Linux\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eMichel20367\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-04-14T08:18:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5aZ-91",
                                           "createdAt":  "2023-04-20T18:22:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "Can be verified and fixed with the https://github.com/dotnet/runtime/issues/83259",
                                           "updatedAt":  "2023-04-20T18:22:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6KDsCT",
                                           "createdAt":  "2024-08-28T20:46:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "sira506",
                                           "body":  "\r\nAre there any advances related to this?",
                                           "updatedAt":  "2024-08-28T20:46:14Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6KD-Z1",
                                           "createdAt":  "2024-08-28T21:40:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "Nobody really working on it, and it is not prioritized. Feel free to contribute if you want/can",
                                           "updatedAt":  "2024-08-28T21:40:59Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "Unsupported LdapConnection.SessionOptions throws LdapException with Message \"The LDAP server is unavailable\" on Linux",
        "labels":  [
                       "area-System.DirectoryServices",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/87197",
        "createdAt":  "2023-06-06T22:18:21Z",
        "number":  87197,
        "author":  "hellblade",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-08-07T18:59:17Z",
        "body":  "### Description\n\nThe DirectoryEntry.RefreshCache method has an overload to take in just a limited number of properties to refresh.\r\n[See Documentation](https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.directoryentry.refreshcache?view=dotnet-plat-ext-7.0#system-directoryservices-directoryentry-refreshcache(system-string()))\r\n\r\nThis does not seem to refresh the cache for a property when:\r\n- The object in Acitve Directory does not have any existing values for the property\r\n- You have added a value to the property collection cache\r\n\r\nIt works correctly if the object does have an existing value for the property, or of course with the non-overloaded RefreshCache method.\n\n### Reproduction Steps\n\nYou will need an Active Directory server, and the object guid for an object with no publicDelegates set. Note it\u0027s not limited to publicDelegates so could use another too.\r\n\r\n```csharp\r\nvar directoryEntry = new DirectoryEntry($\"LDAP://{server}/\u003cGUID={objectGuid}\u003e\", username, password, AuthenticationTypes.Sealing | AuthenticationTypes.Secure | AuthenticationTypes.Signing);\r\n           \r\ndirectoryEntry.RefreshCache(new string[] { \"publicDelegates\" });\r\n\r\nvar delegates = directoryEntry.Properties[\"publicDelegates\"];\r\n\t\t  \r\n// If this GUID is invalid then commit changes throws an error. If it is valid then it gets added\r\ndelegates.Add(\"\u003cGUID=8d80e043-4aaf-4439-9549-acea08998e74\u003e\");\r\ndirectoryEntry.RefreshCache(new string[] { \"publicDelegates\" });\r\n\r\ndirectoryEntry.CommitChanges();\r\n```\r\n\r\nUsing the non-overloaded RefreshCache works correctly and the object has no changes made to it (and no exception if the GUID is invalid):\r\n```csharp\r\nvar directoryEntry = new DirectoryEntry($\"LDAP://{server}/\u003cGUID={objectGuid}\u003e\", username, password, AuthenticationTypes.Sealing | AuthenticationTypes.Secure | AuthenticationTypes.Signing);\r\n           \r\ndirectoryEntry.RefreshCache(new string[] { \"publicDelegates\" });\r\n\r\nvar delegates = directoryEntry.Properties[\"publicDelegates\"];\r\n\t\t  \r\ndelegates.Add(\"\u003cGUID=8d80e043-4aaf-4439-9549-acea08998e74\u003e\");\r\ndirectoryEntry.RefreshCache();\r\n\r\ndirectoryEntry.CommitChanges();\r\n```\n\n### Expected behavior\n\nCalling `RefreshCache(String[])` should clear the cache for all properties provided, even if the object bound to has no values for the property.\n\n### Actual behavior\n\nCalling `RefreshCache(String[])` does not clear the cache properties provided where the object bound has no existing values.\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\nUse the `RefreshCache()` overload which may mean more data than required is read in.\n\n### Configuration\n\n.NET6\r\nWindows 11\r\nx64\n\n### Other information\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOXsm98g==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5eJbhF",
                                           "createdAt":  "2023-06-06T22:18:29Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nThe DirectoryEntry.RefreshCache method has an overload to take in just a limited number of properties to refresh.\r\n[See Documentation](https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.directoryentry.refreshcache?view=dotnet-plat-ext-7.0#system-directoryservices-directoryentry-refreshcache(system-string()))\r\n\r\nThis does not seem to refresh the cache for a property when:\r\n- The object in Acitve Directory does not have any existing values for the property\r\n- You have added a value to the property collection cache\r\n\r\nIt works correctly if the object does have an existing value for the property, or of course with the non-overloaded RefreshCache method.\n\n### Reproduction Steps\n\nYou will need an Active Directory server, and the object guid for an object with no publicDelegates set. Note it\u0027s not limited to publicDelegates so could use another too.\r\n\r\n```csharp\r\nvar directoryEntry = new DirectoryEntry($\"LDAP://{server}/\u003cGUID={objectGuid}\u003e\", username, password, AuthenticationTypes.Sealing | AuthenticationTypes.Secure | AuthenticationTypes.Signing);\r\n           \r\ndirectoryEntry.RefreshCache(new string[] { \"publicDelegates\" });\r\n\r\nvar delegates = directoryEntry.Properties[\"publicDelegates\"];\r\n\t\t  \r\n// If this GUID is invalid then commit changes throws an error. If it is valid then it gets added\r\ndelegates.Add(\"\u003cGUID=8d80e043-4aaf-4439-9549-acea08998e74\u003e\");\r\ndirectoryEntry.RefreshCache(new string[] { \"publicDelegates\" });\r\n\r\ndirectoryEntry.CommitChanges();\r\n```\r\n\r\nUsing the non-overloaded RefreshCache works correctly and the object has no changes made to it (and no exception if the GUID is invalid):\r\n```csharp\r\nvar directoryEntry = new DirectoryEntry($\"LDAP://{server}/\u003cGUID={objectGuid}\u003e\", username, password, AuthenticationTypes.Sealing | AuthenticationTypes.Secure | AuthenticationTypes.Signing);\r\n           \r\ndirectoryEntry.RefreshCache(new string[] { \"publicDelegates\" });\r\n\r\nvar delegates = directoryEntry.Properties[\"publicDelegates\"];\r\n\t\t  \r\ndelegates.Add(\"\u003cGUID=8d80e043-4aaf-4439-9549-acea08998e74\u003e\");\r\ndirectoryEntry.RefreshCache();\r\n\r\ndirectoryEntry.CommitChanges();\r\n```\n\n### Expected behavior\n\nCalling `RefreshCache(String[])` should clear the cache for all properties provided, even if the object bound to has no values for the property.\n\n### Actual behavior\n\nCalling `RefreshCache(String[])` does not clear the cache properties provided where the object bound has no existing values.\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\nUse the `RefreshCache()` overload which may mean more data than required is read in.\n\n### Configuration\n\n.NET6\r\nWindows 11\r\nx64\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003ehellblade\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-06-06T22:18:29Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5eKNmx",
                                           "createdAt":  "2023-06-07T01:51:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Does this repro in .NET Framework?",
                                           "updatedAt":  "2023-06-07T01:51:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5eKVM_",
                                           "createdAt":  "2023-06-07T02:19:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "hellblade",
                                           "body":  "@danmoseley Yeah, just tried now and it happens with .NET Framework 4.8 also.",
                                           "updatedAt":  "2023-06-07T02:19:22Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ewJFC",
                                           "createdAt":  "2023-06-13T16:46:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "The logic looks fairly straighfoward: https://github.com/dotnet/runtime/blob/32440e59f7363f9ce8d31ae40523b09de9bccada/src/libraries/System.DirectoryServices/src/System/DirectoryServices/DirectoryEntry.cs#L956\r\n\r\nBasically, remove the property from the underlying dictionary which will then get re-populated lazily when the property is accessed again.\r\n\r\nPerhaps try this:\r\n```cs\r\ndirectoryEntry.Properties[\"publicDelegates\"].Add(\"\u003cGUID=8d80e043-4aaf-4439-9549-acea08998e74\u003e\");\r\n```\r\ninstead of\r\n```cs\r\ndelegates.Add(\"\u003cGUID=8d80e043-4aaf-4439-9549-acea08998e74\u003e\");\r\n```",
                                           "updatedAt":  "2023-06-13T16:46:15Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5eyb3y",
                                           "createdAt":  "2023-06-14T01:10:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "hellblade",
                                           "body":  "Yeah, from that method code nothing stands out. I can see it has removed the value from the underlying dictionary, although the property collection looks to have loaded all properties somehow so it might be another spot affecting it.\r\n\r\n`directoryEntry.Properties[\"publicDelegates\"].Add(\"\u003cGUID=8d80e043-4aaf-4439-9549-acea08998e74\u003e\");`\r\nStill seems to have the same result.\r\n\r\nHere\u0027s just before the Refresh Cache gets called:\r\n![image](https://github.com/dotnet/runtime/assets/3614290/d491d6bf-17f1-48ec-8ca6-3617158fcdc1)\r\n\r\nAnd after, the underlying collection is empty but the overall count of the PropertiesCollection is now all the attributes plus the new one.\r\n![image](https://github.com/dotnet/runtime/assets/3614290/e69beed7-9dbb-4f9a-af34-44d2782ec6db)\r\n\r\n\r\n",
                                           "updatedAt":  "2023-06-14T01:10:08Z"
                                       }
                                   ],
                         "totalCount":  5
                     },
        "title":  "DirectoryEntry RefreshCache for property subset not clearing uncommitted changes",
        "labels":  [
                       "area-System.DirectoryServices",
                       "discussion"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/87589",
        "createdAt":  "2023-06-15T02:12:36Z",
        "number":  87589,
        "author":  "dlnash18",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-09-04T08:55:08Z",
        "body":  "### Description\n\nI have PowerShell code to query a DC via LDAP that hangs in .NET 7.0.102 on macOS Ventura. This has been happening for at least a year across several versions of .NET and macOS. Almost identical code, differing only in `SessionOptions.StartTransportLayerSecurity($null)` instead of `SessionOptions.SecureSocketLayer = $true` and targeting OpenLDAP instead of AD, works fine. And the code that hangs on macOS works fine in .NET 7.0.304 on Windows.\r\n\r\nThe hang happens in `System.DirectoryServices.Protocols.LdapConnection.SendRequest`. Calling `LdapConnection.Bind` first does not hang, but it also does not prevent `SendRequest` from hanging.\n\n### Reproduction Steps\n\n```\r\n$LdapServer     = \u0027host.name.of.a.domain.controller\u0027\r\n$LdapPort       = 636\r\n$LdapDirID      = New-Object System.DirectoryServices.Protocols.LdapDirectoryIdentifier($LdapServer, $LdapPort, $true, $false)                                                      \r\n\r\n$Credential     = Get-Credential\r\n$LdapCred       = New-Object System.Net.NetworkCredential($Credential.Username, $Credential.Password)                                                                               \r\n$LdapAuthType   = [System.DirectoryServices.Protocols.AuthType]\u0027Basic\u0027\r\n\r\n$LdapConnection = New-Object System.DirectoryServices.Protocols.LdapConnection($LdapDirID, $LdapCred, $LdapAuthType)                                                              \r\n$LdapConnection.SessionOptions.SecureSocketLayer = $true\r\n\r\n$LdapBase       = \u0027dc=abc,dc=xyz,dc=edu\u0027\r\n$LdapFilter     = \u0027(samaccountname=MeMyselfAndI)\u0027\r\n$LdapScope      = [System.DirectoryServices.Protocols.SearchScope]\u0027Subtree\u0027\r\n$SearchRequest  = New-Object System.DirectoryServices.Protocols.SearchRequest($LdapBase, $LdapFilter, $LdapScope)                                                                  \r\n\r\n$LdapConnection.Bind()\r\n$SearchResponse = $LdapConnection.SendRequest($SearchRequest) # Hangs forever\r\n```\r\nChanging these three lines makes it work:\r\n```\r\n$LdapServer     = \u0027host.name.of.an.OpenLDAP.server\u0027\r\n$LdapPort       = 389\r\n$LdapConnection.SessionOptions.StartTransportLayerSecurity($null)\r\n```\r\n\n\n### Expected behavior\n\nI get a response from the LDAP server.\n\n### Actual behavior\n\n`LdapConnection.SendRequest` hangs so badly that ^C won\u0027t stop it. I have to close the terminal window, which I have verified does kill the process (three cheers for SIGHUP).\n\n### Regression?\n\nIt has never worked in .NET 7 in my observation, but I don\u0027t claim to have tested every version.\n\n### Known Workarounds\n\nNo workaround.\n\n### Configuration\n\n```\r\n.NET SDK:\r\n Version:   7.0.102\r\n Commit:    4bbdd14480\r\n\r\nRuntime Environment:\r\n OS Name:     Mac OS X\r\n OS Version:  13.4\r\n OS Platform: Darwin\r\n RID:         osx.13-x64\r\n\r\nPowerShell 7.3.1\r\n```\r\nEarlier versions of both .NET 7 and macOS exhibit the problem. .NET 7 on Windows does not, at least not as of:\r\n```\r\n.NET SDK:\r\n Version:   7.0.304\r\n Commit:    7e794e2806\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.17763\r\n OS Platform: Windows\r\n RID:         win10-x64\r\n\r\nPowerShell 7.3.4\r\n```\n\n### Other information\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOwd1ohw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5e55f-",
                                           "createdAt":  "2023-06-15T02:12:46Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nI have PowerShell code to query a DC via LDAP that hangs in .NET 7.0.102 on macOS Ventura. This has been happening for at least a year across several versions of .NET and macOS. Almost identical code, differing only in `SessionOptions.StartTransportLayerSecurity($null)` instead of `SessionOptions.SecureSocketLayer = $true` and targeting OpenLDAP instead of AD, works fine. And the code that hangs on macOS works fine in .NET 7.0.304 on Windows.\r\n\r\nThe hang happens in `System.DirectoryServices.Protocols.LdapConnection.SendRequest`. Calling `LdapConnection.Bind` first does not hang, but it also does not prevent `SendRequest` from hanging.\n\n### Reproduction Steps\n\n```\r\n$LdapServer     = \u0027host.name.of.a.domain.controller\u0027\r\n$LdapPort       = 636\r\n$LdapDirID      = New-Object System.DirectoryServices.Protocols.LdapDirectoryIdentifier($LdapServer, $LdapPort, $true, $false)                                                      \r\n\r\n$Credential     = Get-Credential\r\n$LdapCred       = New-Object System.Net.NetworkCredential($Credential.Username, $Credential.Password)                                                                               \r\n$LdapAuthType   = [System.DirectoryServices.Protocols.AuthType]\u0027Basic\u0027\r\n\r\n$LdapConnection = New-Object System.DirectoryServices.Protocols.LdapConnection($LdapDirID, $LdapCred, $LdapAuthType)                                                              \r\n$LdapConnection.SessionOptions.SecureSocketLayer = $true\r\n\r\n$LdapBase       = \u0027dc=abc,dc=xyz,dc=edu\u0027\r\n$LdapFilter     = \u0027(samaccountname=MeMyselfAndI)\u0027\r\n$LdapScope      = [System.DirectoryServices.Protocols.SearchScope]\u0027Subtree\u0027\r\n$SearchRequest  = New-Object System.DirectoryServices.Protocols.SearchRequest($LdapBase, $LdapFilter, $LdapScope)                                                                  \r\n\r\n$LdapConnection.Bind()\r\n$SearchResponse = $LdapConnection.SendRequest($SearchRequest) # Hangs forever\r\n```\r\nChanging these three lines makes it work:\r\n```\r\n$LdapServer     = \u0027host.name.of.an.OpenLDAP.server\u0027\r\n$LdapPort       = 389\r\n$LdapConnection.SessionOptions.StartTransportLayerSecurity($null)\r\n```\r\n\n\n### Expected behavior\n\nI get a response from the LDAP server.\n\n### Actual behavior\n\n`LdapConnection.SendRequest` hangs so badly that ^C won\u0027t stop it. I have to close the terminal window, which I have verified does kill the process (three cheers for SIGHUP).\n\n### Regression?\n\nIt has never worked in .NET 7 in my observation, but I don\u0027t claim to have tested every version.\n\n### Known Workarounds\n\nNo workaround.\n\n### Configuration\n\n```\r\n.NET SDK:\r\n Version:   7.0.102\r\n Commit:    4bbdd14480\r\n\r\nRuntime Environment:\r\n OS Name:     Mac OS X\r\n OS Version:  13.4\r\n OS Platform: Darwin\r\n RID:         osx.13-x64\r\n\r\nPowerShell 7.3.1\r\n```\r\nEarlier versions of both .NET 7 and macOS exhibit the problem. .NET 7 on Windows does not, at least not as of:\r\n```\r\n.NET SDK:\r\n Version:   7.0.304\r\n Commit:    7e794e2806\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.17763\r\n OS Platform: Windows\r\n RID:         win10-x64\r\n\r\nPowerShell 7.3.4\r\n```\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003edlnash18\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-06-15T02:12:46Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5f4AcK",
                                           "createdAt":  "2023-06-27T00:16:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e and targeting OpenLDAP instead of AD\r\n\r\nNot sure if it is expected to work on Mac, by my understanding AD is windows only, correct me if I am wrong @joperezr ",
                                           "updatedAt":  "2023-06-27T00:16:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5gEEmE",
                                           "createdAt":  "2023-06-28T15:47:32Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dlnash18",
                                           "body":  "\u003e \u003e and targeting OpenLDAP instead of AD\r\n\u003e \r\n\u003e Not sure if it is expected to work on Mac, by my understanding AD is windows only, correct me if I am wrong @joperezr\r\n\r\nThis is vanilla LDAP, not ADSI or anything Windows-specific like that. I send LDAP queries to domain controllers from my Mac all the time, I just can\u0027t make it work in .NET.",
                                           "updatedAt":  "2023-06-28T15:47:32Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5hqh5o",
                                           "createdAt":  "2023-07-17T17:07:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e This is vanilla LDAP, not ADSI or anything Windows-specific like that. \r\n\r\nSorry I could not find anything like `vanilla LDAP`, it seems you are using vanilla to connect to a LDAP server, so the question is what LDAP server you are using? For further investigation we need to reproduce the issue you are encountering. It would be great if you could provide a sample repro.",
                                           "updatedAt":  "2023-07-17T17:07:22Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5hqiL1",
                                           "createdAt":  "2023-07-17T17:07:46Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been marked `needs-author-action` and may be missing some important information.",
                                           "updatedAt":  "2023-07-17T17:07:46Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5i5La3",
                                           "createdAt":  "2023-07-31T21:01:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been automatically marked `no-recent-activity` because it has not had any activity for 14 days. It will be closed if no further activity occurs within 14 more days. Any new comment (by anyone, not necessarily the author) will remove `no-recent-activity`.",
                                           "updatedAt":  "2023-07-31T21:01:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5j3v3C",
                                           "createdAt":  "2023-08-12T00:16:35Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODsAPTQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "davidrichmond-asurion",
                                                                               "createdAt":  "2024-02-17T20:00:03Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "Griboedow",
                                                                               "createdAt":  "2024-07-29T18:46:04Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  2
                                                         },
                                           "author":  "dlnash18",
                                           "body":  "Excuse me, \"vanilla\" is American slang for \"plain and uninteresting.\" My point was that I\u0027m using a vendor-neutral protocol to query the domain controller, not an AD-specific mechanism. The AD server software is indeed Windows-only, but it implements LDAP, and LDAP is a vendor-neutral standard. The .NET `System.DirectoryServices.Protocols` namespace provides access to LDAP as documented at https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.protocols. I am able to use this LDAP client on macOS to query non-AD LDAP servers. And I am able to use the LDAP client built into macOS to query domain controllers, so the problem isn\u0027t that our DCs are having some sort of LDAP problems. The problem is quite specifically that the .NET LDAP client on macOS cannot query a DC.\r\n\r\nAll three of these elements are required to make the problem manifest:\r\n1. Use of the .NET `System.DirectoryServices.Protocols` LDAP client,\r\n2. on macOS (the problem does not manifest in .NET 7 on Windows),\r\n3. querying an AD DC (the problem does not manifest when querying a non-AD server like OpenLDAP).",
                                           "updatedAt":  "2023-08-12T00:40:15Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc7B3WiH",
                                           "createdAt":  "2025-09-04T08:35:51Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "Islandskiy",
                                           "body":  "I confirm the same behavior: on Mac OS execution hangs on `.SendRequest()`. What\u0027s interesting is that the request actually executes and returns data, but hangs somewhere at the end. Below are screenshots from Wireshark from the moment of `.Bind()` execution until the end of `.SendRequest()` execution.\nIn my case target LDAP is Active Directory, I don\u0027t know the server version, but I can clarify if it helps.\n\n### Example code to reproduce\n\n```cs\nusing System.DirectoryServices.Protocols;\nusing System.Net;\n\nconst string userName = \"\u003clogin\u003e\";\nconst string password = \"\u003cpassword\u003e\";\nconst string server = \"\u003cserver\u003e\";\nconst string dn = \"DC=example,DC=com\";\n    \nvar credential = new NetworkCredential(userName, password);\n\nvar identifier = new LdapDirectoryIdentifier(server, 389);\n\nusing var connection = new LdapConnection(identifier, credential, AuthType.Basic);\nconnection.SessionOptions.ProtocolVersion = 3;\nconnection.Bind();\n    \nvar searchRequest = new SearchRequest(dn, \"(objectClass=organizationalUnit)\", SearchScope.Subtree, null);\nvar searchResponse = (SearchResponse)connection.SendRequest(searchRequest, TimeSpan.FromSeconds(5));\n\nConsole.WriteLine(searchResponse.Entries.Count);\n```\nThe version of `System.DirectoryServices.Protocols` nuget package is `9.0.8`\n\n### OS Environment (`sw_vers`)\n```\nProductName:\t\tmacOS\nProductVersion:\t\t15.6.1\nBuildVersion:\t\t24G90\n```\n\n### .NET info (`dotnet --info`)\n```\n.NET SDK:\n Version:           9.0.301\n Commit:            a596cd22e2\n Workload version:  9.0.300-manifests.f856936c\n MSBuild version:   17.14.5+edd3bbf37\n\nRuntime Environment:\n OS Name:     Mac OS X\n OS Version:  15.6\n OS Platform: Darwin\n RID:         osx-arm64\n Base Path:   /usr/local/share/dotnet/sdk/9.0.301/\n\n.NET workloads installed:\nThere are no installed workloads to display.\nConfigured to use loose manifests when installing new manifests.\n\nHost:\n  Version:      9.0.6\n  Architecture: arm64\n  Commit:       3875b54e7b\n```\n\n### Wireshark dump screens\n\nBeginning of the exchange:\n\u003cimg width=\"1640\" height=\"524\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ad76c46a-ae16-4caf-9fa6-551a58bb47d5\" /\u003e\n\nThe dump place where the search request hangs:\n\n\u003cimg width=\"1640\" height=\"146\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c9cdec9d-7357-4a3e-9b34-757cb37ed342\" /\u003e\n",
                                           "updatedAt":  "2025-09-04T08:55:08Z"
                                       }
                                   ],
                         "totalCount":  8
                     },
        "title":  "Querying a DC via System.DirectoryServices.Protocols hangs on macOS",
        "labels":  [
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/91255",
        "createdAt":  "2023-08-29T08:52:49Z",
        "number":  91255,
        "author":  "skloepp2",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-11-13T09:46:29Z",
        "body":  "### Description\r\n\r\nI want to find invalid objects in our directory which have a mail attribute set with an empty value =\u003e mail=\"\"\r\nMy LDAP Filter is (mail=) which is working in Apache Directory Studio or third party ldap libraries.\r\nAfter switching back to system.directoryservices.protocolls, these ldap queries are failing with \"invalid ldap filter\".\r\n\r\n### Reproduction Steps\r\n\r\nExecute a SearchRequest with filter =\u003e \"(mail=)\" the result is a \"invalid ldap filter\" error\r\n\r\n### Expected behavior\r\n\r\nNo error\r\n\r\n### Actual behavior\r\n\r\n\"invalid ldap filter\" error occours\r\n\r\n### Regression?\r\n\r\n_No response_\r\n\r\n### Known Workarounds\r\n\r\nUsing filter (mail=\\00) works and finds objects with an empty value.\r\n\r\n### Configuration\r\n\r\n_No response_\r\n\r\n### Other information\r\n\r\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOa8DPRA==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5lJqnF",
                                           "createdAt":  "2023-08-29T08:52:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nI want to find invalid objects in our directory which have a mail attribute set with an empty value =\u003e mail=\"\"\r\nMy LDAP Filter is (mail=) which is working in Apache Directory Studio or third party ldap libraries.\r\nAfter switching back to system.directoryservices.protocolls, these ldap queries are failing with \"invalid ldap filter\".\n\n### Reproduction Steps\n\nExecute a SearchRequest with filter =\u003e \"(mail=)\" the result is a \"invalid ldap filter\" error\n\n### Expected behavior\n\nNo error\n\n### Actual behavior\n\n\"invalid ldap filter\" error occours\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eskloepp2\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-08-29T08:52:57Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5lLbNB",
                                           "createdAt":  "2023-08-29T13:55:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "Does `(!mail=*)` work?",
                                           "updatedAt":  "2023-08-29T13:55:04Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5lLbUh",
                                           "createdAt":  "2023-08-29T13:55:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been marked `needs-author-action` and may be missing some important information.",
                                           "updatedAt":  "2023-08-29T13:55:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5lMnSt",
                                           "createdAt":  "2023-08-29T16:46:24Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "skloepp2",
                                           "body":  "\u003e Does `(!mail=*)` work?\r\n\r\nNo that would not be a valid ldap filter. `(!(mail=*))` is what you mean, but that would find all objects without a value in mail. What I an looking for is for objects with an empty value set. The workaround is as mentioned `(mail=\\00)`.",
                                           "updatedAt":  "2023-08-29T16:46:24Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5lTrha",
                                           "createdAt":  "2023-08-30T18:34:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "Does `mail=\\00` work on Apache Directory Studio and the third party ldap libraries you mentioned earlier?\r\n\r\nAlso are you on Windows or a version of Linux (or both)?",
                                           "updatedAt":  "2023-08-30T18:34:57Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5lnQGi",
                                           "createdAt":  "2023-09-04T07:55:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "skloepp2",
                                           "body":  "`mail=\\00` is a workaround for System.DirectoryServices.Protocolls. But it also works on third party libraries and Apache Directory Studio.\r\n\r\nI\u0027m developing on both Windows and Linux.",
                                           "updatedAt":  "2023-09-04T07:55:15Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5qMCoM",
                                           "createdAt":  "2023-10-26T17:27:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "Pinging System.DirectoryServices consultants @BRDPM @grubioe @jay98014 for thoughts on this. Thanks.",
                                           "updatedAt":  "2023-10-26T17:27:58Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5qN8Dn",
                                           "createdAt":  "2023-10-26T23:11:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "BRDPM",
                                           "body":  "Hi there! Is there any reason the workaround isn\u0027t sufficient?",
                                           "updatedAt":  "2023-10-26T23:11:30Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5qSRD6",
                                           "createdAt":  "2023-10-27T16:13:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been marked `needs-author-action` and may be missing some important information.",
                                           "updatedAt":  "2023-10-27T16:13:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5rq9sF",
                                           "createdAt":  "2023-11-10T21:01:16Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been automatically marked `no-recent-activity` because it has not had any activity for 14 days. It will be closed if no further activity occurs within 14 more days. Any new comment (by anyone, not necessarily the author) will remove `no-recent-activity`.",
                                           "updatedAt":  "2023-11-10T21:01:16Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5rwM9E",
                                           "createdAt":  "2023-11-13T09:46:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "skloepp2",
                                           "body":  "\u003e Hi there! Is there any reason the workaround isn\u0027t sufficient?\r\n\r\nAll other libraries and tools I have used are working without that workaround. So it\u0027s just a better user expirience when you fix/change that ;-)",
                                           "updatedAt":  "2023-11-13T09:46:23Z"
                                       }
                                   ],
                         "totalCount":  11
                     },
        "title":  "Searching with empty attribute value results in an invalid filter error",
        "labels":  [
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/92221",
        "createdAt":  "2023-09-18T14:17:42Z",
        "number":  92221,
        "author":  "skloepp2",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-11-13T09:48:05Z",
        "body":  "### Description\n\nWe have some objects in our directory that have an empty string as attribute value e.g. description = \"\". The attribute is not empty!\r\nWhen searching with  System.DirectoryServices.Protocols the SearchResponse will return this attribute with an empty list as values but the respose shoult be a list with one value =\u003e []{ \"\" }\n\n### Reproduction Steps\n\n- Add the attribute description with value \"\" to an object\r\n- Search that object and require the attribute description\r\n- The value list will be empty\n\n### Expected behavior\n\nThe list should contain an empty string =\u003e [] { \"\" }\n\n### Actual behavior\n\nThe response returns an empty list =\u003e [] { }\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOa8DZFQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5muten",
                                           "createdAt":  "2023-09-18T14:17:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nWe have some objects in our directory that have an empty string as attribute value e.g. description = \"\". The attribute is not empty!\r\nWhen searching with  System.DirectoryServices.Protocols the SearchResponse will return this attribute with an empty list as values but the respose shoult be a list with one value =\u003e []{ \"\" }\n\n### Reproduction Steps\n\n- Add the attribute description with value \"\" to an object\r\n- Search that object and require the attribute description\r\n- The value list will be empty\n\n### Expected behavior\n\nThe list should contain an empty string =\u003e [] { \"\" }\n\n### Actual behavior\n\nThe response returns an empty list =\u003e [] { }\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eskloepp2\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-09-18T14:17:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5mywR6",
                                           "createdAt":  "2023-09-18T23:05:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e ### Description\r\n\u003e \r\n\u003e We have some objects in our directory that have an empty string as attribute value e.g. description = \"\". The attribute is not empty!\r\n\u003e When searching with  System.DirectoryServices.Protocols the SearchResponse will return this attribute with an empty list as values but the respose shoult be a list with one value =\u003e []{ \"\" }\r\n\u003e \r\n\u003e ### Reproduction Steps\r\n\u003e \r\n\u003e - Add the attribute description with value \"\" to an object\r\n\u003e - Search that object and require the attribute description\r\n\u003e - The value list will be empty\r\n\r\n\r\nSorry @skloepp2, I do not completely understand how to repro your issue, please provide a sample app, thank you!",
                                           "updatedAt":  "2023-09-18T23:05:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5mywYr",
                                           "createdAt":  "2023-09-18T23:06:24Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been marked `needs-author-action` and may be missing some important information.",
                                           "updatedAt":  "2023-09-18T23:06:24Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5n9K2-",
                                           "createdAt":  "2023-10-03T03:01:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "This issue has been automatically marked `no-recent-activity` because it has not had any activity for 14 days. It will be closed if no further activity occurs within 14 more days. Any new comment (by anyone, not necessarily the author) will remove `no-recent-activity`.",
                                           "updatedAt":  "2023-10-03T03:01:22Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5n__mi",
                                           "createdAt":  "2023-10-03T12:04:34Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "skloepp2",
                                           "body":  "Hey, sorry for the late response. Not sure what you really need since you need to prepare your environment properly to reproduce it.\r\nHere\u0027s my sample:\r\n\r\n``\r\nvar searchRequest = new SearchRequest(dn, filter, (System.DirectoryServices.Protocols.SearchScope)((int)searchScope), new[]{ \"description\" })\r\n{\r\n    SizeLimit = 0,\r\n    TimeLimit = new TimeSpan(0, 30, 0)\r\n};\r\nvar searchResponse = (SearchResponse)connection.SendRequest(searchRequest);\r\n``\r\n\r\nThe `response.Entries` would contain an entry with the attribute `description` but the `attribute.Value` has an empty list (`[]{}`) instead of a list with one value with an empty string (`[]{\"\"}`)",
                                           "updatedAt":  "2023-10-03T12:04:34Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5rwNkV",
                                           "createdAt":  "2023-11-13T09:48:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "skloepp2",
                                           "body":  "Any update on that one?",
                                           "updatedAt":  "2023-11-13T09:48:05Z"
                                       }
                                   ],
                         "totalCount":  6
                     },
        "title":  "System.DirectoryServices.Protocols - SearchRequest is not returning attribute value with empty string",
        "labels":  [
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/94753",
        "createdAt":  "2023-11-15T06:47:15Z",
        "number":  94753,
        "author":  "achufistov",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-11-22T01:58:03Z",
        "body":  "### Description\n\nDotnet 6.0\r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/Computer.cs:120\r\n\r\nProblem: Value (List\u003cstring\u003e)value, which can have null value due to comparison with null, is dereferenced inside function _servicePrincipalNames.Load().\n\n### Reproduction Steps\n\nTrace:\r\n1) Role: detected\r\ndetected\r\n[Computer.cs:[120:0]]\r\n\r\n2) Role: compared with null\r\nComparison value == null of value (List\u003cstring\u003e)value with null implies that (List\u003cstring\u003e)value can have null value\r\n[Computer.cs:[115:128]]\r\n\r\n3) Role: dereference\r\n3.1 Value (List\u003cstring\u003e)value is dereferenced inside invocation _servicePrincipalNames.Load((List\u003cstring\u003e)value)\r\n[Computer.cs:[120:21]]\r\n3.2 Value values is dereferenced at values.Count\r\n[ValueCollection.cs:[377:102]]\r\n\r\n4) Role: execution path\r\n4.1 Step 1: Condition value == null taking true branch\r\n[Computer.cs:[115:128]]\r\n4.2 Step 2: Condition propertyName == PropertyNames.ComputerServicePrincipalNames taking true branch\r\n[Computer.cs:[119:23]]\n\n### Expected behavior\n\nnull pointer dereference\n\n### Actual behavior\n\nsame\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\nFound by Linux Verification Center (linuxtesting.org) with SVACE.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHObJkJaw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5r_8B4",
                                           "createdAt":  "2023-11-15T07:14:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\nDotnet 6.0\r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/Computer.cs:120\r\n\r\nProblem: Value (List\u003cstring\u003e)value, which can have null value due to comparison with null, is dereferenced inside function _servicePrincipalNames.Load().\n\n### Reproduction Steps\n\nTrace:\r\n1) Role: detected\r\ndetected\r\n[Computer.cs:[120:0]]\r\n\r\n2) Role: compared with null\r\nComparison value == null of value (List\u003cstring\u003e)value with null implies that (List\u003cstring\u003e)value can have null value\r\n[Computer.cs:[115:128]]\r\n\r\n3) Role: dereference\r\n3.1 Value (List\u003cstring\u003e)value is dereferenced inside invocation _servicePrincipalNames.Load((List\u003cstring\u003e)value)\r\n[Computer.cs:[120:21]]\r\n3.2 Value values is dereferenced at values.Count\r\n[ValueCollection.cs:[377:102]]\r\n\r\n4) Role: execution path\r\n4.1 Step 1: Condition value == null taking true branch\r\n[Computer.cs:[115:128]]\r\n4.2 Step 2: Condition propertyName == PropertyNames.ComputerServicePrincipalNames taking true branch\r\n[Computer.cs:[119:23]]\n\n### Expected behavior\n\nnull pointer dereference\n\n### Actual behavior\n\nsame\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\nFound by Linux Verification Center (linuxtesting.org) with SVACE.\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eachufistov\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-11-15T07:14:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5smQlr",
                                           "createdAt":  "2023-11-22T01:57:16Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "This method has several overrides and the virtual method on parent type looks safe null value. There is 2 cases where it is called with null explicitly:\r\n https://github.com/dotnet/runtime/blob/52b4c824710b6bcf2377ebd986fdd01195b8cb1f/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx_LoadStore.cs#L838\r\n\r\nIn general, to determine if the method has nullability issue or not should be determined during nullability annotation for the project, which is tracked by https://github.com/dotnet/runtime/issues/41720. I think we should close this issue as dup of #41720, what you think @achufistov?",
                                           "updatedAt":  "2023-11-22T01:57:16Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "Value (List\u003cstring\u003e)value, which can have null value due to comparison with null, is dereferenced inside function _servicePrincipalNames.Load().",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/94755",
        "createdAt":  "2023-11-15T07:00:42Z",
        "number":  94755,
        "author":  "achufistov",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-01-17T19:47:01Z",
        "body":  "### Description\n\ndotnet 6.0 \r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx.cs:1795\r\nProblem: new RangeRetriever(groupDE, \"member\", false) is not disposed at the end of the function\n\n### Reproduction Steps\n\n1) Role: detected\r\ndetected\r\n[ADStoreCtx.cs:[1795:0]](\r\n\r\n2) Role: tracepoint\r\n2.1 Step 1: Condition g.fakePrincipal taking any branch\r\n[ADStoreCtx.cs:[1750:17]]\r\n2.2 Step 2: Condition p.ContextType != ContextType.Domain taking any branch\r\n[ADStoreCtx.cs:[1757:17]]\r\n2.3 Step 3: Condition g.UnderlyingObject != null taking any branch\r\n[ADStoreCtx.cs:[1763:26]]\r\n2.4 Step 4: Condition p.fakePrincipal taking any branch\r\n[ADStoreCtx.cs:[1768:18]]\r\n2.5 Step 5: Condition Sid == null taking false branch\r\n[ADStoreCtx.cs:[1817:17]]\r\n2.6 Step 6: Condition string.IsNullOrEmpty(this.UserSuppliedServerName) taking any branch\r\n[ADStoreCtx.cs:[1827:42]]\r\n2.7 Step 7: Condition stringSid == null taking false branch\r\n[ADStoreCtx.cs:[1838:21]]\r\n2.8 Step 8: Condition sr == null taking any branch\r\n[ADStoreCtx.cs:[1855:21]]\r\nno escape\r\n[ADStoreCtx.cs:[1861:45]]\r\n2.9 Step 9: Exiting the foreach\r\n[ADStoreCtx.cs:[1861:45]]\r\n2.10 Step 10: Condition cachedMembersEnum is null taking any branch\r\n[ADStoreCtx.cs:[1861:45]]\r\n2.11 Step 11: Condition ds != null taking any branch\r\n[ADStoreCtx.cs:[1876:21]]\r\n2.12 Step 12: Condition defaultNCDirEntry != null taking any branch\r\n[ADStoreCtx.cs:[1880:21]]\n\n### Expected behavior\n\nmemory leak\n\n### Actual behavior\n\nsame\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\nFound by Linux Verification Center (linuxtesting.org) with SVACE.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOcQsofw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5r_72n",
                                           "createdAt":  "2023-11-15T07:14:13Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "hez2010",
                                           "body":  "You are right. It doesn\u0027t get disposed and `RangeRetriever ` also doesn\u0027t have a finalizer to call dispose when being GC-ed.",
                                           "updatedAt":  "2023-11-15T07:14:13Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5r_9oT",
                                           "createdAt":  "2023-11-15T07:20:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\ndotnet 6.0 \r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADStoreCtx.cs:1795\r\nProblem: new RangeRetriever(groupDE, \"member\", false) is not disposed at the end of the function\n\n### Reproduction Steps\n\n1) Role: detected\r\ndetected\r\n[ADStoreCtx.cs:[1795:0]](\r\n\r\n2) Role: tracepoint\r\n2.1 Step 1: Condition g.fakePrincipal taking any branch\r\n[ADStoreCtx.cs:[1750:17]]\r\n2.2 Step 2: Condition p.ContextType != ContextType.Domain taking any branch\r\n[ADStoreCtx.cs:[1757:17]]\r\n2.3 Step 3: Condition g.UnderlyingObject != null taking any branch\r\n[ADStoreCtx.cs:[1763:26]]\r\n2.4 Step 4: Condition p.fakePrincipal taking any branch\r\n[ADStoreCtx.cs:[1768:18]]\r\n2.5 Step 5: Condition Sid == null taking false branch\r\n[ADStoreCtx.cs:[1817:17]]\r\n2.6 Step 6: Condition string.IsNullOrEmpty(this.UserSuppliedServerName) taking any branch\r\n[ADStoreCtx.cs:[1827:42]]\r\n2.7 Step 7: Condition stringSid == null taking false branch\r\n[ADStoreCtx.cs:[1838:21]]\r\n2.8 Step 8: Condition sr == null taking any branch\r\n[ADStoreCtx.cs:[1855:21]]\r\nno escape\r\n[ADStoreCtx.cs:[1861:45]]\r\n2.9 Step 9: Exiting the foreach\r\n[ADStoreCtx.cs:[1861:45]]\r\n2.10 Step 10: Condition cachedMembersEnum is null taking any branch\r\n[ADStoreCtx.cs:[1861:45]]\r\n2.11 Step 11: Condition ds != null taking any branch\r\n[ADStoreCtx.cs:[1876:21]]\r\n2.12 Step 12: Condition defaultNCDirEntry != null taking any branch\r\n[ADStoreCtx.cs:[1880:21]]\n\n### Expected behavior\n\nmemory leak\n\n### Actual behavior\n\nsame\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\nFound by Linux Verification Center (linuxtesting.org) with SVACE.\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eachufistov\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-11-15T07:20:30Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5sPUU-",
                                           "createdAt":  "2023-11-17T08:48:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODS_8Xw==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "buyaa-n",
                                                                               "createdAt":  "2024-01-17T19:46:34Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "achufistov",
                                           "body":  "\u003e You are right. It doesn\u0027t get disposed and `RangeRetriever ` also doesn\u0027t have a finalizer to call dispose when being GC-ed.\r\n\r\nI would like to suggest a pull request.",
                                           "updatedAt":  "2023-11-17T08:48:25Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5sPnAG",
                                           "createdAt":  "2023-11-17T09:33:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODS_8Fg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "buyaa-n",
                                                                               "createdAt":  "2024-01-17T19:46:00Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "The code owners would likely welcome a PR or PRs for these. The library is considered mature so there is a risk calculus. There is the question of testing but such changes are often hard to write a test for.",
                                           "updatedAt":  "2023-11-17T09:33:15Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xCyh_",
                                           "createdAt":  "2024-01-17T19:47:00Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e I would like to suggest a pull request.\r\n\r\nThank you @achufistov, feel free to offer a fix",
                                           "updatedAt":  "2024-01-17T19:47:00Z"
                                       }
                                   ],
                         "totalCount":  5
                     },
        "title":  "new RangeRetriever(groupDE, \"member\", false) is not disposed at the end of the function",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/94772",
        "createdAt":  "2023-11-15T13:36:52Z",
        "number":  94772,
        "author":  "achufistov",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-01-17T20:00:40Z",
        "body":  "### Description\r\n\r\ndotnet 6.0 \r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/User.cs:184\r\n\r\nProblem: new PrincipalContext(ContextType.Machine) is not disposed at the end of the function\r\n\r\n### Reproduction Steps\r\n\r\n1) Role: detected\r\ndetected\r\n[User.cs:[184:0]]\r\n\r\n2) Role: tracepoint\r\n2.1 Step 1: Condition Utils.IsSamUser() taking true branch\r\n[User.cs:[179:21]]\r\n2.2 created in constructor System.DirectoryServices.AccountManagement.PrincipalContext.PrincipalContext(System.DirectoryServices.AccountManagement.ContextType)\r\n[User.cs:[184:31]]\r\n2.3 no escape\r\n[User.cs:[184:31]]\r\n2.4 assigned\r\n[User.cs:[184:21]]\r\n2.5 no escape\r\n[User.cs:[215:28]]\r\n2.6 Step 2: Condition pSid != IntPtr.Zero taking any branch\r\n[User.cs:[219:25]]\r\n2.7 Step 3: Condition user == null taking false branch\r\n[User.cs:[225:21]]\r\n2.8 return\r\n[User.cs:[231:24]]\r\n\r\n### Expected behavior\r\n\r\nmemory leak\r\n\r\n### Actual behavior\r\n\r\nmemory leak\r\n\r\n### Regression?\r\n\r\n_No response_\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Configuration\r\n\r\n_No response_\r\n\r\n### Other information\r\n\r\nFound by Linux Verification Center (linuxtesting.org) with SVACE.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOcQvBcQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5sCVNn",
                                           "createdAt":  "2023-11-15T13:36:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\ndotnet 6.0 \r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/User.cs\r\n\r\nProblem: new PrincipalContext(ContextType.Machine) is not disposed at the end of the function\n\n### Reproduction Steps\n\n1) Role: detected\r\ndetected\r\n[User.cs:[184:0]]\r\n\r\n2) Role: tracepoint\r\n2.1 Step 1: Condition Utils.IsSamUser() taking true branch\r\n[User.cs:[179:21]]\r\n2.2 created in constructor System.DirectoryServices.AccountManagement.PrincipalContext.PrincipalContext(System.DirectoryServices.AccountManagement.ContextType)\r\n[User.cs:[184:31]]\r\n2.3 no escape\r\n[User.cs:[184:31]]\r\n2.4 assigned\r\n[User.cs:[184:21]]\r\n2.5 no escape\r\n[User.cs:[215:28]]\r\n2.6 Step 2: Condition pSid != IntPtr.Zero taking any branch\r\n[User.cs:[219:25]]\r\n2.7 Step 3: Condition user == null taking false branch\r\n[User.cs:[225:21]]\r\n2.8 return\r\n[User.cs:[231:24]]\n\n### Expected behavior\n\nmemory leak\n\n### Actual behavior\n\nmemory leak\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\nFound by Linux Verification Center (linuxtesting.org) with SVACE.\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eachufistov\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-11-15T13:36:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5sPTHU",
                                           "createdAt":  "2023-11-17T08:44:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "achufistov",
                                           "body":  "I would like to suggest a pull request.",
                                           "updatedAt":  "2023-11-17T08:44:14Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xC8Fx",
                                           "createdAt":  "2024-01-17T20:00:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e I would like to suggest a pull request.\r\n\r\nThank you @achufistov feel free to offer a fix, please cover fixes for #94774, #94777, #94771, #94775 and #94776 in it",
                                           "updatedAt":  "2024-01-17T20:00:18Z"
                                       }
                                   ],
                         "totalCount":  3
                     },
        "title":  "new PrincipalContext(ContextType.Machine) is not disposed at the end of the function",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/94779",
        "createdAt":  "2023-11-15T14:05:20Z",
        "number":  94779,
        "author":  "achufistov",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-01-17T19:21:21Z",
        "body":  "### Description\n\ndotnet 6.0\r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/SAM/SAMStoreCtx.cs:592\r\n\r\nProblem: SDSUtils.BuildDirectoryEntry(_ctxBase.Path, _credentials, _authTypes) is not disposed at the end of the function\n\n### Reproduction Steps\n\n1) Role: detected\r\ndetected\r\n[SAMStoreCtx.cs:[592:0]]\r\n\r\n2) Role: tracepoint\r\n2.1 created in method System.DirectoryServices.AccountManagement.SDSUtils.BuildDirectoryEntry(string, System.DirectoryServices.AccountManagement.NetCred, System.DirectoryServices.AuthenticationTypes)\r\n[SAMStoreCtx.cs:[592:40]]\r\n2.2 no escape\r\n[SAMStoreCtx.cs:[592:40]]\r\n2.3 return\r\n[SAMStoreCtx.cs:[607:20]]\n\n### Expected behavior\n\nmemory leak\n\n### Actual behavior\n\nmemory leak\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\nFound by Linux Verification Center (linuxtesting.org) with SVACE.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOcQoYTA==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5sCgN6",
                                           "createdAt":  "2023-11-15T14:05:26Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\ndotnet 6.0\r\n\r\nFile: /src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/SAM/SAMStoreCtx.cs:592\r\n\r\nProblem: SDSUtils.BuildDirectoryEntry(_ctxBase.Path, _credentials, _authTypes) is not disposed at the end of the function\n\n### Reproduction Steps\n\n1) Role: detected\r\ndetected\r\n[SAMStoreCtx.cs:[592:0]]\r\n\r\n2) Role: tracepoint\r\n2.1 created in method System.DirectoryServices.AccountManagement.SDSUtils.BuildDirectoryEntry(string, System.DirectoryServices.AccountManagement.NetCred, System.DirectoryServices.AuthenticationTypes)\r\n[SAMStoreCtx.cs:[592:40]]\r\n2.2 no escape\r\n[SAMStoreCtx.cs:[592:40]]\r\n2.3 return\r\n[SAMStoreCtx.cs:[607:20]]\n\n### Expected behavior\n\nmemory leak\n\n### Actual behavior\n\nmemory leak\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\nFound by Linux Verification Center (linuxtesting.org) with SVACE.\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eachufistov\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-11-15T14:05:26Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5sPTcs",
                                           "createdAt":  "2023-11-17T08:45:21Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "achufistov",
                                           "body":  "I would like to suggest a pull request.",
                                           "updatedAt":  "2023-11-17T08:45:21Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5xChhM",
                                           "createdAt":  "2024-01-17T19:21:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e I would like to suggest a pull request.\r\n\r\nThank you @achufistov, feel free to offer a PR, please include all similar cases https://github.com/dotnet/runtime/issues/94780 and https://github.com/dotnet/runtime/issues/94781",
                                           "updatedAt":  "2024-01-17T19:21:20Z"
                                       }
                                   ],
                         "totalCount":  3
                     },
        "title":  "SDSUtils.BuildDirectoryEntry(_ctxBase.Path, _credentials, _authTypes) is not disposed at the end of the function",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/95676",
        "createdAt":  "2023-12-06T08:58:55Z",
        "number":  95676,
        "author":  "daabm",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2023-12-13T20:02:58Z",
        "body":  "Running as user from Forest/Domain  A on a computer in Forest/Domain B, calling UserPrincipal.GetAuthorizationGroups() for user throws above exception.\r\n\r\nhttps://github.com/dotnet/runtime/blob/c08faf9216976a14f06a11373fbd3aec7671bf7a/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADUtils.cs#L430\r\n\r\nFunction VerifyOutboundTrust is broken when running on a computer that is in a different forest than the user _and_ trying to verify a trust to the user\u0027s domain.\r\nLine 436 defaults to the computer domain:\r\n`\r\n                currentDom = Domain.GetComputerDomain();\r\n`\r\nLine  471 defaults to the user forest (which in this case is different from the computer domain/forest):\r\n`\r\n            Forest currentForest = Forest.GetCurrentForest();\r\n`\r\nLine 452 does not match because here we are verifying targetDomain against the computer domain:\r\n`\r\n            if (string.Equals(currentDom.Name, targetDomain, StringComparison.OrdinalIgnoreCase))\r\n`\r\nOutcome is that line 477 tries to verify a trust from the passed in \"targetDomain\" against the current user\u0027s domain:\r\n`\r\n                ForestTrustRelationshipInformation FTC = currentForest.GetTrustRelationship(targetdom.Forest.Name);\r\n`\r\nThis throws an exception because targetDomain and currentForest are the same - and a forest can never have a trust with itself:\r\n`\r\nException calling \"GetTrustRelationship\" with \"1\" argument(s): \"A forest trust relationship does not exist between \r\n\"corp.contoso.com\" and \"corp.contoso.com\".\"\r\n`\r\n\r\nThe function should maintain context by not using GetComputerDomain(), but GetCurrentDomain().\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHObotN2g==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5t5ARB",
                                           "createdAt":  "2023-12-06T20:43:03Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\nRunning as user from Forest/Domain  A on a computer in Forest/Domain B, calling UserPrincipal.GetAuthorizationGroups() for user throws above exception.\r\n\r\nhttps://github.com/dotnet/runtime/blob/c08faf9216976a14f06a11373fbd3aec7671bf7a/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/AD/ADUtils.cs#L430\r\n\r\nFunction VerifyOutboundTrust is broken when running on a computer that is in a different forest than the user _and_ trying to verify a trust to the user\u0027s domain.\r\nLine 436 defaults to the computer domain:\r\n`\r\n                currentDom = Domain.GetComputerDomain();\r\n`\r\nLine  471 defaults to the user forest (which in this case is different from the computer domain/forest):\r\n`\r\n            Forest currentForest = Forest.GetCurrentForest();\r\n`\r\nLine 452 does not match because here we are verifying targetDomain against the computer domain:\r\n`\r\n            if (string.Equals(currentDom.Name, targetDomain, StringComparison.OrdinalIgnoreCase))\r\n`\r\nOutcome is that line 477 tries to verify a trust from the passed in \"targetDomain\" against the current user\u0027s domain:\r\n`\r\n                ForestTrustRelationshipInformation FTC = currentForest.GetTrustRelationship(targetdom.Forest.Name);\r\n`\r\nThis throws an exception because targetDomain and currentForest are the same - and a forest can never have a trust with itself:\r\n`\r\nException calling \"GetTrustRelationship\" with \"1\" argument(s): \"A forest trust relationship does not exist between \r\n\"corp.contoso.com\" and \"corp.contoso.com\".\"\r\n`\r\n\r\nThe function should maintain context by not using GetComputerDomain(), but GetCurrentDomain().\r\n\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003edaabm\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`, `needs-area-label`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2023-12-06T20:43:03Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ui03a",
                                           "createdAt":  "2023-12-13T20:02:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "@jay98014 @kumarravik78c @intothedarkness PTAL",
                                           "updatedAt":  "2023-12-13T20:02:44Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "UserPrincipal.GetAuthorizationGroups() throws \"Information about the domain could not be retrieved (1355)\"",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/97540",
        "createdAt":  "2024-01-26T07:51:02Z",
        "number":  97540,
        "author":  "edwardneal",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC1etug==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "PaulusParssinen",
                                            "createdAt":  "2024-01-28T13:12:19Z"
                                        }
                                    ],
                          "totalCount":  1
                      },
        "updatedAt":  "2024-03-07T07:22:37Z",
        "body":  "At the moment, the `System.DirectoryServices.Protocols.BerConverter` class calls the underlying LDAP library\u0027s ber_printf and ber_scanf functions. With the more recent `System.Formats.Asn1` library, this is no longer needed; we can call the various `AsnWriter` and `AsnDecoder` functions instead.\r\n\r\nThe AsnDecoder functions outperform BerConverter by a fair margin, although I don\u0027t think it\u0027s called enough times to make a measurable difference. The main value lies in being able to remove all of the BerPal class except for FreeBerElement (which is called by LdapConnection.) It\u0027ll mean taking a dependency on System.Formats.Asn1, which seems reasonable for an LDAP library.\r\n\r\n\u003cdetails\u003e\r\n    \u003csummary\u003ePerformance benchmarks - 3-6x execution time improvement, 3.4-5x memory allocation reduction\u003c/summary\u003e\r\n\r\nThese performance benchmarks are for a sequence of 10,000 integers. The AsnWriter uses an appropriately-sized initial buffer, which can be estimated from the format string; without this buffer, the memory allocation of AsnWriterEncode explodes by a factor of 9, to triple that of BerConverterEncode.\r\n\r\nBenchmarkDotNet v0.13.12, Windows 11 (10.0.22621.3007/22H2/2022Update/SunValley2)\r\nIntel Core i7-8565U CPU 1.80GHz (Whiskey Lake), 1 CPU, 8 logical and 4 physical cores\r\n.NET SDK 8.0.101\r\n  [Host]     : .NET 8.0.1 (8.0.123.58001), X64 RyuJIT AVX2 [AttachedDebugger]\r\n  DefaultJob : .NET 8.0.1 (8.0.123.58001), X64 RyuJIT AVX2\r\n\r\n| Method             | Mean       | Error    | StdDev   | Ratio | Gen0     | Gen1    | Gen2    | Allocated | Alloc Ratio |\r\n|------------------- |-----------:|---------:|---------:|------:|---------:|--------:|--------:|----------:|------------:|\r\n| BerConverterDecode | 1,727.3 us | 21.59 us | 20.20 us |  1.00 |   138.6719 | 68.3594 | 41.0156 | 842.52 KB |        1.00 |\r\n| AsnDecoderDecode    |   279.2 us |  4.33 us |  3.84 us |  0.16 |   40.5273 |  6.3477 |       - | 167.41 KB |        0.20 |\r\n| BerConverterEncode | 547.2 us | 5.49 us | 5.14 us |  1.00 | 66.4063 |        - | - | 273.55 KB |        1.00 |\r\n| AsnWriterEncode    | 187.2 us | 3.68 us | 3.94 us |  0.34 | 19.0430 | 1.2207 |  - | 78.21 KB |        0.29 |\r\n\u003c/details\u003e\r\n\r\nThis will change the BER output on Windows, but Windows is already a slight anomaly. At present, Windows\u0027 `ber_printf` encodes a `{` (an ASN.1 SEQUENCE) with a four-byte length; OpenLDAP and AsnWriter will only use the number of bytes actually required to encode the sequence length. An example of the changed output for a very simple sequence of one integer (0x10) is:\r\n\r\nPlatform | SequenceTag | LengthHeader | Length1 | Length2 | Length3 | Length4 | IntegerTag | IntegerLength | IntegerValue\r\n| - | - | - | - | - | - | - | - | - | - |\r\nWindows | 0x30 | 0x84 | 0x00 | 0x00 | 0x00 | 0x03 | 0x02 | 0x01 | 0x10\r\nAsnWriter | 0x30 | - | - | - | - | 0x03 | 0x02 | 0x01 | 0x10\r\n\r\nThere\u0027s also a difference in the ASN.1 BIT STRING. BerConverter doesn\u0027t appear to include the unused bit count, while AsnWriter and OpenLDAP do. An example of the changed output for this for the BIT STRING needed for a value of 4 (and two unused bits) is:\r\n\r\n| Library | BitStringTag | LengthBitString | UnusedBits | BitStringValue\r\n| - | - | - | - | - |\r\nBerConverter | 0x03 | 0x01 | - | 0x04\r\nAsnWriter | 0x03 | 0x02 | 0x02 | 0x04\r\n\r\nBoth of these are already noted to a certain degree in BerConverterTests, and switching to AsnWriter and AsnDecoder would make the output consistent across platforms.\r\n\r\nAlthough it\u0027s a public API, it\u0027s worth nothing that this is only called within the library when building the list of `DirectoryControl`s. There might also be a performance improvement if we change the callers to use AsnDecoder directly, to avoid the overhead of processing a format string which will always be static.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOdi3wHg==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5x8Ytc",
                                           "createdAt":  "2024-01-26T08:22:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\nAt the moment, the `System.DirectoryServices.Protocols.BerConverter` class calls the underlying LDAP library\u0027s ber_printf and ber_scanf functions. With the more recent `System.Formats.Asn1` library, this is no longer needed; we can call the various `AsnWriter` and `AsnDecoder` functions instead.\r\n\r\nThe AsnDecoder functions outperform BerConverter by a fair margin, although I don\u0027t think it\u0027s called enough times to make a measurable difference. The main value lies in being able to remove all of the BerPal class except for FreeBerElement (which is called by LdapConnection.) It\u0027ll mean taking a dependency on System.Formats.Asn1, which seems reasonable for an LDAP library.\r\n\r\n\u003cdetails\u003e\r\n    \u003csummary\u003ePerformance benchmarks - 3-6x execution time improvement, 3.4-5x memory allocation reduction\u003c/summary\u003e\r\n\r\nThese performance benchmarks are for a sequence of 10,000 integers. The AsnWriter uses an appropriately-sized initial buffer, which can be estimated from the format string; without this buffer, the memory allocation of AsnWriterEncode explodes by a factor of 9, to triple that of BerConverterEncode.\r\n\r\nBenchmarkDotNet v0.13.12, Windows 11 (10.0.22621.3007/22H2/2022Update/SunValley2)\r\nIntel Core i7-8565U CPU 1.80GHz (Whiskey Lake), 1 CPU, 8 logical and 4 physical cores\r\n.NET SDK 8.0.101\r\n  [Host]     : .NET 8.0.1 (8.0.123.58001), X64 RyuJIT AVX2 [AttachedDebugger]\r\n  DefaultJob : .NET 8.0.1 (8.0.123.58001), X64 RyuJIT AVX2\r\n\r\n| Method             | Mean       | Error    | StdDev   | Ratio | Gen0     | Gen1    | Gen2    | Allocated | Alloc Ratio |\r\n|------------------- |-----------:|---------:|---------:|------:|---------:|--------:|--------:|----------:|------------:|\r\n| BerConverterDecode | 1,727.3 us | 21.59 us | 20.20 us |  1.00 |   138.6719 | 68.3594 | 41.0156 | 842.52 KB |        1.00 |\r\n| AsnDecoderDecode    |   279.2 us |  4.33 us |  3.84 us |  0.16 |   40.5273 |  6.3477 |       - | 167.41 KB |        0.20 |\r\n| BerConverterEncode | 547.2 us | 5.49 us | 5.14 us |  1.00 | 66.4063 |        - | - | 273.55 KB |        1.00 |\r\n| AsnWriterEncode    | 187.2 us | 3.68 us | 3.94 us |  0.34 | 19.0430 | 1.2207 |  - | 78.21 KB |        0.29 |\r\n\u003c/details\u003e\r\n\r\nThis will change the BER output on Windows, but Windows is already a slight anomaly. At present, Windows\u0027 `ber_printf` encodes a `{` (an ASN.1 SEQUENCE) with a four-byte length; OpenLDAP and AsnWriter will only use the number of bytes actually required to encode the sequence length. An example of the changed output for a very simple sequence of one integer (0x10) is:\r\n\r\nPlatform | SequenceTag | LengthHeader | Length1 | Length2 | Length3 | Length4 | IntegerTag | IntegerLength | IntegerValue\r\n| - | - | - | - | - | - | - | - | - | - |\r\nWindows | 0x30 | 0x84 | 0x00 | 0x00 | 0x00 | 0x03 | 0x02 | 0x01 | 0x10\r\nAsnWriter | 0x30 | - | - | - | - | 0x03 | 0x02 | 0x01 | 0x10\r\n\r\nThere\u0027s also a difference in the ASN.1 BIT STRING. BerConverter doesn\u0027t appear to include the unused bit count, while AsnWriter and OpenLDAP do. An example of the changed output for this for the BIT STRING needed for a value of 4 (and two unused bits) is:\r\n\r\n| Library | BitStringTag | LengthBitString | UnusedBits | BitStringValue\r\n| - | - | - | - | - |\r\nBerConverter | 0x03 | 0x01 | - | 0x04\r\nAsnWriter | 0x03 | 0x02 | 0x02 | 0x04\r\n\r\nBoth of these are already noted to a certain degree in BerConverterTests, and switching to AsnWriter and AsnDecoder would make the output consistent across platforms.\r\n\r\nAlthough it\u0027s a public API, it\u0027s worth nothing that this is only called within the library when building the list of `DirectoryControl`s. There might also be a performance improvement if we change the callers to use AsnDecoder directly, to avoid the overhead of processing a format string which will always be static.\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eedwardneal\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2024-01-26T08:22:30Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5ycFCF",
                                           "createdAt":  "2024-01-31T21:09:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "PTAL @BRDPM @grubioe @jay9801",
                                           "updatedAt":  "2024-01-31T21:09:14Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc50Tumo",
                                           "createdAt":  "2024-02-18T13:37:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "edwardneal",
                                           "body":  "I\u0027ve been looking at `BerConverter` more closely, and I\u0027d like to take it a little further. Switching to the use of `AsnWriter` isn\u0027t a problem, but switching from the use of `ber_scanf` to `AsnDecoder` is implicitly a breaking change.\r\n\r\nber_scanf\u0027s documentation states that the inbound byte array is interpreted according to the format string - but in doing so, it ignores the ASN.1 tags, to a degree that their contents can be interpreted corruptly. This can cut both ways: a valid ASN.1-formatted byte array can generate invalid results, and an invalid buffer can generate valid results.\r\n\r\n#### Case 1: Valid byte array, invalid results\r\n\r\nI\u0027ve lifted this example byte array from `BerConverterTests`. It\u0027s a valid, unambiguous ASN.1 data structure - a sequence of two Boolean values (true, followed by false). However, if this byte array is passed to `ber_scanf` with a format string of `{v}` then it will be interpreted as a sequence which contains an inner sequence of null-terminated OCTET STRINGs.\r\n\r\n| Index | Value | ASN.1 meaning | `{v}` meaning |\r\n| - | - | - | - |\r\n| 0 | 48 | Type (SEQUENCE) | Type (SEQUENCE) |\r\n| 1 | 132 | Length 1 | Length 1 |\r\n| 2 | 0 | Length 2 | Length 2 |\r\n| 3 | 0 | Length 3 | Length 3 |\r\n| 4 | 0 | Length 4 | Length 4 |\r\n| 5 | 6 | Length 5 (6 bytes) | Length 5 (6 bytes) |\r\n| 6 | 1 | Type (Boolean) | Sequence type (ignored) |\r\n| 7 | 1 | Length (1 byte) | Sequence length (ignored) |\r\n| 8 | 255 | Value (`true`) | Octet string type (ignored) |\r\n| 9 | 1 | Type (Boolean) | Length (1 byte) |\r\n| 10 | 1 | Length (1 byte) | Value (`1`) |\r\n| 11 | 0 | Value (`false`) | Trailing byte (ignored) |\r\n\r\nThe final output of ber_scanf with a format string of `{v}` is thus `[ [ \"\\x01\" ] ]`. If BerConverter.Decode is switched to using AsnDecoder, it\u0027ll simply throw an exception or return false.\r\n\r\n#### Case 2: Invalid byte array, valid results\r\n\r\nThis is simply an adapted version of the previous byte array. It\u0027s an invalid ASN.1 structure which will be parsed as if it was correct.\r\n\r\n| Index | Value | ASN.1 meaning | `{v}` meaning |\r\n| - | - | - | - |\r\n| 0 | 48 | Type (SEQUENCE) | Type (SEQUENCE) |\r\n| 1 | 132 | Length 1 | Length 1 |\r\n| 2 | 0 | Length 2 | Length 2 |\r\n| 3 | 0 | Length 3 | Length 3 |\r\n| 4 | 0 | Length 4 | Length 4 |\r\n| 5 | 6 | Length 5 (6 bytes) | Length 5 (6 bytes) |\r\n| 6 | 1 | Type (Boolean) | Sequence type (ignored) |\r\n| 7 | 1 | Length (1 byte) | Sequence length (ignored) |\r\n| 8 | 48 | Value (`true`) | Octet string type (ignored) |\r\n| 9 | 2 | Type (Integer) | Length (2 bytes) |\r\n| 10 | 30 | Length (Invalid - 30 bytes) | Value (`\"\\x1e\"`) |\r\n| 11 | 5 | Value (`5`) | Value (`\"\\x05\"`) |\r\n\r\n#### Impact\r\n\r\nThe impact of using AsnWriter to power BerConverter.Encode is pretty clear, but using AsnDecoder for BerConverter.Decode will mean that the format string needs to match the actual ASN.1 data types directly. This\u0027ll cause Decode to throw an exception in some situations. I think that\u0027s the right thing to do though: at the moment, it\u0027s easy for Decode to interpret data in undefined ways.\r\n\r\nI was also hoping to avoid API changes, but if Decode is to be made stricter then the exception behaviour of Decode and Encode should change to make sure that we\u0027re providing useful information when we throw `BerConversionException`. At present, it doesn\u0027t indicate what failed, or where the failure occurred. I\u0027d also like to add TryEncode and TryDecode methods and Span-ify BerConverter in the same API review just as a matter of course.\r\n\r\nSeparately to this, there are a few test cases missing in BerConverterTests to verify that the `v` and `V` format strings work. I\u0027ll add these shortly. I\u0027ll also change the various classes in System.DirectoryServices.Protocols which currently use BerConverter.Decode and Encode over to the newer AsnWriter and AsnDecoder, to make our LDAP request formats consistent across client platforms and to validate the responses we receive from servers a little more tightly.\r\n\r\n#### Proposed API changes\r\n\r\n```diff\r\npublic static class BerConverter\r\n{\r\n    public static byte[] Encode(string format, params object[] value);\r\n+   public static byte[] Encode(ReadOnlySpan\u003cchar\u003e format, params object[] value);\r\n+   public static bool TryEncode(string format,\r\n+       Span\u003cbyte\u003e destination, out int bytesWritten, params object[] value);\r\n+   public static bool TryEncode(ReadOnlySpan\u003cchar\u003e format,\r\n+       Span\u003cbyte\u003e destination, out int bytesWritten, params object[] value);\r\n\r\n    public static object[] Decode(string format, byte[] value);\r\n+   public static object[] Decode(ReadOnlySpan\u003cchar\u003e format, byte[] value);\r\n+   public static bool TryDecode(string format, byte[] value, out object[] destination);\r\n+   public static bool TryDecode(ReadOnlySpan\u003cchar\u003e format, byte[] value, out object[] destination);\r\n}\r\n\r\npublic class BerConversionException\r\n{\r\n+   // Position in the format string where the exception was generated.\r\n+   public int FormatIndex { get; }\r\n\r\n+   // When encoding, the type of parameter which was expected. Null when dealing with structures\r\n+   // which don\u0027t require a parameter (such as sequences.) Null when decoding.\r\n+   public Type? ExpectedParameterType { get; }\r\n\r\n+   // When encoding, the parameter being encoded when the exception was generated. Null when\r\n+   // dealing with structures which don\u0027t require a parameter.\r\n+   // When decoding, the decoded parameter value (if this is known when the exception was generated.)\r\n+   public object? ParameterValue { get; }\r\n\r\n+   public BerConversionException(int formatIndex, Type? expectedParameterType);\r\n+   public BerConversionException(int formatIndex, Type? expectedParameterType, string message);\r\n+   public BerConversionException(int formatIndex, Type? expectedParameterType,\r\n+       object? parameterValue);\r\n+   public BerConversionException(int formatIndex, Type? expectedParameterType,\r\n+       object? parameterValue, string message);\r\n}\r\n```\r\n\r\nWhat\u0027s the right way for me to receive initial feedback on the proposal and to get it ready for the API review process?",
                                           "updatedAt":  "2024-02-18T13:37:37Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc51peZR",
                                           "createdAt":  "2024-03-01T19:41:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "Tag experts in the `AsnWriter`, `AsnDecoder` encoding area @bartonjs @GrabYourPitchforks for feedback",
                                           "updatedAt":  "2024-03-01T19:43:05Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc512Xde",
                                           "createdAt":  "2024-03-04T18:16:08Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODZd33A==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "buyaa-n",
                                                                               "createdAt":  "2024-03-06T00:28:40Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "bartonjs",
                                           "body":  "Adding new API and changing the underlying implementation are really two different things; so they should be in two separate issues.  The new exception data might depend on the implementation changing, so they might be interdependent in that sense... but otherwise they feel orthogonal.\r\n\r\nFor the API part:\r\n\r\n* We generally haven\u0027t added ROS-char overloads to things that take `string format`, since that\u0027s almost always given as a string literal, so there\u0027s not a reason to want to accept a slice/substring.  (It also has underlying implementation concerns, since a `string` is null-terminated during a P/Invoke, and a `ReadOnlySpan\u003cchar\u003e` isn\u0027t necessarily null-terminated.)\r\n* The Span-writing TryEncode seems fine.\r\n* I don\u0027t understand what the failure mode is of TryDecode.  Note that \"Try\" doesn\u0027t mean \"doesn\u0027t throw an exception\", it means \"doesn\u0027t throw an exception in one understandable case\".  For super-low-level things like int.TryParse the one case is \"this doesn\u0027t parse as an integer\", which happens to basically mean \"doesn\u0027t throw exceptions\".  For span-writing things it means \"the output was too small\".  The best I see from this is \"some piece of data was bad, but I can\u0027t tell you what it was\"... but maybe I\u0027m missing something.\r\n* I\u0027m not entirely certain what the utility in the new exception data is.  The API shape for it is probably reasonable; but someone would need to be able to articulate during the API review where someone would actually use any of the new data in an actual program; vs just a theoretical \"if we have the information we should share it\".\r\n\r\nFor the implementation change:\r\n\r\n* AsnWriter always uses the CER/DER minimal byte encoding for the length.  But that\u0027s legal BER, so shouldn\u0027t bother anyone.\r\n* AsnWriter.WriteBitString expects just the content bytes (aside from the overload with the unused bit count).  Not sure what BerConverter\u0027s API is doing; other than expecting the caller to have already made bytes[0] be the unused bit count.  But whatever the existing API is doing, it would need to stay doing.\r\n* I don\u0027t know anything about the BerConverter.Decode APIs; so it\u0027s hard for me to comment on the impact there... other than \"breaking changes are best avoided\".  Especially since I didn\u0027t quite internalize it due to being in a bit of a hurry at the moment.",
                                           "updatedAt":  "2024-03-04T18:16:08Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc513kto",
                                           "createdAt":  "2024-03-04T21:36:50Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "edwardneal",
                                           "body":  "Thanks for the review. The additional API request was largely a result of the Decode API changes. The Encode API changes are pretty simple (although I\u0027m a bit curious why Windows is always returning the long-form length attribute - was this for backwards compatibility with something, and if so then is it still around?)\r\n\r\nIn a nutshell: the existing BerConverter.Decode API calls `ber_scanf` by passing in a format string. ber_scanf then reads the next bytes from the input buffer as though they\u0027re in the format defined by the next element in the format string. It doesn\u0027t validate that the type of the ASN element which is in the next bytes of the input buffer matches the type expected by the format string though - it just skips the type byte and processes the raw data. That can work sometimes, but there are some situations (such as `{v}`) where the element described by the current character in format string has a different length to the ASN element at the current position in the input buffer. This means that ber_scanf could advance the current position of the input buffer incorrectly and misinterpret all of the BER elements which follow. This would potentially mean that it could read data lengths from incorrect positions in the input buffer and perform a buffer overread, although in practice testing confirms that both OpenLDAP and Windows are protected against that.\r\n\r\nAsnReader is better-behaved - when we try to read (e.g.) an integer, it\u0027ll actually validate the datatype of the ASN element in its input buffer, and throw if it doesn\u0027t match. Throwing an exception in this circumstance is a breaking change, but given that the input buffer comes directly from the remote server, I think throwing is preferrable - trying to blindly interpret the data in the same way that ber_scanf does feels like a short-cut to undefined behaviour, even if bounds checking protects against the buffer overreads I mentioned earlier.\r\n\r\nThis then led to the extra fields in BerConversionException: if we\u0027re going to throw this exception when the input buffer doesn\u0027t match the format string, it made sense to indicate which part of the format string had the error. I then expanded the same principle to the Encode logic, which currently just performs Debug.WriteLine if there\u0027s a type mismatch while encoding.\r\n\r\n###\r\n\r\nYour points around the rest of the API surface for BerConverter make a lot of sense. My thought process for using ReadOnlySpans for the format strings was that using this would make string constant inlining work, and that the very short format strings used in user code might interact with the JIT\u0027s PGO and loop unrolling to turn into (essentially) a JIT-generated BER deserializer. If that\u0027s not the case, then the ROSes can go - they\u0027re not going to do any good.\r\n\r\nThere\u0027s some value in being able to decode directly from the input buffer as a span and avoid copying a byte array around. I\u0027ll discard the TryDecode and ReadOnlySpans, and will see about adding a Decode overload which accepts that span. This might be a few days though.",
                                           "updatedAt":  "2024-03-04T21:36:50Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc514oT8",
                                           "createdAt":  "2024-03-05T01:30:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "bartonjs",
                                           "body":  "Looking into it further, neither BerConverter.Encode nor BerConverter.Decode seem to be very popular (8 hits for Decode on https://grep.app, and 11 for Encode); so I\u0027m not actually convinced that any performance gains here are worth the compatibility risk of changing either to use System.Formats.Asn1. (Callers, of course, should feel encouraged to do so... even within the System.DirectoryServices.Protocols library (when safe to do so))\r\n\r\nI don\u0027t see any particular problems with adding a Span-writing TryEncode, or an overload of Decode that takes `ReadOnlySpan\u003cbyte\u003e` instead of `byte[]`; other than it not being worth the investment for something that\u0027s not called often (but as a community contribution, sure).",
                                           "updatedAt":  "2024-03-05T01:30:45Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc514qg6",
                                           "createdAt":  "2024-03-05T01:40:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "bartonjs",
                                           "body":  "\u003e  The Encode API changes are pretty simple (although I\u0027m a bit curious why Windows is always returning the long-form length attribute - was this for backwards compatibility with something, and if so then is it still around?)\r\n\r\nWriting the length as `84 00 00 00 02` instead of `02` is easier for composed values, like SEQUENCE: every time you start a new tag you just write `84 00 00 00 00`, and remember the position where you put it... then when you know the final size you just overwrite it.  The minimum-length representation requires shifting data around when the final length is known.  (Did you assume it would fit in one byte, but doesn\u0027t?  Shift all the contents forward.)  AsnWriter does this shifting whenever a tag is popped (it only pre-allocates 1 byte, so if the length exceeds 0x7F bytes it then needs to shift in the space to write the length in the long form): https://github.com/dotnet/runtime/blob/8f33d62892130fab9ca1fd8bf6c31ba2c16bae25/src/libraries/System.Formats.Asn1/src/System/Formats/Asn1/AsnWriter.cs#L569-L582",
                                           "updatedAt":  "2024-03-05T01:40:44Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5156lt",
                                           "createdAt":  "2024-03-05T07:27:37Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "edwardneal",
                                           "body":  "Your latter point makes a lot of sense, thanks. They\u0027re both valid BER outputs, and avoiding a potentially-expensive block copy seems sensible.\r\n\r\nI agree that BerConverter\u0027s not used often, but it\u0027s on the inner loop of a hot path when using System.DirectoryServices.Protocols to query an LDAP server. Every parsed LDAP result can have a directory control, and this directory control needs to be parsed from a BER-formatted byte array (sometimes multiple times). Each character in the BER format string is a PInvoke into winldap/openldap, sometimes with the associated allocation of unmanaged memory, copies into it, etc.\r\n\r\nAnother approach is just to use AsnWriter/AsnDecoder directly when parsing directory controls; this\u0027d eliminate the impact of using BerConverter on a hot path while maintaining backwards compatibility. If we do this, I\u0027d actually be in favour of obsoleting BerConverter entirely: it\u0027s serving no purpose other than wrapping ber_scanf/ber_printf, and there\u0027s now a managed, type-safe alternative which does that more efficiently.",
                                           "updatedAt":  "2024-03-05T07:27:37Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc51_yhv",
                                           "createdAt":  "2024-03-05T21:21:40Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "vcsjones",
                                           "body":  "\u003e Another approach is just to use AsnWriter/AsnDecoder directly when parsing directory controls\r\n\r\nThat was largely my suggestion to @bartonjs. `{i}` becomes\r\n\r\n```C#\r\n\r\nprivate static byte[] EncodeSequenceInteger(int value) {\r\n#if NET8_0_OR_GREATER\r\n    AsnWriter writer = new(AsnEncodingRules.BER, initialCapacity: 10);\r\n#else\r\n    AsnWriter writer = new(AsnEncodingRules.BER);\r\n#end\r\n    using (writer.PushSequence()) {\r\n        writer.WriteInteger(value);\r\n    }\r\n    return writer.Encode();\r\n}\r\n```\r\n\r\n\u003e If we do this, I\u0027d actually be in favour of obsoleting BerConverter entirely: it\u0027s serving no purpose other than wrapping ber_scanf/ber_printf, and there\u0027s now a managed, type-safe alternative which does that more efficiently.\r\n\r\nI did consider suggesting that... but backed off when I saw that other people, albeit a small number of them, were using it and might find its templating scheme useful.\r\n\r\nA quick look at the code to me also suggests that there are a number of allocation improvements that can be made to `BerConverter` if add some `#if NET8_0_OR_GREATER` code paths, use the stack where it makes sense, particularly in UTF8 \u003c-\u003e byte conversions.",
                                           "updatedAt":  "2024-03-05T21:21:40Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc52BmsU",
                                           "createdAt":  "2024-03-06T05:49:13Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "edwardneal",
                                           "body":  "I\u0027m in two minds on the value of the templating scheme for Encode. It\u0027s certainly quicker to work with - but somebody who needs to generate a BER object should already know the structure of BER object they want to create. I personally think it\u0027s more readable and maintainable to see that structure explicitly laid out in a few lines of an AsnWriter rather than looking up the format strings for ber_printf. I\u0027m still of the opinion that we should mark it as obsolete, but I\u0027d be happy to make the allocation improvements to the obsoleted method (and potentially check to see if some of the defensive copies are necessary - I think a lot of them might be removeable.)\r\n\r\nWhen it comes to Decode, the templating scheme is the largest part I dislike, and it\u0027s down to the underlying libraries not validating the actual type of the ASN element with the expected type in the format string, proceeding assuming that they match. We\u0027ve not got a place to add that validation in .NET, and it renders everything in the buffer after that point untrustworthy - it\u0027s either flat-out unreadable (i.e. the value is null) or the values are incorrect in ways that can\u0027t reliably be detected from managed code. I\u0027d really prefer to either deprecate it in favour of AsnDecoder, or to accept the breaking change (\"your format string must now exactly match the incoming BER-formatted byte array.\") and use AsnDecoder internally. If we do the latter, I\u0027d prefer to keep the class consistent and use AsnWriter for Encode too (and accept the small behaviour change in sequence length formatting.)",
                                           "updatedAt":  "2024-03-06T05:49:13Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc52IrjE",
                                           "createdAt":  "2024-03-06T22:47:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "bartonjs",
                                           "body":  "I\u0027m not an owner for DirectoryServices; but my general view from the product-wide perspective is that I do not believe any breaking changes are justified here.  Moving to AsnReader would potentially make sense for bringing up a new platform if ber_scanf was unavailable... but then there\u0027d be a fair bit of hemming and hawing deciding whether to do that on existing platforms or leave them doing their existing P/Invokes.\r\n\r\nOn the one hand: \"It\u0027s a function not called by many, they probably won\u0027t care about the breaks..\"\r\nOn the other: \"It\u0027s a function not called by many, they might be 100% depending on quirks from it.\"\r\n\r\nI\u0027m not, personally, a fan of how Decode appears to be structured; but I don\u0027t know enough about when people want to use it that I have an opinion about marking it as `[Obsolete]`.\r\n\r\nI\u0027m (personally) supportive of anything that wants to move from ber_scanf to using AsnReader (at least partially because I wrote AsnReader)... but only when compatibility has been taken into account. And for BerConverter.Decode it doesn\u0027t sound (to me) like the compat risk is worth the gain.",
                                           "updatedAt":  "2024-03-06T22:47:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc52LfAe",
                                           "createdAt":  "2024-03-07T07:22:36Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "edwardneal",
                                           "body":  "That\u0027s a pity, but a fair point - the API\u0027s been around for a long time, and BER generation/parsing is usually close to foundational to the protocols it\u0027s used in. I understand wanting to keep 100% backwards compatibility there.\r\n\r\nI think the current design of Encode is more forgiving here: we know we\u0027re generating an array with the correctly-typed BER elements, so if we can replicate the length encoding and if I try to understand what\u0027s happening with the BIT STRING processing then AsnWriter becomes a workable option.\r\n\r\nWith that in mind, I think it\u0027d be more reasonable to:\r\n* Change DirectoryControl to reference AsnWriter/AsnDecoder (to bypass BerConverter)\r\n* Review memory allocation, defensive copying, UTF8 conversion, etc. within BerConverter.Decode\r\n* Submit a separate issue to discuss a compatibility flag on AsnWriter to generate fixed-length BER sequence length fields (which might also be a minor performance/space tradeoff, since it can eliminate a memory copy in some circumstances)\r\n* Review/expand test coverage of BerConverter.Encode\r\n* Replace Encode with AsnWriter\r\n\r\nI\u0027d expect these to be community contributions (although the AsnWriter compatibility flag would be an API review.) Once BerConverter\u0027s out of the hot path it\u0027s not the highest priority, but if you\u0027re happy with the approach I\u0027ll put it on my backburner.",
                                           "updatedAt":  "2024-03-07T07:22:36Z"
                                       }
                                   ],
                         "totalCount":  13
                     },
        "title":  "BerConverter does not use AsnWriter, AsnDecoder APIs",
        "labels":  [
                       "area-System.DirectoryServices",
                       "tenet-performance",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/98982",
        "createdAt":  "2024-02-27T12:46:55Z",
        "number":  98982,
        "author":  "JensNordenbro",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-07-12T15:49:08Z",
        "body":  "### Description\n\n    using (PrincipalContext principalContext = new PrincipalContext(ContextType.Machine))\r\n    {\r\n        return principalContext.ValidateCredentials(username, password);\r\n    }\n\n### Reproduction Steps\n\nLogin using a username, password that represents a local user on the local machine in the following will happen on Windows Sandbox: \r\n\r\n![image](https://github.com/dotnet/runtime/assets/9577365/41151e59-8761-4e63-8546-7e0ba8f99a71)\r\n\r\n\r\nIt is not expected to crash just because there are no network interfaces since I only ask to login to a local user to the local machine. \n\n### Expected behavior\n\nIt works \n\n### Actual behavior\n\nSee picture of crash \n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOhKwB0w==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc51OEqi",
                                           "createdAt":  "2024-02-27T14:04:39Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  null,
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003cdetails\u003e\n\u003csummary\u003eIssue Details\u003c/summary\u003e\n\u003chr /\u003e\n\n### Description\n\n    using (PrincipalContext principalContext = new PrincipalContext(ContextType.Machine))\r\n    {\r\n        return principalContext.ValidateCredentials(username, password);\r\n    }\n\n### Reproduction Steps\n\nLogin using a username, password that represents a local user on the local machine in the following will happen on Windows Sandbox: \r\n\r\n![image](https://github.com/dotnet/runtime/assets/9577365/41151e59-8761-4e63-8546-7e0ba8f99a71)\r\n\r\n\r\nIt is not expected to crash just because there are no network interfaces since I only ask to login to a local user to the local machine. \n\n### Expected behavior\n\nIt works \n\n### Actual behavior\n\nSee picture of crash \n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAuthor:\u003c/th\u003e\n    \u003ctd\u003eJensNordenbro\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eAssignees:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eLabels:\u003c/th\u003e\n    \u003ctd\u003e\n\n`area-System.DirectoryServices`, `untriaged`\n\n\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003cth align=\"left\"\u003eMilestone:\u003c/th\u003e\n    \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/details\u003e",
                                           "updatedAt":  "2024-02-27T14:04:39Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc51OFde",
                                           "createdAt":  "2024-02-27T14:06:15Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "danmoseley",
                                           "body":  "Can you attach a debugger or via dotnet dump see what parameters it is passing to the native call?\n\nhttps://github.com/dotnet/docs/blob/main/docs/core/diagnostics/dotnet-dump.md",
                                           "updatedAt":  "2024-02-27T14:06:15Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc51V7Ez",
                                           "createdAt":  "2024-02-28T10:28:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "JensNordenbro",
                                           "body":  "C:\\Users\\WDAGUtilityAccount\\Desktop\u003edotnet-dump collect -p 4104\r\n\r\nWriting full to C:\\Users\\WDAGUtilityAccount\\Desktop\\dump_20240228_111952.dmp\r\nUnhandled exception: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.\r\n ---\u003e System.Runtime.InteropServices.COMException (0x80070001): Incorrect function. (0x80070001)\r\n   at Microsoft.Diagnostics.Tools.Dump.Dumper.Windows.CollectDump(Int32 processId, String outputFile, DumpTypeOption type)\r\n   at Microsoft.Diagnostics.Tools.Dump.Dumper.Collect(IConsole console, Int32 processId, String output, Boolean diag, Boolean crashreport, DumpTypeOption type, String name)\r\n   --- End of inner exception stack trace ---\r\n   at System.RuntimeMethodHandle.InvokeMethod(Object target, Span`1\u0026 arguments, Signature sig, Boolean constructor, Boolean wrapExceptions)\r\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\r\n   at System.Delegate.DynamicInvokeImpl(Object[] args)\r\n   at System.Delegate.DynamicInvoke(Object[] args)\r\n   at System.CommandLine.Invocation.ModelBindingCommandHandler.InvokeAsync(InvocationContext context)\r\n   at System.CommandLine.Invocation.InvocationPipeline.\u003c\u003ec__DisplayClass4_0.\u003c\u003cBuildInvocationChain\u003eb__0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec.\u003c\u003cUseParseErrorReporting\u003eb__21_0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec__DisplayClass16_0.\u003c\u003cUseHelp\u003eb__0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec__DisplayClass25_0.\u003c\u003cUseVersionOption\u003eb__0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec__DisplayClass23_0.\u003c\u003cUseTypoCorrections\u003eb__0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec.\u003c\u003cUseSuggestDirective\u003eb__22_0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec.\u003c\u003cUseParseDirective\u003eb__20_0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec.\u003c\u003cUseDebugDirective\u003eb__11_0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec.\u003c\u003cRegisterWithDotnetSuggest\u003eb__10_0\u003ed.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at System.CommandLine.Builder.CommandLineBuilderExtensions.\u003c\u003ec__DisplayClass14_0.\u003c\u003cUseExceptionHandler\u003eb__0\u003ed.MoveNext()\r\n\r\nC:\\Users\\WDAGUtilityAccount\\Desktop\u003e\r\n\r\n\r\n\r\nAtttached the dump file (7zip splitted); not sure if it was done correctly. \r\n[dump_20240228_111938.zip.001.remove.this.trailing.zip](https://github.com/dotnet/runtime/files/14432301/dump_20240228_111938.zip.001.remove.this.trailing.zip)\r\n[dump_20240228_111938.zip.003.remove.this.trailing.zip](https://github.com/dotnet/runtime/files/14432302/dump_20240228_111938.zip.003.remove.this.trailing.zip)\r\n[dump_20240228_111938.zip.004.remove.this.trailing.zip](https://github.com/dotnet/runtime/files/14432304/dump_20240228_111938.zip.004.remove.this.trailing.zip)\r\n[dump_20240228_111938.zip.002.remove.this.trailing.zip](https://github.com/dotnet/runtime/files/14432305/dump_20240228_111938.zip.002.remove.this.trailing.zip)\r\n\r\n\r\nYou should be able to repro this bug. I run \r\n![image](https://github.com/dotnet/runtime/assets/9577365/d01adbf9-58fe-454f-acb8-eb6ca99a6414)\r\n\r\n..however many colleagues are running different versions with similar results. ",
                                           "updatedAt":  "2024-02-28T10:28:04Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc51azgI",
                                           "createdAt":  "2024-02-28T21:36:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "Is this is a crash or just a `FileNotFoundException`?\r\n",
                                           "updatedAt":  "2024-02-28T21:36:30Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc51irCW",
                                           "createdAt":  "2024-02-29T21:48:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "JensNordenbro",
                                           "body":  "Whats the difference?\r\nJust try it out with a console app doing the login on a new local user and see it fail on Windows sandbox. ",
                                           "updatedAt":  "2024-02-29T21:48:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc52HQZ6",
                                           "createdAt":  "2024-03-06T19:22:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "@BRDPM @grubioe @Jay9801 @jay98014 @kumarravik78c. PTAL",
                                           "updatedAt":  "2024-03-06T19:22:45Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6ErAHT",
                                           "createdAt":  "2024-07-12T15:49:07Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "JensNordenbro",
                                           "body":  "Any plans for this issue @buyaa-n  ?",
                                           "updatedAt":  "2024-07-12T15:49:07Z"
                                       }
                                   ],
                         "totalCount":  7
                     },
        "title":  "PrincipalContext.ValidateCredentials crashes on Windows Sandbox",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/100007",
        "createdAt":  "2024-03-20T11:14:26Z",
        "number":  100007,
        "author":  "isupovs",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  "Y3Vyc29yOnYyOpHOC5p2pw==",
                          "nodes":  [
                                        {
                                            "content":  "THUMBS_UP",
                                            "user":  "obexer46",
                                            "createdAt":  "2024-07-24T12:16:03Z"
                                        }
                                    ],
                          "totalCount":  1
                      },
        "updatedAt":  "2024-06-19T00:51:27Z",
        "body":  "If I create a connection and try to send request from Windows computer, then shut down the dc1 and resend the request it will succeed. I assume it will use the dc2.\r\n```charp\r\nvar ldi = new LdapDirectoryIdentifier(new [] { \"dc1.domain.com\",  \"dc2.domain.com\" }, 389, false, false);\r\nvar conn = new LdapConnection(ldi, new NetworkCredential(\"user\", \"password\")) \r\n{\r\n    SessionOptions = {\r\n      ProtocolVersion = 3\r\n    }, \r\n    AuthType = AuthType.Basic\r\n};\r\n\r\nvar req = new SearchRequest(\"\", \"(objectType=*)\", SearchScope.Base, \"defaultNamingContext\");\r\nconn.SendRequest(req);\r\n\r\n```\r\n\r\nIf the same code executes on Linux machine it will fail with ```System.DirectoryServices.Protocols.LdapException: The operation was aborted because the client side timeout limit was exceeded.```\r\nDoes it depend on OpenLDAP library? Can I achieve the same result on Linux?",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOfpIgiQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc55TcKa",
                                           "createdAt":  "2024-04-03T17:09:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "@isupovs which version are you using?  This might have fixed with https://github.com/dotnet/runtime/issues/79653. Could you try it out with .NET 8.0?",
                                           "updatedAt":  "2024-04-03T17:09:23Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc55iY8b",
                                           "createdAt":  "2024-04-05T06:42:32Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "isupovs",
                                           "body":  "I use .NET6. I\u0027ve tried with .NET8. It has the same behavior. Windows version reconnects to the second DC while Linux one just throws an exception.",
                                           "updatedAt":  "2024-04-05T06:42:32Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc55mrVK",
                                           "createdAt":  "2024-04-05T16:07:49Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e Does it depend on OpenLDAP library? Can I achieve the same result on Linux?\r\n\r\nNot sure, somebody needs to dig into it. Could be a bug in our library.",
                                           "updatedAt":  "2024-04-05T16:07:49Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc5-kiCJ",
                                           "createdAt":  "2024-05-21T21:57:18Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "hangy",
                                           "body":  "There doesn\u0027t seem to be any OS-specific retry/failover logic in `LdapConnection.Linux.cs` or `LdapConnection.Windows.cs`. It seems likely that `wldap32.dll` implements some failover while OpenLDAP doesn\u0027t.",
                                           "updatedAt":  "2024-05-21T21:57:18Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "Linux System.DirectoryServices.Protocols: does the library support multiple server connection?",
        "labels":  [
                       "area-System.DirectoryServices",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/100442",
        "createdAt":  "2024-03-29T14:53:34Z",
        "number":  100442,
        "author":  "Chebura",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-04-10T20:19:46Z",
        "body":  "### Description\r\n\r\nHi!\r\nI use System.DirectoryServices.Protocols LdapConnection.GetPartialResults() with AD. I\u0027ve found that behavior of client at Windows and Linux is differs.\r\n\r\n\"System.DirectoryServices.Protocols\" Version=\"8.0.0\" (net8)\r\n\r\nAt windows it work as expected. At linux GetPartialResults() throws error with timeout:\r\n\r\n```\r\nSystem.DirectoryServices.Protocols.LdapException: The operation was aborted because the client side timeout limit was exceeded. \r\n   at System.DirectoryServices.Protocols.LdapPartialResultsProcessor.GetPartialResults(LdapPartialAsyncResult asyncResult)\r\n```\r\n\r\nIncreasing the timeout causes the operation stuck (operation never ends).\r\n\r\nI don\u0027t understand, how it must be used properly for Linux.\r\n\r\nUsage:\r\n\r\n```C#\r\n        var sendRequestAsyncResult = ldapConnection.BeginSendRequest(request, PartialResultProcessing.ReturnPartialResults, null, ldapConnection);\r\n        var result = new List\u003cSearchResultEntry\u003e();\r\n        while (!cancellationToken.IsCancellationRequested \u0026\u0026 !sendRequestAsyncResult.IsCompleted)\r\n        {\r\n            PartialResultsCollection partialResults;\r\n            try\r\n            {\r\n                cancellationToken.ThrowIfCancellationRequested();\r\n                if (sendRequestAsyncResult.IsCompleted)\r\n                    return result;\r\n                partialResults = ldapConnection.GetPartialResults(sendRequestAsyncResult);\r\n            }\r\n#pragma warning disable S2737\r\n            catch (DirectoryOperationException e) when (e.Message.Equals(\"The size limit was exceeded\", StringComparison.Ordinal))\r\n            {\r\n                throw;\r\n                //return result;\r\n            }\r\n#pragma warning restore S2737\r\n            var entries = partialResults.OfType\u003cSearchResultEntry\u003e().ToList();\r\n            if (entries.Count \u003e 0) //in Linux count is 0\r\n            {\r\n                result.AddRange(entries);\r\n            }\r\n        }\r\n```\r\n\r\nIf I use SendRequest(), it\u0027s works correctly. GetPartialResults() didn\u0027t work correctly with same request.\r\n\r\n### Reproduction Steps\r\n\r\nuse LdapConnection.GetPartialResults() and SendRequests(), results are differs.\r\n\r\n### Expected behavior\r\n\r\nIMHO, results of GetPartialResults() process and SendRequests() must be equal.\r\n\r\n### Actual behavior\r\n\r\ntimeout occurs without any understandable reasons\r\n\r\n### Regression?\r\n\r\n_No response_\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Configuration\r\n\r\nLinux (ubuntu 20.04)\r\nActiveDirectory\r\nLDAPv3\r\n\r\n### Other information\r\n\r\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOeheS_Q==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc56F5L9",
                                           "createdAt":  "2024-04-10T20:16:48Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "buyaa-n",
                                           "body":  "\u003e At windows it work as expected. At linux GetPartialResults() throws error with timeout:\r\n\u003e \r\n\u003e Increasing the timeout causes the operation stuck (operation never ends).\r\n\u003e \r\n\u003e I don\u0027t understand, how it must be used properly for Linux.\r\n\r\nThe Windows implementation has been there for many years and mature, the Linux implementation added later and could have issue/bug. Tag @joperezr if he knows a workaround or any pointer for this issue  ",
                                           "updatedAt":  "2024-04-10T20:16:48Z"
                                       }
                                   ],
                         "totalCount":  1
                     },
        "title":  "LdapConnection.GetPartialResults() fails with timeout in Linux",
        "labels":  [
                       "area-System.DirectoryServices",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/101882",
        "createdAt":  "2024-05-05T12:05:38Z",
        "number":  101882,
        "author":  "swaglis",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-05-08T18:37:23Z",
        "body":  "### Description\n\nHi,\r\nI\u0027ve been trying to deploy my app as Native AOT, but I\u0027m getting **System.InvalidProgramException**, when getting the current domain of the computer.\r\nLooking into the runtime source code it seems there are some leftovers from rewriting the ComWrappers to use source generation, specifically **System.DirectoryServices.ActiveDirectory.NativeComInterfaces.Pathname.**\r\n\r\nDoes anyone know any workaround? While briefly looking through the source code I couldn\u0027t find any path to get the info I need without encountering the problematic class.\n\n### Reproduction Steps\n\n1. Create a Native AOT enabled, .NET 8.0 executable app.\r\n2. Add the following code\r\n\r\n```\r\npublic static void Main()\r\n{\r\n    var domain = Domain.GetCurrentDomain();\r\n    var domainController = domain.FindDomainController(LocatorOptions.KdcRequired);\r\n    Console.WriteLine($\"Domain controller: {domainController.Name} - {domainController.IPAddress}\");\r\n}\r\n```\r\n\r\n3. Publish and try to run\n\n### Expected behavior\n\nMethod does not throw and returns Domain instance the same way it works with Native AOT disabled.\n\n### Actual behavior\n\nFollowing exception\r\n```\r\nUnhandled Exception: System.InvalidProgramException: Common Language Runtime detected an invalid program. The body of method \u0027Void Pathname..ctor()\u0027 is invalid.\r\n   at Internal.Runtime.TypeLoaderExceptionHelper.CreateInvalidProgramException(ExceptionStringID, String) + 0x40\r\n   at Internal.Runtime.CompilerHelpers.ThrowHelpers.ThrowInvalidProgramExceptionWithArgument(ExceptionStringID, String) + 0x9\r\n   at System.DirectoryServices.ActiveDirectory.NativeComInterfaces.Pathname..ctor() + 0x15\r\n   at System.DirectoryServices.ActiveDirectory.DirectoryEntryManager..ctor(DirectoryContext) + 0x5d\r\n   at System.DirectoryServices.ActiveDirectory.Domain.GetDomain(DirectoryContext) + 0xae\r\n   at Program.Main() + 0x12b\r\n```\r\n\r\nThe publish output also contains the following\r\n```\r\n...\r\n2\u003eILC: Method \u0027[System.DirectoryServices]System.DirectoryServices.ActiveDirectory.NativeComInterfaces+Pathname..ctor()\u0027 will always throw because: Invalid IL or CLR metadata in \u0027Void Pathname..ctor()\u0027\r\n2\u003eILC: Method \u0027[System.DirectoryServices]System.DirectoryServices.UnsafeNativeMethods+PropertyValue..ctor()\u0027 will always throw because: Invalid IL or CLR metadata in \u0027Void PropertyValue..ctor()\u0027\r\n2\u003eILC: Method \u0027[System.DirectoryServices]System.DirectoryServices.UnsafeNativeMethods+PropertyEntry..ctor()\u0027 will always throw because: Invalid IL or CLR metadata in \u0027Void PropertyEntry..ctor()\u0027\r\n...\r\n```\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n- NET 8.0\r\n- Windows 11 Enterprise Evaluation, OS build 22621.3447\r\n- x64\r\n\n\n### Other information\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOfNvrsQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc5829HE",
                                           "createdAt":  "2024-05-05T12:05:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2024-05-05T12:05:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc582-ux",
                                           "createdAt":  "2024-05-05T12:25:30Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHODhKsYQ==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "buyaa-n",
                                                                               "createdAt":  "2024-05-08T18:37:14Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "MichalStrehovsky",
                                           "body":  "Built-in COM is not supported with native AOT. #88220 tracks System.DirectoryServices switching to the COM source generator that would make this scenario work, but unless that\u0027s fixed, there\u0027s not much that can be done. I\u0027ve added a mention of this issue there to help prioritizing.",
                                           "updatedAt":  "2024-05-05T12:25:30Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "Exception when calling Domain.GetCurrentDomain() in Native AOT",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/105406",
        "createdAt":  "2024-07-24T15:13:58Z",
        "number":  105406,
        "author":  "SilvioSodre",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-07-24T16:17:59Z",
        "body":  "Hi All!!\r\n\r\nFor four days, I am trying to log ldap communication messages that occur in the background when I use the class System.DirectoryServices.Protocols.LdapConnection. I have tried several environmental variables as LDAP_DEBUG, LDAP_DEBUG_FILE and LDAP_OPT_DEBUG_LEVEL. I\u0027ve also tried to customize my ldap.conf with DEBUG and LOGDIR. Nothing seems to turn on the ldap debug logging. I have read that my difficulty is shared by others developers. Someone can clarify a little this issue?",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOhgH1yQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6GAfXJ",
                                           "createdAt":  "2024-07-24T15:14:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2024-07-24T15:14:25Z"
                                       }
                                   ],
                         "totalCount":  1
                     },
        "title":  "Debug LDAP communication in use of class System.DirectoryServices.Protocols.LdapConnection",
        "labels":  [
                       "question",
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/106024",
        "createdAt":  "2024-08-06T15:52:46Z",
        "number":  106024,
        "author":  "nickjmcclure",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2024-09-28T04:05:47Z",
        "body":  "## Problem\r\nI have an application that is running on a server where I don’t have the ability to add certificates to the computer store. This application is performing various actions against Active Directory including searching and updating of properties using `PrincipalContext` and `DirectoryEntry`. Active Directory performs certificate renewal based on the internal CA root certificate. The server I\u0027m running from is not a domain member, and it cannot be joined to the domain.\r\n\r\nI can’t find where `PrincipalContext` and `DirectoryEntry` have any options for trusting certificates not in the computer store.\r\n\r\n## Question\r\nIs there any way to add a self-signed root certificate to a runtime store that `PrincipalContext` and `DirectoryEntry` will honor? I know `LdapConnection` has a callback option that can be used for this, but it doesn\u0027t seem to be available to `PrincipalContext` or `DirectoryEntry`\r\n\r\n## Sample Code\r\n\r\n```csharp\r\nPrincipalContext pc = new(ContextType.Domain, \"server.local\", null, ContextOptions.Negotiate | ContextOptions.SecureSocketLayer, \"someuser\", \"somepassword\");\r\nvar user = UserPrincipal.FindByIdentity(pc, IdentityType.SamAccountName, \"someotheruser\");\r\n```\r\n\r\nreturns the following error:\r\n```\r\nThe server could not be contacted.\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext.ReadServerConfig(String serverName, ServerProperties\u0026 properties)\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext.DoServerVerifyAndPropRetrieval()\r\n   at System.DirectoryServices.AccountManagement.PrincipalContext..ctor(ContextType contextType, String name, String container, ContextOptions options, String userName, String password)\r\n```\r\n\r\n",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOjeHw_A==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6HZi5h",
                                           "createdAt":  "2024-08-06T15:53:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2024-08-06T15:53:05Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6Ha8gI",
                                           "createdAt":  "2024-08-06T19:23:51Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ericstj",
                                           "body":  "I assume this is on Windows since you mention AccountManagement.  \r\n\r\nI know S.DS.Protocols has https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.protocols.ldapsessionoptions.verifyservercertificate?view=net-8.0 which only works on Windows.\r\n\r\nI\u0027m not aware of any similar support in other DirectoryServices API but @BRDPM @grubioe @jay98014 may know more as the System.DirectoryServices.AccountManagement owners.",
                                           "updatedAt":  "2024-08-06T19:23:51Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6HbB0z",
                                           "createdAt":  "2024-08-06T19:36:55Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "nickjmcclure",
                                           "body":  "@ericstj Yes, I\u0027m running this on Windows. I\u0027ve looked at modifying my process to use LdapConnection so I could take advantage of the callback you reference, and that is an option, just not the preferred one.",
                                           "updatedAt":  "2024-08-06T19:36:55Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6N4fD8",
                                           "createdAt":  "2024-09-28T04:05:46Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "nickjmcclure",
                                           "body":  "bumping this up a bit. I\u0027m curious of other thoughts on this.\r\n\r\nAny reason to not add the same callback functionality to `PrincipalContext`",
                                           "updatedAt":  "2024-09-28T04:05:46Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "Trust self-signed certificates when using PrincipalContext and DirectoryEntry",
        "labels":  [
                       "question",
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/110391",
        "createdAt":  "2024-12-04T11:55:23Z",
        "number":  110391,
        "author":  "markusTraber",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-07-26T10:53:06Z",
        "body":  "### Description\n\nOn `MacOs Sonoma 14.5 (23F79)` and `Docker Debian mcr.microsoft.com/dotnet/aspnet:8.0-bookworm-slim` I cannot connect to our Active Directory with `System.DirectoryServices.Protocols 8.0.0`. I get an exception when calling `StartTransportLayerSecurity(null)`. It works as soon, as I use version `7.0.1` instead of `8.0.0`.\n\n### Reproduction Steps\n\n#### MacOs\n\n1. `MacOs Sonoma 14.5 (23F79)`\n2. AD Server with Start TLS on port 389\n3. Reference `System.DirectoryServices.Protocols` package in version 8.0.0 in your project\n4. Execute code\n```\nLdapDirectoryIdentifier ldi = new LdapDirectoryIdentifier(host, port);\nLdapConnection cn = new LdapConnection(ldi);\ncn.Credential = new NetworkCredential(userDn, plainPassword);\ncn.AuthType = AuthType.Basic;\ncn.SessionOptions.ProtocolVersion = 3;\ncn.SessionOptions.StartTransportLayerSecurity(null);\ncn.Bind();\n```\n\n#### Docker\n\n1. AD Server with Start TLS on port 389\n2. Reference `System.DirectoryServices.Protocols` package in version 8.0.0 in your project\n3. Implement code in project\n```\nLdapDirectoryIdentifier ldi = new LdapDirectoryIdentifier(host, port);\nLdapConnection cn = new LdapConnection(ldi);\ncn.Credential = new NetworkCredential(userDn, plainPassword);\ncn.AuthType = AuthType.Basic;\ncn.SessionOptions.ProtocolVersion = 3;\ncn.SessionOptions.StartTransportLayerSecurity(null);\ncn.Bind();\n```\n4. Build a docker image:\n```\nFROM --platform=$BUILDPLATFORM  mcr.microsoft.com/dotnet/sdk:8.0-bookworm-slim AS build\nARG TARGETARCH\nWORKDIR /build\n\n# Copy project files and restore\nCOPY *.sln ./\nCOPY Directory.Packages.props ./\nCOPY src/ExampleApp.Web.Host/*.csproj ./src/ExampleApp.Web.Host/\n# ... more csproj files\nRUN dotnet restore -r linux-x64 -p:TargetFramework=net8.0\n\nCOPY --link . ./\n\nWORKDIR /build/src/ExampleApp.Web.Host/\nRUN dotnet publish -c Release -r linux-x64 -o /publish /p:Version=$(date +\"%Y.%m.%d\") --no-restore\n\n#\n# Runtime stage\n#\nFROM mcr.microsoft.com/dotnet/aspnet:8.0-bookworm-slim\nEXPOSE 10001\nWORKDIR /app\nCOPY --link --from=build /publish .\n\n# install new libldap\nRUN apt update \\\n  \u0026\u0026 apt install --upgrade -y libldap-2.5-0 \\\n  \u0026\u0026 apt install nano vim -y \\\n  \u0026\u0026 apt clean \\\n  \u0026\u0026 rm -rf /var/lib/apt/lists/\n\n# not necessary for .net v8\n# ad/ldap library link issue - https://github.com/dotnet/runtime/discussions/98990\n# RUN ln -s /usr/lib/x86_64-linux-gnu/libldap-2.5.so.0 /usr/lib/x86_64-linux-gnu/libldap-2.4.so.2\n\n# copy entrypoint script and make executable\nCOPY ./docker/entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/entrypoint.sh\n\n# create directory for ldap cert -\u003e will be mounted as volume and checked by entrypoint.sh\nRUN mkdir /usr/share/ca-certificates/extra\nRUN cp /etc/ca-certificates.conf /etc/ca-certificates.conf.backup\n\nCMD [\"/usr/local/bin/entrypoint.sh\"]\n```\n5. Run image and execute ldap connection code. I have tried 3 variations:\n    5.1 Installing libldap-2.5-0\n    5.2 Installing libldap-2.5-0 and creating symbolic links (commented in dockerfile)\n    5.2 Without installing and linking\n\n### Expected behavior\n\nI can connect to AD and no exception is thrown when \"StartTransportLayerSecurity\" method is called.\n\n### Actual behavior\n\n#### MacOS\n\nException is thrown when calling \"StartTransportLayerSecurity\" method:\n\n```\nException has occurred: CLR/System.DirectoryServices.Protocols.LdapException\nException thrown: \u0027System.DirectoryServices.Protocols.LdapException\u0027 in System.DirectoryServices.Protocols.dll: \u0027The LDAP server is unavailable.\u0027\n   at System.DirectoryServices.Protocols.LdapSessionOptions.StartTransportLayerSecurity(DirectoryControlCollection controls)\n   at ExampleApp.Authentication.Ldap.LdapConnectionFactory.CreateBoundConnection(String userDn, String plainPassword) in src/ExampleApp.Ldap/Authentication/Ldap/LdapConnectionFactory.cs:line 102\n```\n\n![Image](https://github.com/user-attachments/assets/cf0030ca-c020-4fb2-874c-389c54de72a8)\n\n\n#### Docker\n\nWhen installing libldap 2.5 and linking it or not (5.1 and 5.2), I get basically the same error as on MacOs:\n\n```\nSystem.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable.    at System.DirectoryServices.Protocols.LdapSessionOptions.StartTransportLayerSecurity(DirectoryControlCollection controls)\n   at ExampleApp.Authentication.Ldap.LdapConnectionFactory.CreateBoundConnection(String userDn, String plainPassword) in /build/src/ExampleApp.Ldap/Authentication/Ldap/LdapConnectionFactory.cs:line 102\n```\n\nwithout installing I get the following:\n\n```\nSystem.TypeInitializationException: The type initializer for \u0027Ldap\u0027 threw an exception.    at Interop.Ldap.ldap_initialize(IntPtr\u0026 ld, String uri)\n   at System.DirectoryServices.Protocols.ConnectionHandle..ctor()\n   at System.DirectoryServices.Protocols.LdapConnection.InternalInitConnectionHandle()\n   at System.DirectoryServices.Protocols.LdapConnection.Init()\n   at System.DirectoryServices.Protocols.LdapConnection..ctor(LdapDirectoryIdentifier identifier, NetworkCredential credential, AuthType authType)\n   at System.DirectoryServices.Protocols.LdapConnection..ctor(LdapDirectoryIdentifier identifier)\n   at ExampleApp.Authentication.Ldap.LdapConnectionFactory.CreateBoundConnection(String userDn, String plainPassword) in /build/src/ExampleApp.Ldap/Authentication/Ldap/LdapConnectionFactory.cs:line 85\n```\n\n### Regression?\n\nWorks with `System.DirectoryServices.Protocols 7.0.1`\n\n### Known Workarounds\n\nUsing v 7.0.1\n\n### Configuration\n\n- `MacOs Sonoma 14.5 (23F79)` on arm64 with .Net v8.0.403\n- `Docker Debian mcr.microsoft.com/dotnet/aspnet:8.0-bookworm-slim`, running as x64 on MacOs arm64 Host\n- `System.DirectoryServices.Protocols 8.0.0`\n\n\n### Other information\n\n- Similar issue: https://github.com/dotnet/runtime/issues/96988\n- Discussion about docker image and problems with libldap (but not using aspnet image).: https://github.com/dotnet/runtime/discussions/98990",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOl0-43Q==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6WSxEI",
                                           "createdAt":  "2024-12-05T21:34:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "This looks similar to https://github.com/dotnet/runtime/issues/108448, but the current implementation should pick up `libldap-2.4.so.2`, `libldap-2.5.so.0` and `libldap-2.6.so.0` and it look like you\u0027ve tried `2.5-0` and variants.\n",
                                           "updatedAt":  "2024-12-05T21:34:57Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6WS3_Q",
                                           "createdAt":  "2024-12-05T21:52:38Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "\u003e  It works as soon, as I use version 7.0.1 instead of 8.0.0.\n\nThere was a [change in v8 ](https://github.com/dotnet/runtime/pull/88851)that started to probe for 2.4, 2.5 and 2.6. \n\nPreviously in v7 it only looked for 2.4 (`libldap-2.4.so.2`), and I see you used symlinks to forward 2.5 to 2.4 which was necessary.\n\nFor the v8 case is it possible that these symlinks are pointing to an incorrect or missing entry? The symlinks shouldn\u0027t be necessary for v8 as 2.5 is now probed for.\n",
                                           "updatedAt":  "2024-12-05T21:52:38Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6WTD_H",
                                           "createdAt":  "2024-12-05T22:15:54Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "I suggest also looking at https://github.com/dotnet/runtime/issues/69456",
                                           "updatedAt":  "2024-12-05T22:15:54Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6XH_7c",
                                           "createdAt":  "2024-12-11T10:27:10Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "markusTraber",
                                           "body":  "Thank you. I will look into this and get back to you here.",
                                           "updatedAt":  "2024-12-11T10:27:10Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6XT7jd",
                                           "createdAt":  "2024-12-12T11:11:42Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "markusTraber",
                                           "body":  "Hi, I looked into the links, unfortunately I am not able to resolve this.\n\nThere was a wrong symlink `ln -s /usr/lib/x86_64-linux-gnu/libldap.so.2 /usr/lib/libldap-2.5.so.0`, which I now removed from the Dockerfile in the bug report. But it did not matter, since I also tried without symlinking before. \n\nI would assume, that v8 correctly finds and loads the libldap library without symlinking. I think this is what the different error messages suggest (not installed / installed).\n\nI also tried with runtime identifiers (as suggested [here](https://github.com/dotnet/runtime/issues/69456#issuecomment-1590574655)) and therefore updated the dockerfile to include runtime identifiers (also updated the dockerfile in the bug report):\n\n```\nRUN dotnet restore -r linux-x64 -p:TargetFramework=net8.0\n\nCOPY --link . ./\n\nWORKDIR /build/src/ExampleApp.Web.Host/\nRUN dotnet publish -c Release -r linux-x64 -o /publish /p:Version=$(date +\"%Y.%m.%d\") --no-restore\n```\n\nI still get the same error, (installing libldap-2.5-0, without symlinking) as before:\n\n```\nSystem.DirectoryServices.Protocols.LdapException: The LDAP server is unavailable.    at System.DirectoryServices.Protocols.LdapSessionOptions.StartTransportLayerSecurity(DirectoryControlCollection controls)\n   at ExampleApp.Authentication.Ldap.LdapConnectionFactory.CreateBoundConnection(String userDn, String plainPassword) in /build/src/ExampleApp.Ldap/Authentication/Ldap/LdapConnectionFactory.cs:line 102\n```\n\n[The workaround](https://github.com/dotnet/runtime/issues/69456#issuecomment-1592867432), using AssemblyLoadContext, is basically very similar to what you are doing in .net v8 already. Because of this and my assumption, that in my case the probing already works correctly, I did not try this.\n\nThank you",
                                           "updatedAt":  "2024-12-12T11:11:54Z"
                                       }
                                   ],
                         "totalCount":  5
                     },
        "title":  "Exception on LDAP/AD connection with .NET 8 on MacOs and Docker with StartTransportLayerSecurity",
        "labels":  [
                       "area-System.DirectoryServices",
                       "os-mac-os-x",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/112108",
        "createdAt":  "2025-02-03T20:52:03Z",
        "number":  112108,
        "author":  "steveharter",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-02-03T21:25:58Z",
        "body":  "The LDAP tests do not run in CI since there is infrastructure required to set up an LDAP server as explained in the various \"docker run\" commands and Active Directory section in https://github.com/dotnet/runtime/blob/main/src/libraries/Common/tests/System/DirectoryServices/LDAP.Configuration.xml.\n\nThis means every release we need to manually verify these tests.\n\nIdeally, we add the following support:\n- [ ] Support the OpenSsl (Linux and OsX) tests running by using the docker commands above and specify the environment variable so that the check for [DirectoryServicesProtocolsTests.LdapConfigurationExists](https://github.com/dotnet/runtime/blob/3ab8574307f12f4afbb813fbe708734334f87914/src/libraries/System.DirectoryServices.Protocols/tests/DirectoryServicesProtocolsTests.cs#L17) succeeds.\n- [ ] Extend or add a new configuration based on \"SLAPD OPENLDAP SERVER TLS\" to enable the TLS handshake to test client and server certificate validation. See also https://github.com/dotnet/runtime/issues/60972 where `VerifyServerCertificate()` doesn\u0027t work on Linux thus the need for an example + test. Currently, handshake is disabled in the XML instructions via \"LDAP_TLS_VERIFY_CLIENT=never\". High level steps include:\n    - [ ] Use \"LDAP_TLS_VERIFY_CLIENT=demand\"\n    - [ ] Add support for adding the properly hashed client certificate to a directory and setting the `TrustedCertificatesDirectory` property to that directory.\n    - [ ] Have the client trust the server certificate.\n    - [ ] Call `StartTransportLayerSecurity(null)`.\n- [ ] Support the OpenSsl (ActiveDirectory - Windows) tests. This is more difficult than the Linux and may not be feasible.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOnOHhsg==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6c4eGy",
                                           "createdAt":  "2025-02-03T20:52:25Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2025-02-03T20:52:25Z"
                                       }
                                   ],
                         "totalCount":  1
                     },
        "title":  "Add LDAP tests to CI",
        "labels":  [
                       "area-System.DirectoryServices",
                       "test-enhancement"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/112146",
        "createdAt":  "2025-02-04T20:14:57Z",
        "number":  112146,
        "author":  "steveharter",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-02-04T20:15:23Z",
        "body":  "These tests were recently re-enabled for Linux (all tests were disabled) and a recent DI test run for https://github.com/dotnet/runtime/pull/111877 had failures for:\n```\n[Centos.9.Amd64.Open]\n[Debian.13.Amd64.Open]\n[net10.0-linux-Debug-x64-Mono_Interpreter_Debug-Ubuntu.2204.Amd64.Open]\n```\n\nwith test failure:\n```\n   at System.DirectoryServices.Protocols.Tests.LdapSessionOptionsTests.ReferralChasing_Set_GetReturnsExpected_On_Linux(ReferralChasingOptions value) in /_/src/libraries/System.DirectoryServices.Protocols/tests/LdapSessionOptionsTests.cs:line 43\n\nAssert.Equal() Failure: Values differ\nExpected: None\nActual:   All\n```\n\nApparently, setting the value for `None`, which converts to `0 \\ false` for Linux when setting that bool property doesn\u0027t stick and the getter always returns `All`. Here\u0027s the current source for the Linux version of the setter for `public ReferralChasingOptions ReferralChasing`:\n```cs\n SetBoolValueHelper(LdapOption.LDAP_OPT_REFERRALS, value == ReferralChasingOptions.All);\n```\n\nThis tests past locally for me on Ubuntu.\n\nFlagging as potential test bug, since these other platforms may not support a `None` options.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOnQ5pnw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6dDmmf",
                                           "createdAt":  "2025-02-04T20:15:20Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2025-02-04T20:15:20Z"
                                       }
                                   ],
                         "totalCount":  1
                     },
        "title":  "LdapSessionOptions.ReferralChasing property setter doesn\u0027t work on all Linux platforms",
        "labels":  [
                       "area-System.DirectoryServices",
                       "test-bug",
                       "help wanted"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/113079",
        "createdAt":  "2025-03-03T13:53:10Z",
        "number":  113079,
        "author":  "LarsEriksenDSV",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-08-12T08:00:27Z",
        "body":  "### Description\n\nI\u0027m running a program on our corporate servers that have started failing with \"Information about the domain could not be retrieved (1212)\" when retrieving authorization groups.\nI\u0027ve managed to figure out that the issue spawns from AuthzGetInformationFromContext returning an SID that resolves to S-1-5-21-0-0-0-497. Our server admin tells me this is a well known SID and the code should not try to resolve the domain.\n\nThe issue began when enabling Kerberos client support for claims, compound authentication and Kerberos armoring.\n\n### Reproduction Steps\n\nI do not have reproducible code at hand. But if you co to src\\System\\DirectoryServices\\AccountManagement\\AuthZSet.cs and inject the failing SID into the result from AuthzGetInformationFromContext you should get the error when iterating the result of GetAuthorizationGroups of a user.\n\n`                UserPrincipal user = UserPrincipal.FindByIdentity(new PrincipalContext(ContextType.Domain), \"ad.user.name\");\n                foreach (var g in user.GetAuthorizationGroups()) // Exception here when it comes to the well known SID\n                {\n                    Console.WriteLine(g.Name);\n                }\n`\n\n### Expected behavior\n\nIt should not fail when trying to retrieve the groups. I guess it needs to return a GenericPrincipal for the SID when it iterates \n\n### Actual behavior\n\nSee reproduction steps.\n\n### Regression?\n\nI have tested with multiple versions of System.DirectoryServices.AccountManagement: 6.0, 6.0.1 and 9.0.2\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\nVersion of .net: 8.0\nOS version: Windows Server 2022 Datacenter\nArchitecture: x64\n\nProblem only occurs on the servers we have where \"Kerberos client support for claims, compound authentication and Kerberos armoring\" is enabled.\n\n### Other information\n\nFrom my view the code must be able to handle well known SID\u0027s being returned. Not being an expert, I guess AuthzGetInformationFromContext returns S-1-5-21-0-0-0-497 (CLAIMS_VALID) as a form of acknowledgment.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOvW8rTw==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6gnj3L",
                                           "createdAt":  "2025-03-03T15:13:41Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2025-03-03T15:13:41Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6gomXT",
                                           "createdAt":  "2025-03-03T16:51:54Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "Adding this note: `S-1-5-21-0-0-0-497` is _[CLAIMS_VALID](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/81d92bba-d22b-4a8c-908a-554ab29148ab#Appendix_A_Target_14CLAIMS_VALID): Claims were queried for in the account\u0027s domain, and if a forest boundary was crossed, then claims transformation occurred._\n",
                                           "updatedAt":  "2025-03-03T16:51:54Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6gotG_",
                                           "createdAt":  "2025-03-03T17:02:22Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "The referenced method `AuthzGetInformationFromContext` is a direct call into the Win32 Authz library, so it is unlikely an issue with `System.DirectoryServices.AccountManagement`.\n\nSome suggestions from Bing Copilot:\n_- Verify that the Group Policy settings for \"Kerberos client support for claims, compound authentication, and Kerberos armoring\" are correctly applied to all relevant computers._\n_- Ensure that the Key Distribution Center (KDC) support for these features is enabled on the domain controllers._\n_- Check the event logs on both the client and the domain controller for any related errors or warnings. This can provide more specific information about what might be going wrong._\n",
                                           "updatedAt":  "2025-03-03T17:02:22Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc69X1Ck",
                                           "createdAt":  "2025-08-11T23:04:26Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "BRDPM",
                                           "body":  "@LarsEriksenDSV Have you had any success with Steve\u0027s suggestions here?",
                                           "updatedAt":  "2025-08-11T23:04:26Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc69a63q",
                                           "createdAt":  "2025-08-12T06:55:23Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "LarsEriksenDSV",
                                           "body":  "\u003e [@LarsEriksenDSV](https://github.com/LarsEriksenDSV) Have you had any success with Steve\u0027s suggestions here?\n\nWe did look it through and it was not until kerberos armoring was in effect on all machines the problem occurred.\nThe issue is not with AuthzGetInformationFromContext - the issue is .net tries to resolve domain information for SID S-1-5-21-0-0-0-497 and fails with an exception.",
                                           "updatedAt":  "2025-08-12T06:55:23Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc69bytP",
                                           "createdAt":  "2025-08-12T08:00:27Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "LarsEriksenDSV",
                                           "body":  "Not being an expert it looks like it is a very valid return value amongst the claims returned by AuthzGetInformationFromContext from this documentation:\nhttps://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/81d92bba-d22b-4a8c-908a-554ab29148ab\n\n\"Claims were queried for in the account\u0027s domain, and if a forest boundary was crossed, then claims transformation occurred.\"",
                                           "updatedAt":  "2025-08-12T08:00:27Z"
                                       }
                                   ],
                         "totalCount":  6
                     },
        "title":  "System.DirectoryServices.AccountManagement GetAuthorizationGroups fails with \"Information about the domain could not be retrieved (1212)\"",
        "labels":  [
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/113967",
        "createdAt":  "2025-03-27T14:15:41Z",
        "number":  113967,
        "author":  "tbdrake",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-07-26T10:30:52Z",
        "body":  "### Description\n\n`PrincipalContext.ValidateCredentials()` returns `true` if the username begins with the null character and the password is either empty or begins with the null character. This seemed like unexpected behavior and a potential security concern for applications that use this to validate user credentials.\n\n### Reproduction Steps\n\n```csharp\nusing System.DirectoryServices.AccountManagement;\n\nstring domainControllerHost = \"your.domain.controller\";\n\nusing (var pc = new PrincipalContext(ContextType.Domain, domainControllerHost))\n{\n    bool nullCharUsernameIsValid = pc.ValidateCredentials(\"\\0\", \"\");\n    Console.WriteLine($\"Null char username is valid: {nullCharUsernameIsValid}\");\n\n    bool emptyUsernameIsValid = pc.ValidateCredentials(\"\", \"\");\n    Console.WriteLine($\"Empty username is valid: {emptyUsernameIsValid}\");\n}\n```\n\n### Expected behavior\n\nOutput:\n\u003e Null char username is valid: False\nEmpty username is valid: False\n\n### Actual behavior\n\nOutput:\n\u003e Null char username is valid: True\nEmpty username is valid: False\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\nCalling code can check for null chars in username and password to reject suspicious input before calling `PrincipalContext.Validate()`:\n\n```csharp\nif (userName.Contains(\u0027\\0\u0027) || password.Contains(\u0027\\0\u0027))\n{\n    return false;\n}\n\nusing (var pc = new PrincipalContext(ContextType.Domain, domainControllerHost))\n{\n    return pc.ValidateCredentials(userName, password);\n}\n```\n\n### Configuration\n\n_No response_\n\n### Other information\n\nhttps://github.com/dotnet/runtime/blob/c81f403737c412942222d13b2753881e62d1e6f7/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/Context.cs#L241-L245",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOpQogjg==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6k7ZwF",
                                           "createdAt":  "2025-03-31T18:16:19Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "ptal @BRDPM @grubioe @jay98014",
                                           "updatedAt":  "2025-03-31T18:16:19Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6k70Pn",
                                           "createdAt":  "2025-03-31T19:03:58Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOEMXhvg==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "ericstj",
                                                                               "createdAt":  "2025-03-31T19:33:35Z"
                                                                           },
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "tbdrake",
                                                                               "createdAt":  "2025-04-01T10:22:23Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  2
                                                         },
                                           "author":  "steveharter",
                                           "body":  "@tbdrake just to clarify that it doesn\u0027t appear that having an empty `userName` is an issue since [CredentialValidator.Validate(...)](https://github.com/dotnet/runtime/blob/ddd44f25d422502600e45f75224162d793778ab6/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/Context.cs#L237) checks for that plus the expected\\actual behavior from the original description are shown to return `false` in both cases:\n\n\u003e Expected behavior:\n\u003e Empty username is valid: False\n\n\u003e Actual behavior\n\u003e Empty username is valid: False",
                                           "updatedAt":  "2025-03-31T19:03:58Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6lCiCO",
                                           "createdAt":  "2025-04-01T10:26:14Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "tbdrake",
                                           "body":  "\u003e [@tbdrake](https://github.com/tbdrake) just to clarify that it doesn\u0027t appear that having an empty `userName` is an issue since [CredentialValidator.Validate(...)](https://github.com/dotnet/runtime/blob/ddd44f25d422502600e45f75224162d793778ab6/src/libraries/System.DirectoryServices.AccountManagement/src/System/DirectoryServices/AccountManagement/Context.cs#L237) checks for that plus the expected\\actual behavior from the original description are shown to return `false` in both cases:\n\u003e \n\u003e \u003e Expected behavior:\n\u003e \u003e Empty username is valid: False\n\u003e \n\u003e \u003e Actual behavior\n\u003e \u003e Empty username is valid: False\n\nYes that is correct, the behavior for empty `userName` is not an issue, sorry if that part was misleading! I included that in the repro code and expected/actual output just for comparison with the case where `userName` starts with a null char.",
                                           "updatedAt":  "2025-04-01T11:10:43Z"
                                       }
                                   ],
                         "totalCount":  3
                     },
        "title":  "PrincipalContext.Validate() does not handle embedded null characters in username and password as expected",
        "labels":  [
                       "bug",
                       "area-System.DirectoryServices"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/114251",
        "createdAt":  "2025-04-04T02:09:20Z",
        "number":  114251,
        "author":  "BillArmstrong",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-08-01T18:09:50Z",
        "body":  "### Description\n\nThe documentation for ValidateCredentials states this about the userName parameter:\n\n\u003e The userName argument must take the form username (for example, mcampbell) rather than domain\\username or username@domain.\n\nIt also says this about the options parameter:\n\n\u003e This parameter can only specify Simple bind with or without SSL, or Negotiate bind.\n\nI had expected that when calling this function specifying `ContextOptions.Negotiate` and a domain account, Kerberos would be used. That was not the case. It used NTLM\n\nThe Negotiate documentation states the following:\n\n\u003e To allow Negotiate to select the [Kerberos](https://learn.microsoft.com/en-us/windows/win32/secauthn/microsoft-kerberos) security provider, the client app must provide one of the following:\n\u003e - A [service principal name](https://learn.microsoft.com/en-us/windows/win32/secgloss/s-gly) (SPN).\n\u003e - A user principal name (UPN).\n\u003e - A NetBIOS account name as the target name.\n\u003e \n\u003e Otherwise, Negotiate always selects the [NTLM](https://learn.microsoft.com/en-us/windows/win32/secauthn/microsoft-ntlm) security provider.\n\nBased on this, it is not surprising that a username specified without any domain component would use NTLM, however the ValidateCredentials method is on the context object, which identifies the user domain. I had assumed that the domain information would be extracted from the context when executing the credential validation.\n\nEven though the documentation states that the userName parameter must be in a specific format, I tried using other formats to force it to use Kerberos, but the validation failed, returning `False`.\n\n### Reproduction Steps\n\nFrom PowerShell:\n\n```\n$domain = \"DOMAIN\"\n$username = \"user\"\n$password = \"password\"\nAdd-Type -AssemblyName System.DirectoryServices.AccountManagement\n$context = [System.DirectoryServices.AccountManagement.PrincipalContext]::new([System.DirectoryServices.AccountManagement.ContextType]::Domain, $domain)\n$user = [System.DirectoryServices.AccountManagement.UserPrincipal]::FindByIdentity($context, [System.DirectoryServices.AccountManagement.IdentityType]::SamAccountName, $username)\n$user.Context.ValidateCredentials($user.SamAccountName, $password, [System.DirectoryServices.AccountManagement.ContextOptions]::Negotiate)\n```\n\nWith Credential Validation auditing enabled, you will see an event logged similar to:\n\n\u003e The computer attempted to validate the credentials for an account.\n\u003e \n\u003e Authentication Package:\tMICROSOFT_AUTHENTICATION_PACKAGE_V1_0\n\u003e Logon Account:\tUser\n\u003e Source Workstation:\tCOMPUTER\n\u003e Error Code:\t0x0\n\nThe documentation for this event indicates that this is logged when a credential validation is performed using NTLM.\n\n### Expected behavior\n\nThe ValidateCredentials function performs the validation using Kerberos when validating a domain account and when Negotiate is specified.\n\n### Actual behavior\n\nThe ValidateCredentials function performs the validation using NTLM when validating a domain account and when Negotiate is specified.\n\n### Regression?\n\nNo\n\n### Known Workarounds\n\nThe ValidateCredentials does the validation by executing an LdapConnection bind. If the bind is performed manually specifying the account as \"DOMAIN\\User\", the bind is performed using Kerberos.\n\n### Configuration\n\nIssue has been observed on the following runtimes:\n- .Net 8 console application\n- Windows PowerShell 5.1\n- PowerShell 7.5\n\n### Other information\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOpsDarg==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6li3eI",
                                           "createdAt":  "2025-04-04T02:09:45Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2025-04-04T02:09:45Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6mvayb",
                                           "createdAt":  "2025-04-11T16:41:44Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "steveharter",
                                           "body":  "A simple local test for me shows:\n- `Package Name (NTLM only):` _(empty)_\n- `Authentication Package:` Negotiate\n\nwhich may or may not imply it was using Kerberos.\n\nThoughts @BRDPM @grubioe @jay98014 ? What is a reliable way to determine if Kerberos is used with the Negotiate package?",
                                           "updatedAt":  "2025-04-11T17:11:19Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6mwDBY",
                                           "createdAt":  "2025-04-11T17:36:04Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "BillArmstrong",
                                           "body":  "FYI, this is the specific policy that I enabled to view the NTLM event:\n\nhttps://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-credential-validation\n\nThis is the event that I saw:\n\nhttps://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4776",
                                           "updatedAt":  "2025-04-11T17:36:04Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6mwNqu",
                                           "createdAt":  "2025-04-11T17:56:57Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "BillArmstrong",
                                           "body":  "For more context, we initially became aware of this issue when one of our customers reported that our software was failing to pass the credential validation step on our installer in their environment. The error being logged was \"A local error occurred.\"\n\nAfter some investigation we determined that they had NTLM disabled on their server. We were able to reproduce their error by setting the following policy on the client machine:\n\nNetwork Security: Restrict NTLM: Outgoing NTLM traffic to remote servers ---\u003e Deny all\n\nIf you set that policy, you should see that the script that I provided fails.",
                                           "updatedAt":  "2025-04-11T17:56:57Z"
                                       }
                                   ],
                         "totalCount":  4
                     },
        "title":  "PrincipalContext.ValidateCredentials is unable to validate credentials using Kerberos authentication.",
        "labels":  [
                       "area-System.DirectoryServices",
                       "needs-further-triage"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/116295",
        "createdAt":  "2025-06-04T08:20:38Z",
        "number":  116295,
        "author":  "AleMcKee",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-07-14T17:57:05Z",
        "body":  "### Background and motivation\n\nThere is currently no way to use `FindByIdentity` in a generic way. There is a protected function `FindByIdentityWithType`, but this is not accessible from \"outside\".\n\nWe have functions that have to call `FindByIdentity` with different derived `Principal` classes. This currently causes us to call `FindByIdentity` as follows:\n\n ```csharp\nvar result = typeof(T).GetMethod(nameof(Principal.FindByIdentity), [typeof(PrincipalContext), typeof(IdentityType), typeof(string)])?.Invoke(null, [adPrincipalContext, identityType, identityValue]) as T;\n```\n\nI think that due to the existence of `FindByIdentityWithType`, the implementation should also be straightforward and should not cause any problems.\n\n\n### API Proposal\n\n```csharp\nnamespace System.DirectoryServices.AccountManagement;\n\npublic abstract partial class Principal : System.IDisposable\n{\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, string identityValue) where T : Principal\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, IdentityType identityType, string identityValue) where T : Principal\n}\n\npublic partial class ComputerPrincipal : System.DirectoryServices.AccountManagement.AuthenticablePrincipal\n{\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, string identityValue) where T : ComputerPrincipal\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, IdentityType identityType, string identityValue) where T : ComputerPrincipal\n}\n\npublic partial class GroupPrincipal : System.DirectoryServices.AccountManagement.Principal\n{\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, string identityValue) where T : GroupPrincipal\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, IdentityType identityType, string identityValue) where T : GroupPrincipal\n}\n\npublic partial class UserPrincipal : System.DirectoryServices.AccountManagement.AuthenticablePrincipal\n{\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, string identityValue) where T : UserPrincipal\n    public static new T FindByIdentity\u003cT\u003e(PrincipalContext context, IdentityType identityType, string identityValue) where T : UserPrincipal\n}\n```\n\n\n### API Usage\n\n```csharp\nPrincipalContext ctx = new PrincipalContext(ContextType.Machine);\nPrincipal.FindByIdentity\u003cUserPrincipal\u003e(ctx, IdentityType.SamAccountName, \"Guest\");\n```\n\n\n### Alternative Designs\n\n_No response_\n\n### Risks\n\n_No response_",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOtwOLCQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6vMI_O",
                                           "createdAt":  "2025-06-04T08:56:07Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2025-06-04T08:56:07Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc63A4sJ",
                                           "createdAt":  "2025-07-14T17:57:05Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "ericstj",
                                           "body":  "The `AccountManagement` namespace is effectively frozen to match desktop and the area is in maintainence only.  It\u0027s unlikely to accept features like this, but I\u0027d defer to @jay98014 to make the call.",
                                           "updatedAt":  "2025-07-14T17:57:05Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "[API Proposal]: Adding a generic version of `FindByIdentity`",
        "labels":  [
                       "api-suggestion",
                       "area-System.DirectoryServices",
                       "feature-request"
                   ]
    },
    {
        "url":  "https://github.com/dotnet/runtime/issues/118882",
        "createdAt":  "2025-08-19T12:35:05Z",
        "number":  118882,
        "author":  "Hennerfeind",
        "reactions":  {
                          "hasNextPage":  false,
                          "endCursor":  null,
                          "nodes":  [

                                    ],
                          "totalCount":  0
                      },
        "updatedAt":  "2025-08-31T17:53:50Z",
        "body":  "The above mentioned methode is not possible to get recursive users that belongs to a subgroup.\n\n```\nSample:\n     Group1\n          User1\n          Group2\n               User2\n               User3\n```\n\nOnly User1 is found.\n\nThe Methode GetMembers(true) of GroupPrinciple is very slow. So its not a solution for that issue.",
        "comments":  {
                         "hasNextPage":  false,
                         "endCursor":  "Y3Vyc29yOnYyOpHOvsUOnQ==",
                         "nodes":  [
                                       {
                                           "id":  "IC_kwDODI9FZc6-xQcj",
                                           "createdAt":  "2025-08-19T12:35:59Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  null,
                                                             "nodes":  [

                                                                       ],
                                                             "totalCount":  0
                                                         },
                                           "author":  "dotnet-policy-service",
                                           "body":  "Tagging subscribers to this area: @dotnet/area-system-directoryservices, @jay98014\nSee info in [area-owners.md](https://github.com/dotnet/runtime/blob/main/docs/area-owners.md) if you want to be subscribed.\n\u003c!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003e",
                                           "updatedAt":  "2025-08-19T12:35:59Z"
                                       },
                                       {
                                           "id":  "IC_kwDODI9FZc6-xQ6d",
                                           "createdAt":  "2025-08-19T12:36:33Z",
                                           "reactions":  {
                                                             "hasNextPage":  false,
                                                             "endCursor":  "Y3Vyc29yOnYyOpHOEgSprA==",
                                                             "nodes":  [
                                                                           {
                                                                               "content":  "THUMBS_UP",
                                                                               "user":  "jeffhandley",
                                                                               "createdAt":  "2025-08-31T17:53:18Z"
                                                                           }
                                                                       ],
                                                             "totalCount":  1
                                                         },
                                           "author":  "Hennerfeind",
                                           "body":  "Sorry the tree was not good shown...\nGroup2 is a SubGroup of Group1",
                                           "updatedAt":  "2025-08-19T12:36:33Z"
                                       }
                                   ],
                         "totalCount":  2
                     },
        "title":  "System.DirectoryServices.AccountManagement.IsMemberOf(GroupPrincipal group) recursive",
        "labels":  [
                       "area-System.DirectoryServices"
                   ]
    }
]
